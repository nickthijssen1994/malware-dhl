package com.jingdong.aura.core.b;

import java.util.Dictionary;
import java.util.Enumeration;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Hashtable;
import java.util.Locale;
import java.util.Map;
import org.osgi.framework.d;
import org.osgi.framework.e;
import org.osgi.framework.f;

/* compiled from: TbsSdkJava */
/* loaded from: classes.dex */
public final class j implements e {
    private static final HashSet<String> a = new HashSet<>();
    private static long b;
    private org.osgi.framework.a c;
    private final boolean e;
    private final Dictionary<String, Object> f;
    private f g;
    private Object h;
    private final Map<org.osgi.framework.a, Integer> i = new HashMap(0);
    private HashMap<org.osgi.framework.a, Object> d = null;

    static {
        a.add("service.id".toLowerCase(Locale.US));
        a.add("objectClass".toLowerCase(Locale.US));
    }

    /* compiled from: TbsSdkJava */
    /* loaded from: classes.dex */
    private final class a implements f {
        private a() {
        }
    }

    public j(org.osgi.framework.a aVar, Object obj, Dictionary<String, ?> dictionary, String[] strArr) {
        Integer num;
        int i = 0;
        if (obj instanceof d) {
            this.e = true;
        } else {
            this.e = false;
            a(obj, strArr);
        }
        this.c = aVar;
        this.h = obj;
        this.f = dictionary == null ? new Hashtable() : new Hashtable(dictionary.size());
        if (dictionary != null) {
            Enumeration<String> keys = dictionary.keys();
            while (keys.hasMoreElements()) {
                String nextElement = keys.nextElement();
                this.f.put(nextElement, dictionary.get(nextElement));
            }
        }
        this.f.put("objectClass", strArr);
        Dictionary<String, Object> dictionary2 = this.f;
        long j = b + 1;
        b = j;
        dictionary2.put("service.id", Long.valueOf(j));
        if (dictionary == null) {
            num = null;
        } else {
            num = (Integer) dictionary.get("service.ranking");
        }
        this.f.put("service.ranking", Integer.valueOf(num != null ? num.intValue() : i));
        this.g = new a();
    }

    private void a(Object obj, String[] strArr) {
        for (int i = 0; i < strArr.length; i++) {
            try {
                if (!Class.forName(strArr[i], false, obj.getClass().getClassLoader()).isInstance(obj)) {
                    throw new IllegalArgumentException("Service " + obj.getClass().getName() + " does not implement the interface " + strArr[i]);
                }
            } catch (ClassNotFoundException e) {
                throw new IllegalArgumentException("Interface " + strArr[i] + " implemented by service " + obj.getClass().getName() + " cannot be located: " + e.getMessage());
            }
        }
    }

    public String toString() {
        return "ServiceReference{" + this.h + "}";
    }
}
