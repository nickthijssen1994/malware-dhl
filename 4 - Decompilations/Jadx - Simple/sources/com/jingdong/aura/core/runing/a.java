package com.jingdong.aura.core.runing;

import android.app.Instrumentation;
import android.content.ComponentName;
import android.content.Intent;
import android.content.pm.ActivityInfo;
import android.content.pm.PackageManager;
import android.content.pm.ResolveInfo;
import android.text.TextUtils;
import com.alibaba.fastjson.util.UTF8Decoder;
import com.jingdong.aura.core.reflection.c;
import com.jingdong.aura.core.util.a.b;
import com.jingdong.aura.core.util.h;
import java.lang.reflect.Method;
import java.util.ArrayList;
import org.osgi.framework.BundleException;

/* compiled from: TbsSdkJava */
/* loaded from: classes.dex */
public class a extends c.a {
    private static final b a = com.jingdong.aura.core.util.a.c.a(a.class);

    @Override // com.jingdong.aura.core.reflection.c.a, java.lang.reflect.InvocationHandler
    public Object invoke(Object obj, Method method, Object[] objArr) {
        String str;
        String str2;
        String str3;
        String name = method.getName();
        String str4 = null;
        if (method.getName().equals("startService")) {
            Intent intent = (Intent) objArr[1];
            if (intent.getComponent() != null) {
                str2 = intent.getComponent().getPackageName();
                str3 = intent.getComponent().getClassName();
            } else {
                ResolveInfo resolveService = k.a.getPackageManager().resolveService(intent, 0);
                if (!(resolveService == null || resolveService.serviceInfo == null)) {
                    str2 = resolveService.serviceInfo.packageName;
                    str3 = resolveService.serviceInfo.name;
                }
                str3 = null;
                str2 = null;
            }
            if (!h.b(k.a.getPackageName(), str2)) {
                return super.invoke(obj, method, objArr);
            }
            c.b(str3);
            String c = f.c(str3);
            if (c != null) {
                com.jingdong.aura.core.b.h a2 = com.jingdong.aura.core.b.b.b.a(c);
                if (a2 != null) {
                    try {
                        a2.j();
                    } catch (BundleException e) {
                        a.b(e.getMessage() + " Caused by: ", e.getNestedException());
                    }
                }
                return super.invoke(obj, method, objArr);
            }
            try {
                if (com.jingdong.aura.core.b.b.b.b().loadClass(str3) != null) {
                    return super.invoke(obj, method, objArr);
                }
                return null;
            } catch (ClassNotFoundException unused) {
                a.e("Can't find class " + str3);
                return null;
            }
        } else if (method.getName().equals("bindService")) {
            Intent intent2 = (Intent) objArr[1];
            if (intent2.getComponent() != null) {
                str4 = intent2.getComponent().getPackageName();
                str = intent2.getComponent().getClassName();
            } else {
                ResolveInfo resolveService2 = k.a.getPackageManager().resolveService(intent2, 0);
                if (!(resolveService2 == null || resolveService2.serviceInfo == null)) {
                    str4 = resolveService2.serviceInfo.packageName;
                    str = resolveService2.serviceInfo.name;
                }
                str = null;
            }
            if (!h.b(k.a.getPackageName(), str4)) {
                return super.invoke(obj, method, objArr);
            }
            c.b(str);
            String c2 = f.c(str);
            if (c2 != null) {
                com.jingdong.aura.core.b.h a3 = com.jingdong.aura.core.b.b.b.a(c2);
                if (a3 != null) {
                    try {
                        a3.j();
                    } catch (BundleException e2) {
                        a.b(e2.getMessage() + " Caused by: ", e2.getNestedException());
                    }
                }
                return super.invoke(obj, method, objArr);
            }
            try {
                if (com.jingdong.aura.core.b.b.b.b().loadClass(str) != null) {
                    return super.invoke(obj, method, objArr);
                }
            } catch (ClassNotFoundException unused2) {
                a.e("Can't find class " + str);
            }
            return false;
        } else {
            if (name.equals("startActivity")) {
                Instrumentation d = com.jingdong.aura.core.reflection.a.d();
                if (d != null && d.getClass().getName().contains("com.lbe.security.service")) {
                    com.jingdong.aura.core.reflection.a.a((Instrumentation) new h(com.jingdong.aura.core.reflection.a.d(), k.a.getBaseContext()));
                }
                int i = 0;
                while (true) {
                    if (i >= objArr.length) {
                        break;
                    }
                    Object obj2 = objArr[i];
                    if (obj2 instanceof Intent) {
                        Intent intent3 = (Intent) obj2;
                        if (intent3.getComponent() != null) {
                            String className = intent3.getComponent().getClassName();
                            String packageName = intent3.getComponent().getPackageName();
                            String e3 = com.jingdong.aura.core.a.a.a().e(className);
                            ArrayList<String> k = com.jingdong.aura.core.b.c.k(e3);
                            if (k != null && k.size() > 0) {
                                String providedBundleNotFoundPageName = com.jingdong.aura.core.b.c.d().getProvidedBundleNotFoundPageName();
                                if (!TextUtils.isEmpty(providedBundleNotFoundPageName)) {
                                    intent3.putExtra("aura_target_classname", className);
                                    intent3.putExtra("aura_target_bundlename", e3);
                                    intent3.putStringArrayListExtra("aura_not_prepared_bundlename", k);
                                    intent3.setComponent(new ComponentName(packageName, providedBundleNotFoundPageName));
                                }
                            }
                            try {
                                k.c.getActivityInfo(intent3.getComponent(), UTF8Decoder.Surrogate.UCS4_MIN);
                            } catch (PackageManager.NameNotFoundException unused3) {
                                if (!k.a.getApplicationInfo().processName.equals(k.e)) {
                                    objArr[i] = com.jingdong.aura.core.shadow.c.a(intent3);
                                    return super.invoke(obj, method, objArr);
                                }
                                try {
                                    c.b(className);
                                    ActivityInfo activityInfo = k.a.getPackageManager().getActivityInfo(intent3.getComponent(), UTF8Decoder.Surrogate.UCS4_MIN);
                                    if (activityInfo != null) {
                                        String className2 = intent3.getComponent().getClassName();
                                        String a4 = com.jingdong.aura.core.shadow.c.a(activityInfo);
                                        com.jingdong.aura.core.util.a.c.a(com.jingdong.aura.core.b.a.class).c(String.format("dispatchShadowActivity,[%s -> %s]", className2, a4));
                                        objArr[i] = com.jingdong.aura.core.shadow.c.a(intent3, a4);
                                        return super.invoke(obj, method, objArr);
                                    }
                                } catch (PackageManager.NameNotFoundException e4) {
                                    e4.printStackTrace();
                                } catch (Exception e5) {
                                    e5.printStackTrace();
                                }
                            } catch (Exception e6) {
                                e6.printStackTrace();
                            }
                        }
                    } else {
                        i++;
                    }
                }
            }
            return super.invoke(obj, method, objArr);
        }
        return super.invoke(obj, method, objArr);
    }
}
