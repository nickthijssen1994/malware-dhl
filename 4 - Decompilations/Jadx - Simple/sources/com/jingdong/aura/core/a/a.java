package com.jingdong.aura.core.a;

import android.text.TextUtils;
import android.util.Log;
import com.huawei.hms.support.api.push.pushselfshow.click.SelfShowType;
import com.jingdong.aura.core.b.b.b;
import com.jingdong.aura.core.util.d;
import java.io.ByteArrayInputStream;
import java.io.File;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.LinkedList;
import java.util.List;
import java.util.Map;
import org.json.JSONArray;
import org.json.JSONObject;

/* compiled from: TbsSdkJava */
/* loaded from: classes.dex */
public class a {
    private static a a;
    private final String b = a.class.getSimpleName();
    private List<C0042a> c;
    private List<C0042a> d;

    /* compiled from: TbsSdkJava */
    /* renamed from: com.jingdong.aura.core.a.a$a */
    /* loaded from: classes.dex */
    public static class C0042a {
        public List<String> a;
        public List<String> b;
        public List<String> c;
        public List<String> d;
        public String e;
        public boolean f;
        public long g;
        public String h;
        public long i;
        public String j;
        public String k;
        public String l;
        public int m;
        public String n;
        public List<String> o;
        public List<String> p;
        public List<String> q;
        public List<String> r;
    }

    private a() {
    }

    public static synchronized a a() {
        a aVar;
        synchronized (a.class) {
            synchronized (a.class) {
                if (a == null) {
                    a = new a();
                }
                aVar = a;
            }
            return aVar;
        }
        return aVar;
    }

    public synchronized void a(List<C0042a> list) {
        if (list != null) {
            this.d = list;
        }
    }

    public synchronized boolean b(List<C0042a> list) {
        boolean z;
        if (this.c == null && list != null) {
            this.c = list;
            z = true;
        }
        Log.i(this.b, "XXXXXBundleInfoList initialization failed.");
        z = false;
        return z;
    }

    public synchronized List<String> a(String str) {
        if (!(this.c == null || this.c.size() == 0)) {
            for (C0042a aVar : this.c) {
                if (aVar.e.equals(str)) {
                    ArrayList arrayList = new ArrayList();
                    if (!(aVar == null || aVar.c == null)) {
                        for (int i = 0; i < aVar.c.size(); i++) {
                            if (!TextUtils.isEmpty(aVar.c.get(i))) {
                                arrayList.add(aVar.c.get(i));
                            }
                        }
                    }
                    return arrayList;
                }
            }
            return null;
        }
        return null;
    }

    public synchronized List<String> b(String str) {
        if (!(this.c == null || this.c.size() == 0)) {
            for (C0042a aVar : this.c) {
                if (aVar.e.equals(str)) {
                    return aVar.d;
                }
            }
            return null;
        }
        return null;
    }

    public synchronized boolean c(String str) {
        boolean z = false;
        if (str == null) {
            return false;
        }
        if (this.c != null && !this.c.isEmpty()) {
            for (int i = 0; i < this.c.size(); i++) {
                C0042a aVar = this.c.get(i);
                if (aVar.e.equals(str)) {
                    if (aVar.m == 2) {
                        z = true;
                    }
                    return z;
                }
            }
            return false;
        }
        return false;
    }

    public synchronized List<Map<String, String>> b() {
        if (this.d != null && !this.d.isEmpty()) {
            ArrayList arrayList = new ArrayList();
            for (C0042a aVar : this.d) {
                if (aVar.m == 2) {
                    HashMap hashMap = new HashMap();
                    hashMap.put("bundleName", aVar.e);
                    if (!TextUtils.isEmpty(aVar.l)) {
                        hashMap.put("md5", aVar.l);
                    } else {
                        hashMap.put("md5", aVar.k);
                    }
                    hashMap.put("size", aVar.g + "");
                    hashMap.put("versionCode", aVar.i + "");
                    hashMap.put("downloadUrl", aVar.n);
                    arrayList.add(hashMap);
                }
            }
            return arrayList;
        }
        return null;
    }

    public synchronized long d(String str) {
        if (this.c != null && !this.c.isEmpty()) {
            for (int i = 0; i < this.c.size(); i++) {
                C0042a aVar = this.c.get(i);
                if (aVar.e.equals(str)) {
                    return aVar.i;
                }
            }
            return -1;
        }
        return -1;
    }

    public synchronized String e(String str) {
        if (this.c == null || this.c.size() == 0) {
            return null;
        }
        if (str == null) {
            return null;
        }
        for (C0042a aVar : this.c) {
            for (String str2 : aVar.a) {
                if (str2.equals(str)) {
                    return aVar.e;
                }
            }
            for (String str3 : aVar.b) {
                if (str.equals(str3)) {
                    return aVar.e;
                }
            }
        }
        return null;
    }

    public synchronized List<C0042a> c() {
        if (this.c != null && !this.c.isEmpty()) {
            return this.c;
        }
        return null;
    }

    public synchronized List<String> d() {
        if (this.c != null && !this.c.isEmpty()) {
            LinkedList linkedList = new LinkedList();
            for (int i = 0; i < this.c.size(); i++) {
                linkedList.add(this.c.get(i).e);
            }
            return linkedList;
        }
        return null;
    }

    public C0042a f(String str) {
        return a(this.c, str);
    }

    public synchronized C0042a a(List<C0042a> list, String str) {
        if (list != null) {
            if (!list.isEmpty()) {
                for (int i = 0; i < list.size(); i++) {
                    C0042a aVar = list.get(i);
                    if (aVar.e.equals(str)) {
                        return aVar;
                    }
                }
                return null;
            }
        }
        return null;
    }

    public long g(String str) {
        C0042a f = f(str);
        if (f == null) {
            return 0;
        }
        return f.g;
    }

    public synchronized void a(C0042a aVar) {
        if (aVar != null) {
            List<C0042a> c = a().c();
            if (c != null) {
                if (b.a(aVar.e) != null) {
                    c = new ArrayList<>(c);
                }
                C0042a a2 = a(c, aVar.e);
                if (a2 == null) {
                    c.add(aVar);
                    c(c);
                } else if (aVar.i > a2.i) {
                    aVar.m = a2.m;
                    aVar.n = a2.n;
                    c.remove(a2);
                    c.add(aVar);
                    c(c);
                }
            } else {
                ArrayList arrayList = new ArrayList();
                arrayList.add(aVar);
                this.c = arrayList;
                c(arrayList);
            }
        }
    }

    private void c(List<C0042a> list) {
        if (list != null) {
            try {
                if (!list.isEmpty()) {
                    JSONArray jSONArray = new JSONArray();
                    for (C0042a aVar : list) {
                        JSONObject jSONObject = new JSONObject();
                        jSONObject.put("pkgName", aVar.e);
                        jSONObject.put("verName", aVar.h);
                        jSONObject.put("verCode", aVar.i);
                        jSONObject.put(SelfShowType.PUSH_CMD_APP, aVar.j);
                        jSONObject.put("bundleType", aVar.m);
                        jSONObject.put("size", aVar.g);
                        jSONObject.put("hasSO", aVar.f);
                        jSONObject.put("md5", aVar.k);
                        if (!TextUtils.isEmpty(aVar.n)) {
                            jSONObject.put("downloadUrl", aVar.n);
                        }
                        a(jSONObject, aVar.o, "activity");
                        a(jSONObject, aVar.p, "service");
                        a(jSONObject, aVar.q, "provider");
                        a(jSONObject, aVar.r, "receiver");
                        a(jSONObject, aVar.b, "manualComponents");
                        a(jSONObject, aVar.c, "dependency");
                        a(jSONObject, aVar.d, "auraDependentSo");
                        jSONArray.put(jSONObject);
                    }
                    String str = d.a().getAbsolutePath() + "/aura/updateAura.json";
                    String jSONArray2 = jSONArray.toString();
                    if (!TextUtils.isEmpty(jSONArray2)) {
                        d.a(new ByteArrayInputStream(jSONArray2.getBytes()), new File(str));
                    }
                }
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }

    private static void a(JSONObject jSONObject, List<String> list, String str) {
        if (!(jSONObject == null || TextUtils.isEmpty(str) || list == null)) {
            JSONArray jSONArray = new JSONArray();
            for (String str2 : list) {
                jSONArray.put(str2);
            }
            jSONObject.put(str, jSONArray);
        }
    }

    public C0042a h(String str) {
        List<C0042a> list = this.d;
        if (list == null || list.isEmpty()) {
            return null;
        }
        for (int i = 0; i < this.d.size(); i++) {
            C0042a aVar = this.d.get(i);
            if (aVar.e.equals(str)) {
                return aVar;
            }
        }
        return null;
    }

    public String i(String str) {
        C0042a h = h(str);
        if (h == null) {
            return null;
        }
        return h.k;
    }
}
