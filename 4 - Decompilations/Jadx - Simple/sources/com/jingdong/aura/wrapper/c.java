package com.jingdong.aura.wrapper;

import android.annotation.SuppressLint;
import android.app.Application;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.os.Build;
import android.util.Log;
import java.io.File;
import java.util.concurrent.ConcurrentHashMap;

/* compiled from: TbsSdkJava */
/* loaded from: classes.dex */
public class c {
    public static String a(String str) {
        String str2 = "lib" + File.separator + com.jingdong.aura.core.b.c.B() + File.separator;
        return str.substring(str.indexOf(str2) + str2.length());
    }

    public static String b(String str) {
        String str2 = "lib/" + com.jingdong.aura.core.b.c.B() + "/lib";
        return str.substring(str.indexOf(str2) + str2.length(), str.indexOf(".so"));
    }

    public static PackageInfo a(Application application) {
        try {
            return application.getPackageManager().getPackageInfo(application.getPackageName(), 0);
        } catch (Throwable th) {
            Log.e("Utils", "Error to get PackageInfo >>>", th);
            return new PackageInfo();
        }
    }

    public static void b(Application application) {
        ConcurrentHashMap concurrentHashMap = new ConcurrentHashMap();
        concurrentHashMap.put(a(application).versionName, "dexopt");
        SharedPreferences sharedPreferences = application.getSharedPreferences("aura_config", 0);
        if (sharedPreferences == null) {
            sharedPreferences = application.getSharedPreferences("aura_config", 0);
        }
        SharedPreferences.Editor edit = sharedPreferences.edit();
        for (String str : concurrentHashMap.keySet()) {
            edit.putString(str, (String) concurrentHashMap.get(str));
        }
        edit.commit();
    }

    public static void c(Application application) {
        PackageInfo a = a(application);
        SharedPreferences.Editor edit = application.getSharedPreferences("aura_config", 0).edit();
        edit.putInt("last_version_code", a.versionCode);
        edit.putString("last_version_name", a.versionName);
        edit.putString(a.versionName, "dexopt");
        edit.commit();
    }

    public static boolean d(Application application) {
        try {
            PackageInfo packageInfo = application.getPackageManager().getPackageInfo(application.getPackageName(), 0);
            if (packageInfo.versionCode > application.getSharedPreferences("aura_config", 0).getInt("last_version_code", 0)) {
                return true;
            }
            return false;
        } catch (PackageManager.NameNotFoundException e) {
            e.printStackTrace();
            return false;
        }
    }

    public static void e(Application application) {
        System.setProperty("BUNDLES_INSTALLED", "true");
        application.sendBroadcast(new Intent(AuraConfig.ACTION_BROADCAST_BUNDLES_INSTALLED));
    }

    @SuppressLint({"DefaultLocale"})
    public static boolean a() {
        if (com.jingdong.aura.core.b.c.b() || !a.a() || Build.VERSION.SDK_INT < 14) {
            return false;
        }
        if (Build.VERSION.SDK_INT < 14 || Build.BRAND == null || !Build.BRAND.toLowerCase().contains("xiaomi") || Build.HARDWARE == null || !Build.HARDWARE.toLowerCase().contains("mt65")) {
            return true;
        }
        return false;
    }
}
