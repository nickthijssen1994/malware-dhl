package com.jd.lib.un.basewidget.widget.simple.footer;

import android.animation.ValueAnimator;
import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Paint;
import android.util.AttributeSet;
import androidx.annotation.AttrRes;
import androidx.annotation.ColorInt;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.core.graphics.ColorUtils;
import com.jd.lib.un.basewidget.widget.simple.abs.AbsRefreshInternal;
import com.jd.lib.un.basewidget.widget.simple.constant.RefreshSpinner;
import com.jd.lib.un.basewidget.widget.simple.interfaces.RefreshFooter;
import com.jd.lib.un.basewidget.widget.simple.interfaces.RefreshLayout;
import com.jd.lib.un.basewidget.widget.simple.utils.DpiUtils;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.Map;

/* compiled from: TbsSdkJava */
/* loaded from: classes.dex */
public class BallPulseFooter extends AbsRefreshInternal implements RefreshFooter {
    protected boolean a;
    protected boolean b;
    protected Paint c;
    protected int d;
    protected int e;
    protected float f;
    protected float[] g;
    protected boolean h;
    protected ArrayList<ValueAnimator> i;
    protected Map<ValueAnimator, ValueAnimator.AnimatorUpdateListener> j;

    @Override // com.jd.lib.un.basewidget.widget.simple.interfaces.RefreshFooter
    public boolean setNoMoreData(boolean z) {
        return false;
    }

    public BallPulseFooter(@NonNull Context context) {
        this(context, null);
    }

    public BallPulseFooter(@NonNull Context context, @Nullable AttributeSet attributeSet) {
        this(context, attributeSet, 0);
    }

    public BallPulseFooter(@NonNull Context context, @Nullable AttributeSet attributeSet, @AttrRes int i) {
        super(context, attributeSet, i);
        this.d = -1118482;
        this.e = -1615546;
        this.g = new float[]{1.0f, 1.0f, 1.0f};
        this.h = false;
        this.j = new HashMap();
        setMinimumHeight(DpiUtils.dp2px(60.0f));
        this.c = new Paint();
        this.c.setColor(-1);
        this.c.setStyle(Paint.Style.FILL);
        this.c.setAntiAlias(true);
        this.mSpinnerStyle = RefreshSpinner.TRANSLATE;
        this.f = (float) DpiUtils.dp2px(4.0f);
        this.i = new ArrayList<>();
        int[] iArr = {120, 240, 360};
        for (final int i2 = 0; i2 < 3; i2++) {
            ValueAnimator ofFloat = ValueAnimator.ofFloat(1.0f, 0.3f, 1.0f);
            ofFloat.setDuration(750L);
            ofFloat.setRepeatCount(-1);
            ofFloat.setTarget(Integer.valueOf(i2));
            ofFloat.setStartDelay((long) iArr[i2]);
            this.j.put(ofFloat, new ValueAnimator.AnimatorUpdateListener() { // from class: com.jd.lib.un.basewidget.widget.simple.footer.BallPulseFooter.1
                @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                public void onAnimationUpdate(ValueAnimator valueAnimator) {
                    BallPulseFooter.this.g[i2] = ((Float) valueAnimator.getAnimatedValue()).floatValue();
                    this.postInvalidate();
                }
            });
            this.i.add(ofFloat);
        }
    }

    @Override // android.view.View, android.view.ViewGroup
    protected void onDetachedFromWindow() {
        super.onDetachedFromWindow();
        if (this.i != null) {
            for (int i = 0; i < this.i.size(); i++) {
                this.i.get(i).cancel();
                this.i.get(i).removeAllListeners();
                this.i.get(i).removeAllUpdateListeners();
            }
        }
    }

    @Override // android.view.View, android.view.ViewGroup
    protected void dispatchDraw(Canvas canvas) {
        int width = getWidth();
        int height = getHeight();
        float f = this.f;
        float min = (((float) Math.min(width, height)) - (f * 2.0f)) / 6.0f;
        float f2 = 2.0f * min;
        float f3 = ((float) (width / 2)) - (f + f2);
        float f4 = (float) (height / 2);
        for (int i = 0; i < 3; i++) {
            canvas.save();
            float f5 = (float) i;
            canvas.translate((f2 * f5) + f3 + (this.f * f5), f4);
            float[] fArr = this.g;
            canvas.scale(fArr[i], fArr[i]);
            canvas.drawCircle(0.0f, 0.0f, min, this.c);
            canvas.restore();
        }
        super.dispatchDraw(canvas);
    }

    @Override // com.jd.lib.un.basewidget.widget.simple.abs.AbsRefreshInternal, com.jd.lib.un.basewidget.widget.simple.interfaces.RefreshInternal
    public void onStartAnimator(@NonNull RefreshLayout refreshLayout, int i, int i2) {
        if (!this.h) {
            for (int i3 = 0; i3 < this.i.size(); i3++) {
                ValueAnimator valueAnimator = this.i.get(i3);
                ValueAnimator.AnimatorUpdateListener animatorUpdateListener = this.j.get(valueAnimator);
                if (animatorUpdateListener != null) {
                    valueAnimator.addUpdateListener(animatorUpdateListener);
                }
                valueAnimator.start();
            }
            this.h = true;
            this.c.setColor(this.e);
        }
    }

    @Override // com.jd.lib.un.basewidget.widget.simple.abs.AbsRefreshInternal, com.jd.lib.un.basewidget.widget.simple.interfaces.RefreshInternal
    public int onFinish(@NonNull RefreshLayout refreshLayout, boolean z) {
        ArrayList<ValueAnimator> arrayList = this.i;
        if (arrayList != null && this.h) {
            this.h = false;
            this.g = new float[]{1.0f, 1.0f, 1.0f};
            Iterator<ValueAnimator> it = arrayList.iterator();
            while (it.hasNext()) {
                ValueAnimator next = it.next();
                if (next != null) {
                    next.removeAllUpdateListeners();
                    next.end();
                }
            }
        }
        this.c.setColor(this.d);
        return 0;
    }

    @Override // com.jd.lib.un.basewidget.widget.simple.abs.AbsRefreshInternal, com.jd.lib.un.basewidget.widget.simple.interfaces.RefreshInternal
    @Deprecated
    public void setPrimaryColors(@ColorInt int... iArr) {
        if (!this.b && iArr.length > 1) {
            b(iArr[0]);
            this.b = false;
        }
        if (!this.a) {
            if (iArr.length > 1) {
                a(iArr[1]);
            } else if (iArr.length > 0) {
                a(ColorUtils.compositeColors(-1711276033, iArr[0]));
            }
            this.a = false;
        }
    }

    public BallPulseFooter a(@ColorInt int i) {
        this.d = i;
        this.a = true;
        if (!this.h) {
            this.c.setColor(i);
        }
        return this;
    }

    public BallPulseFooter b(@ColorInt int i) {
        this.e = i;
        this.b = true;
        if (this.h) {
            this.c.setColor(i);
        }
        return this;
    }
}
