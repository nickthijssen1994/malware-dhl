package com.jd.lib.un.basewidget.widget.banner.page;

import android.annotation.SuppressLint;
import android.content.Context;
import android.graphics.Paint;
import android.text.TextPaint;
import android.text.TextUtils;
import android.util.AttributeSet;
import android.widget.RelativeLayout;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.viewpager.widget.PagerAdapter;
import androidx.viewpager.widget.ViewPager;
import com.jd.lib.un.basewidget.R;
import com.jd.lib.un.basewidget.widget.banner.BannerAdapter;
import com.jd.lib.un.basewidget.widget.banner.BannerView;

/* compiled from: TbsSdkJava */
/* loaded from: classes.dex */
public class PageView extends RelativeLayout implements ViewPager.OnAdapterChangeListener, ViewPager.OnPageChangeListener {
    private BannerAdapter bannerAdapter;
    private BannerView bannerView;
    private TextView divideLineTv;
    private TextView endValueTv;
    private int mDivideLineColor;
    private int mDivideLineSize;
    private int mEndValueColor;
    private int mEndValueSize;
    private int mMaxValue;
    private int mMinValue;
    private int mValue;
    private int mValueColor;
    private int mValueSize;
    private TextView valueTv;

    public void onPageScrollStateChanged(int i) {
    }

    public void onPageScrolled(int i, float f, int i2) {
    }

    public PageView(Context context) {
        this(context, null);
    }

    public PageView(Context context, @Nullable AttributeSet attributeSet) {
        this(context, attributeSet, 0);
    }

    public PageView(Context context, @Nullable AttributeSet attributeSet, int i) {
        super(context, attributeSet, i);
        this.mMinValue = 1;
        this.mMaxValue = 1;
        this.mValueSize = 16;
        this.mEndValueSize = 12;
        this.mDivideLineSize = 12;
        this.mValueColor = -1;
        this.mDivideLineColor = -1;
        this.mEndValueColor = -1;
        this.mValue = 1;
        initView();
        configWidth();
    }

    private void configWidth() {
        configValueWidth();
        configDivideWidth();
        configEndValueWidth();
    }

    private void configEndValueWidth() {
        TextPaint paint = this.endValueTv.getPaint();
        float parseStrWidth = parseStrWidth(paint, this.mMaxValue + "");
        RelativeLayout.LayoutParams layoutParams = (RelativeLayout.LayoutParams) this.endValueTv.getLayoutParams();
        layoutParams.width = (int) parseStrWidth;
        this.endValueTv.setLayoutParams(layoutParams);
    }

    private void configDivideWidth() {
        float parseStrWidth = parseStrWidth(this.divideLineTv.getPaint(), "/");
        RelativeLayout.LayoutParams layoutParams = (RelativeLayout.LayoutParams) this.divideLineTv.getLayoutParams();
        layoutParams.width = (int) parseStrWidth;
        this.divideLineTv.setLayoutParams(layoutParams);
    }

    private void configValueWidth() {
        TextPaint paint = this.valueTv.getPaint();
        float parseStrWidth = parseStrWidth(paint, this.mMaxValue + "");
        RelativeLayout.LayoutParams layoutParams = (RelativeLayout.LayoutParams) this.valueTv.getLayoutParams();
        layoutParams.width = (int) parseStrWidth;
        this.valueTv.setLayoutParams(layoutParams);
    }

    @SuppressLint({"ResourceType"})
    private void initView() {
        setGravity(17);
        setBackgroundResource(R.drawable.page_num_bg);
        this.valueTv = new TextView(getContext());
        this.valueTv.setTextColor(this.mValueColor);
        this.valueTv.setTextSize((float) this.mValueSize);
        TextView textView = this.valueTv;
        textView.setText(this.mValue + "");
        this.valueTv.setId(17);
        addView(this.valueTv);
        this.divideLineTv = new TextView(getContext());
        this.divideLineTv.setTextColor(this.mDivideLineColor);
        this.divideLineTv.setTextSize((float) this.mDivideLineColor);
        this.divideLineTv.setText("/");
        this.divideLineTv.setId(18);
        RelativeLayout.LayoutParams layoutParams = new RelativeLayout.LayoutParams(-2, -2);
        layoutParams.addRule(1, 17);
        layoutParams.addRule(4, 17);
        addView(this.divideLineTv, layoutParams);
        this.endValueTv = new TextView(getContext());
        this.endValueTv.setTextSize((float) this.mEndValueSize);
        this.endValueTv.setTextColor(this.mEndValueColor);
        TextView textView2 = this.endValueTv;
        textView2.setText(this.endValueTv + "");
        RelativeLayout.LayoutParams layoutParams2 = new RelativeLayout.LayoutParams(-2, -2);
        layoutParams2.addRule(1, 18);
        layoutParams2.addRule(4, 18);
        addView(this.endValueTv, layoutParams2);
        setPadding(30, 0, 30, 5);
    }

    private float parseStrWidth(Paint paint, String str) {
        if (str == null || TextUtils.isEmpty(str)) {
            return 0.0f;
        }
        return paint.measureText(str);
    }

    public void setBannerView(BannerView bannerView) {
        this.bannerView = bannerView;
        this.bannerAdapter = bannerView.getAdapter();
        this.bannerView.removeOnPageChangeListener(this);
        this.bannerView.addOnPageChangeListener(this);
        this.bannerView.removeOnAdapterChangeListener(this);
        this.bannerView.addOnAdapterChangeListener(this);
        setMaxValue(getCount());
    }

    private int getCount() {
        BannerAdapter bannerAdapter = this.bannerAdapter;
        if (bannerAdapter == null) {
            return 0;
        }
        return bannerAdapter.getItemCount();
    }

    public void setValue(int i) {
        TextView textView = this.valueTv;
        textView.setText(i + "");
    }

    public void setMaxValue(int i) {
        this.mMaxValue = i;
        TextView textView = this.endValueTv;
        textView.setText(i + "");
        configValueWidth();
        configEndValueWidth();
    }

    public void setValueSize(int i) {
        this.mValueSize = i;
        configValueWidth();
    }

    public void setEndValueSize(int i) {
        this.mEndValueSize = i;
        configEndValueWidth();
    }

    public void setDivideLineSize(int i) {
        this.mDivideLineSize = i;
        configDivideWidth();
    }

    public void setValueColor(int i) {
        this.mValueColor = i;
        this.valueTv.setTextColor(i);
    }

    public void setDivideLineColor(int i) {
        this.mDivideLineColor = i;
        this.divideLineTv.setTextColor(i);
    }

    public void setEndValueColor(int i) {
        this.mEndValueColor = i;
        this.endValueTv.setTextColor(i);
    }

    public void onAdapterChanged(@NonNull ViewPager viewPager, @Nullable PagerAdapter pagerAdapter, @Nullable PagerAdapter pagerAdapter2) {
        if (pagerAdapter2 != null && (pagerAdapter2 instanceof BannerAdapter)) {
            this.bannerAdapter = (BannerAdapter) pagerAdapter2;
            this.bannerView.setCurrentItem(0);
            setValue(1);
            setMaxValue(getCount());
        }
    }

    public void onPageSelected(int i) {
        setValue(i + 1);
    }
}
