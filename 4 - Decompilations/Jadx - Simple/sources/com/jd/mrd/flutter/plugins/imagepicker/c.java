package com.jd.mrd.flutter.plugins.imagepicker;

import android.app.Activity;
import android.os.Environment;
import io.flutter.embedding.engine.plugins.FlutterPlugin;
import io.flutter.embedding.engine.plugins.activity.ActivityAware;
import io.flutter.embedding.engine.plugins.activity.ActivityPluginBinding;
import io.flutter.plugin.common.BinaryMessenger;
import io.flutter.plugin.common.MethodCall;
import io.flutter.plugin.common.MethodChannel;
import io.flutter.plugin.common.PluginRegistry;
import java.lang.ref.WeakReference;

/* compiled from: TbsSdkJava */
/* loaded from: classes.dex */
public class c implements FlutterPlugin, ActivityAware, MethodChannel.MethodCallHandler {
    private static WeakReference<Activity> e;
    private ActivityPluginBinding a;
    private FlutterPlugin.FlutterPluginBinding b;
    private b c;
    private MethodChannel d;

    public void onDetachedFromEngine(FlutterPlugin.FlutterPluginBinding flutterPluginBinding) {
    }

    public static Activity a() {
        return e.get();
    }

    public void onAttachedToEngine(FlutterPlugin.FlutterPluginBinding flutterPluginBinding) {
        this.b = flutterPluginBinding;
    }

    public void a(BinaryMessenger binaryMessenger, Activity activity, PluginRegistry.Registrar registrar, ActivityPluginBinding activityPluginBinding) {
        e = new WeakReference<>(activity);
        this.d = new MethodChannel(binaryMessenger, "plugins.flutter.jd.mrd/image_picker");
        this.d.setMethodCallHandler(this);
        this.c = new b(activity.getExternalFilesDir(Environment.DIRECTORY_PICTURES));
        if (registrar != null) {
            registrar.addActivityResultListener(this.c);
        } else {
            activityPluginBinding.addActivityResultListener(this.c);
        }
    }

    public void onMethodCall(MethodCall methodCall, MethodChannel.Result result) {
        if (e.get() == null || e.get().isFinishing()) {
            result.error("no_activity", "image_picker plugin requires a foreground activity.", (Object) null);
        } else if (methodCall.method.equals("pickImage")) {
            int intValue = ((Integer) methodCall.argument("source")).intValue();
            switch (intValue) {
                case 0:
                    this.c.b(methodCall, result);
                    return;
                case 1:
                    this.c.a(methodCall, result);
                    return;
                default:
                    throw new IllegalArgumentException("Invalid image source: " + intValue);
            }
        } else if (methodCall.method.equals("compressImages")) {
            new a().a(methodCall, result);
        } else {
            result.notImplemented();
        }
    }

    public void onAttachedToActivity(ActivityPluginBinding activityPluginBinding) {
        this.a = activityPluginBinding;
        a(this.b.getBinaryMessenger(), this.a.getActivity(), null, activityPluginBinding);
    }

    public void onDetachedFromActivityForConfigChanges() {
        onDetachedFromActivity();
    }

    public void onReattachedToActivityForConfigChanges(ActivityPluginBinding activityPluginBinding) {
        onAttachedToActivity(activityPluginBinding);
    }

    public void onDetachedFromActivity() {
        this.a.removeActivityResultListener(this.c);
        this.d.setMethodCallHandler((MethodChannel.MethodCallHandler) null);
    }
}
