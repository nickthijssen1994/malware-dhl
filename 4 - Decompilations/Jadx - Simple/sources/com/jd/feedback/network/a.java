package com.jd.feedback.network;

import android.os.Process;
import android.text.TextUtils;
import android.util.Base64;
import android.util.Log;
import com.google.gson.Gson;
import com.huawei.hms.adapter.internal.CommonCode;
import com.huawei.hms.support.api.push.utils.common.base.PushConst;
import com.jd.feedback.FeedbackSDK;
import com.jd.feedback.b.f;
import com.jd.feedback.network.result.FeedbackRequestResult;
import com.jd.feedback.network.result.MessageRequestResult;
import com.jd.feedback.network.result.StatisticsRequestResult;
import com.jd.push.common.constant.Constants;
import com.jingdong.common.utils.Configuration;
import io.reactivex.Observable;
import io.reactivex.functions.Consumer;
import java.security.InvalidParameterException;
import java.util.ArrayList;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;
import org.json.JSONException;
import org.json.JSONObject;

/* compiled from: TbsSdkJava */
/* loaded from: classes.dex */
public final class a {
    public static Observable<FeedbackRequestResult> a(boolean z, String str, String str2) {
        String str3;
        Log.i("FeedbackRequestHelper", ">>>>>>>>>>>> Request openFeedbackImage, isReply: " + z + " >>>>>>>>>>>>");
        LinkedHashMap<String, String> b = b("openFeedbackImage");
        ArrayList arrayList = new ArrayList();
        arrayList.add(Constants.JdPushMsg.JSON_SDK_VER);
        arrayList.add("appKey");
        arrayList.add("isJailbroken");
        arrayList.add(CommonCode.MapKey.HAS_RESOLUTION);
        arrayList.add("userId");
        if (!z) {
            arrayList.add(Constants.JdPushMsg.JSON_KEY_PKG_NAME_full);
            arrayList.add("networkName");
            arrayList.add("userName");
        }
        JSONObject a = a(arrayList, b);
        try {
            if (z) {
                str3 = str2 + a.get("userId") + a.get(Constants.JdPushMsg.JSON_SDK_VER) + a.get("appKey");
            } else {
                str3 = b.get("clientVersion") + b.get("build") + b.get(Constants.JdPushMsg.JSON_KEY_UUID) + a.get(Constants.JdPushMsg.JSON_SDK_VER) + a.get("appKey");
            }
            a.put("sign", d(str3));
        } catch (JSONException e) {
            e.printStackTrace();
        }
        if (z) {
            try {
                a.put("feedbackId", c(str2));
                a.put("module", "reply");
            } catch (JSONException e2) {
                e2.printStackTrace();
            }
        }
        a.put("image", str);
        b.put("body", a.toString());
        return a(b, "openFeedbackImage");
    }

    public static Observable<FeedbackRequestResult> a(String str, String str2, String str3, List<String> list) {
        a("clientVersion", "build", Configuration.PARTNER, "appKey", "secretKey");
        return a(false, str, str2, list, str3, null);
    }

    public static Observable<FeedbackRequestResult> a(String str, List<String> list, String str2) {
        a("clientVersion", "build", Configuration.PARTNER, "appKey", "secretKey", "userId");
        return a(true, null, str, list, null, str2);
    }

    private static Observable<FeedbackRequestResult> a(boolean z, String str, String str2, List<String> list, String str3, String str4) {
        String str5;
        Log.i("FeedbackRequestHelper", ">>>>>>>>>>>> Request openFeedback, isReply: " + z + " >>>>>>>>>>>>");
        LinkedHashMap<String, String> b = b("openFeedback");
        ArrayList arrayList = new ArrayList();
        arrayList.add(Constants.JdPushMsg.JSON_SDK_VER);
        arrayList.add("appKey");
        arrayList.add("userId");
        if (!z) {
            arrayList.add(Constants.JdPushMsg.JSON_KEY_PKG_NAME_full);
            arrayList.add("isJailbroken");
            arrayList.add(CommonCode.MapKey.HAS_RESOLUTION);
            arrayList.add("networkName");
            arrayList.add("userName");
        }
        JSONObject a = a(arrayList, b);
        try {
            if (z) {
                str5 = str4 + a.get("userId") + a.get(Constants.JdPushMsg.JSON_SDK_VER) + a.get("appKey");
            } else {
                str5 = b.get("clientVersion") + b.get("build") + b.get(Constants.JdPushMsg.JSON_KEY_UUID) + a.get(Constants.JdPushMsg.JSON_SDK_VER) + a.get("appKey");
            }
            a.put("sign", d(str5));
        } catch (JSONException e) {
            e.printStackTrace();
        }
        try {
            StringBuilder sb = new StringBuilder();
            for (String str6 : list) {
                sb.append(str6);
                sb.append(',');
            }
            if (sb.toString().endsWith(",")) {
                sb.deleteCharAt(sb.length() - 1);
            }
            a.put("images", sb.toString());
            a.put("content", str2);
            if (z) {
                a.put("module", "reply");
                a.put("feedbackId", c(str4));
            } else {
                a.put(PushConst.EXTRA_SELFSHOW_TYPE_KEY, c(str));
                a.put("phone", c(str3));
                a.put("source", c(FeedbackSDK.getSource()));
                if (!TextUtils.isEmpty(FeedbackSDK.getExt())) {
                    a.put("ext", FeedbackSDK.getExt());
                }
            }
        } catch (JSONException e2) {
            e2.printStackTrace();
        }
        b.put("body", a.toString());
        return a(b, "openFeedback");
    }

    public static Observable<FeedbackRequestResult> a(LinkedHashMap<String, String> linkedHashMap, final String str) {
        a(linkedHashMap);
        return ((IFeedbackApiService) b.a(IFeedbackApiService.class)).a(str, linkedHashMap).doOnNext(new Consumer<FeedbackRequestResult>() { // from class: com.jd.feedback.network.a.1
            public final /* synthetic */ void accept(Object obj) {
                FeedbackRequestResult feedbackRequestResult = (FeedbackRequestResult) obj;
                if (str.equals("openFeedbackImage")) {
                    Log.i("FeedbackRequestHelper", "图片上传结束 at thread " + Process.myTid());
                }
                Log.i("FeedbackRequestHelper", "Response " + str + ": " + new Gson().toJson(feedbackRequestResult));
                String state = feedbackRequestResult.getState();
                if (state == null || !state.equals("200")) {
                    throw new Exception(feedbackRequestResult.getMessage());
                }
                Log.i("FeedbackRequestHelper", "<<<<<<<<<<<< Request " + str + " End, state: " + state + " <<<<<<<<<<<<");
            }
        });
    }

    public static Observable<MessageRequestResult> a(String str) {
        a("clientVersion", "build", Configuration.PARTNER, "appKey", "secretKey", "userId");
        return a(str, false, (String) null);
    }

    public static Observable<MessageRequestResult> a(String str, String str2) {
        a("clientVersion", "build", Configuration.PARTNER, "appKey", "secretKey", "userId");
        return a(str, true, str2);
    }

    private static Observable<MessageRequestResult> a(String str, boolean z, String str2) {
        String str3;
        Log.i("FeedbackRequestHelper", ">>>>>>>>>>>> Request openFeedbackList, isReply: " + z + " >>>>>>>>>>>>");
        LinkedHashMap<String, String> b = b("openFeedbackList");
        ArrayList arrayList = new ArrayList();
        arrayList.add(Constants.JdPushMsg.JSON_SDK_VER);
        arrayList.add("appKey");
        arrayList.add("isJailbroken");
        arrayList.add(CommonCode.MapKey.HAS_RESOLUTION);
        arrayList.add("userId");
        JSONObject a = a(arrayList, b);
        try {
            if (z) {
                str3 = str2 + a.get("userId") + a.get(Constants.JdPushMsg.JSON_SDK_VER) + a.get("appKey");
            } else {
                str3 = b.get("clientVersion") + b.get("build") + b.get(Constants.JdPushMsg.JSON_KEY_UUID) + a.get(Constants.JdPushMsg.JSON_SDK_VER) + a.get("appKey");
            }
            a.put("sign", d(str3));
        } catch (JSONException e) {
            e.printStackTrace();
        }
        try {
            a.put("pageNumber", c(str));
            if (z) {
                a.put("module", "reply");
                a.put("feedbackId", c(str2));
            }
        } catch (JSONException e2) {
            e2.printStackTrace();
        }
        b.put("body", a.toString());
        a(b);
        return ((IFeedbackApiService) b.a(IFeedbackApiService.class)).b("openFeedbackList", b).doOnNext(new Consumer<MessageRequestResult>("openFeedbackList") { // from class: com.jd.feedback.network.a.2
            public final /* synthetic */ void accept(Object obj) {
                MessageRequestResult messageRequestResult = (MessageRequestResult) obj;
                Log.i("FeedbackRequestHelper", "Response " + "openFeedbackList" + ": " + new Gson().toJson(messageRequestResult));
                String state = messageRequestResult.getState();
                if (state == null || !state.equals("200")) {
                    throw new Exception(messageRequestResult.getMessage());
                }
                Log.i("FeedbackRequestHelper", "<<<<<<<<<<<< Request " + "openFeedbackList" + " End, state: " + state + " <<<<<<<<<<<<");
            }
        });
    }

    public static Observable<StatisticsRequestResult> a() {
        a("clientVersion", "build", Configuration.PARTNER, "appKey", "secretKey", "userId");
        Log.i("FeedbackRequestHelper", ">>>>>>>>>>>> Request openFeedbackStatistics >>>>>>>>>>>>");
        LinkedHashMap<String, String> b = b("openFeedbackStatistics");
        ArrayList arrayList = new ArrayList();
        arrayList.add("appKey");
        arrayList.add("userId");
        arrayList.add(Constants.JdPushMsg.JSON_SDK_VER);
        JSONObject a = a(arrayList, b);
        try {
            a.put("sign", d(a.get("appKey") + b.get(Configuration.CLIENT) + a.get("userId") + a.get(Constants.JdPushMsg.JSON_SDK_VER)));
        } catch (JSONException e) {
            e.printStackTrace();
        }
        b.put("body", a.toString());
        a(b);
        return ((IFeedbackApiService) b.a(IFeedbackApiService.class)).c("openFeedbackStatistics", b).doOnNext(new Consumer<StatisticsRequestResult>() { // from class: com.jd.feedback.network.a.3
            public final /* synthetic */ void accept(Object obj) {
                StatisticsRequestResult statisticsRequestResult = (StatisticsRequestResult) obj;
                Log.i("FeedbackRequestHelper", "Response openFeedbackStatistics: " + new Gson().toJson(statisticsRequestResult));
                String state = statisticsRequestResult.getState();
                if (state == null || !state.equals("200")) {
                    throw new Exception(statisticsRequestResult.getMessage());
                }
                Log.i("FeedbackRequestHelper", "<<<<<<<<<<<< Request openFeedbackStatistics End, state: " + state + " <<<<<<<<<<<<");
            }
        });
    }

    private static void a(LinkedHashMap<String, String> linkedHashMap) {
        linkedHashMap.put("sign", f.a(linkedHashMap, FeedbackSDK.getHostSecretKey()));
        Log.i("FeedbackRequestHelper", "params: -----------------------");
        for (Map.Entry<String, String> entry : linkedHashMap.entrySet()) {
            Log.i("FeedbackRequestHelper", "   " + ((Object) entry.getKey()) + ": " + ((Object) entry.getValue()));
        }
        Log.i("FeedbackRequestHelper", "-------------------- params end");
    }

    public static LinkedHashMap<String, String> b(String str) {
        LinkedHashMap<String, String> linkedHashMap = new LinkedHashMap<>();
        linkedHashMap.put("appid", c(FeedbackSDK.getAppId()));
        linkedHashMap.put("functionId", str);
        linkedHashMap.put("t", c(FeedbackSDK.getTime()));
        linkedHashMap.put(Configuration.CLIENT, c(FeedbackSDK.getClient()));
        linkedHashMap.put("clientVersion", c(FeedbackSDK.getClientVersion()));
        linkedHashMap.put("build", c(FeedbackSDK.getBuild()));
        linkedHashMap.put(Constants.JdPushMsg.JSON_KEY_UUID, c(FeedbackSDK.getUuid()));
        linkedHashMap.put(Constants.JdPushMsg.JSON_KEY_OS_VERSION, c(FeedbackSDK.getOsVersion()));
        linkedHashMap.put(Constants.JdPushMsg.JSON_KEY_NETWORKTYPE, c(FeedbackSDK.getNetworkType()));
        linkedHashMap.put(Configuration.PARTNER, c(FeedbackSDK.getPartner()));
        linkedHashMap.put("screen", c(FeedbackSDK.getScreen()));
        linkedHashMap.put("d_brand", c(FeedbackSDK.getBrand()));
        linkedHashMap.put("d_model", c(FeedbackSDK.getModel()));
        return linkedHashMap;
    }

    public static JSONObject a(List<String> list, Map<String, String> map) {
        if (map != null) {
            JSONObject jSONObject = new JSONObject();
            if (list.size() > 0) {
                for (String str : list) {
                    char c = 65535;
                    try {
                        switch (str.hashCode()) {
                            case -1962630338:
                                if (str.equals(Constants.JdPushMsg.JSON_SDK_VER)) {
                                    c = 0;
                                    break;
                                }
                                break;
                            case -1940815399:
                                if (str.equals("networkName")) {
                                    c = 6;
                                    break;
                                }
                                break;
                            case -1600030548:
                                if (str.equals(CommonCode.MapKey.HAS_RESOLUTION)) {
                                    c = 5;
                                    break;
                                }
                                break;
                            case -1411093378:
                                if (str.equals("appKey")) {
                                    c = 1;
                                    break;
                                }
                                break;
                            case -836030906:
                                if (str.equals("userId")) {
                                    c = 7;
                                    break;
                                }
                                break;
                            case -266666762:
                                if (str.equals("userName")) {
                                    c = '\b';
                                    break;
                                }
                                break;
                            case 3530173:
                                if (str.equals("sign")) {
                                    c = 3;
                                    break;
                                }
                                break;
                            case 908759025:
                                if (str.equals(Constants.JdPushMsg.JSON_KEY_PKG_NAME_full)) {
                                    c = 2;
                                    break;
                                }
                                break;
                            case 1878245817:
                                if (str.equals("isJailbroken")) {
                                    c = 4;
                                    break;
                                }
                                break;
                        }
                    } catch (JSONException e) {
                        e.printStackTrace();
                    }
                    switch (c) {
                        case 0:
                            jSONObject.put(Constants.JdPushMsg.JSON_SDK_VER, c(FeedbackSDK.getSdkVersion()));
                            continue;
                        case 1:
                            jSONObject.put("appKey", c(FeedbackSDK.getAppKey()));
                            continue;
                        case 2:
                            jSONObject.put(Constants.JdPushMsg.JSON_KEY_PKG_NAME_full, c(FeedbackSDK.getPackageName()));
                            continue;
                        case 3:
                            String c2 = c(map.get("clientVersion"));
                            String c3 = c(map.get("build"));
                            String c4 = c(map.get(Constants.JdPushMsg.JSON_KEY_UUID));
                            String c5 = c(FeedbackSDK.getSdkVersion());
                            String c6 = c(FeedbackSDK.getAppKey());
                            jSONObject.put("sign", d(c2 + c3 + c4 + c5 + c6));
                            continue;
                        case 4:
                            jSONObject.put("isJailbroken", FeedbackSDK.getIsJailbroken());
                            continue;
                        case 5:
                            jSONObject.put(CommonCode.MapKey.HAS_RESOLUTION, c(FeedbackSDK.getResolution()));
                            continue;
                        case 6:
                            if (!c(map.get(Constants.JdPushMsg.JSON_KEY_NETWORKTYPE)).equals("WIFI")) {
                                jSONObject.put("networkName", FeedbackSDK.getNetworkName());
                            } else {
                                continue;
                            }
                        case 7:
                            jSONObject.put("userId", c(FeedbackSDK.getUserId()));
                            continue;
                        case '\b':
                            jSONObject.put("userName", c(FeedbackSDK.getUserName()));
                            continue;
                        default:
                            throw new InvalidParameterException("Not support body param '" + str + "'");
                            break;
                    }
                    e.printStackTrace();
                }
            }
            return jSONObject;
        }
        throw new NullPointerException("Parameter 'commonParamMap' can not null !!!");
    }

    private static String c(String str) {
        return TextUtils.isEmpty(str) ? "" : str;
    }

    private static String d(String str) {
        return new String(Base64.encode(com.jd.feedback.b.a.a(str.getBytes(), FeedbackSDK.getSecretKey().getBytes(), FeedbackSDK.getAesIV()), 2));
    }

    public static void a(String... strArr) {
        for (String str : strArr) {
            char c = 65535;
            boolean z = true;
            switch (str.hashCode()) {
                case -1411093378:
                    if (str.equals("appKey")) {
                        c = 3;
                        break;
                    }
                    break;
                case -836030906:
                    if (str.equals("userId")) {
                        c = 6;
                        break;
                    }
                    break;
                case -792929080:
                    if (str.equals(Configuration.PARTNER)) {
                        c = 2;
                        break;
                    }
                    break;
                case -739567217:
                    if (str.equals("secretKey")) {
                        c = 4;
                        break;
                    }
                    break;
                case 94094958:
                    if (str.equals("build")) {
                        c = 1;
                        break;
                    }
                    break;
                case 771880589:
                    if (str.equals("clientVersion")) {
                        c = 0;
                        break;
                    }
                    break;
                case 908759025:
                    if (str.equals(Constants.JdPushMsg.JSON_KEY_PKG_NAME_full)) {
                        c = 5;
                        break;
                    }
                    break;
            }
            switch (c) {
                case 0:
                    if (FeedbackSDK.getClientVersion() == null || FeedbackSDK.getClientVersion().trim().length() == 0) {
                        z = false;
                        break;
                    }
                    break;
                case 1:
                    if (FeedbackSDK.getBuild() == null || FeedbackSDK.getBuild().trim().length() == 0) {
                        z = false;
                        break;
                    }
                    break;
                case 2:
                    if (FeedbackSDK.getPartner() == null || FeedbackSDK.getPartner().trim().length() == 0) {
                        z = false;
                        break;
                    }
                    break;
                case 3:
                    if (FeedbackSDK.getAppKey() == null || FeedbackSDK.getAppKey().trim().length() == 0) {
                        z = false;
                        break;
                    }
                    break;
                case 4:
                    if (FeedbackSDK.getSecretKey() == null || FeedbackSDK.getSecretKey().trim().length() == 0) {
                        z = false;
                        break;
                    }
                    break;
                case 5:
                    if (FeedbackSDK.getPackageName() == null || FeedbackSDK.getPackageName().trim().length() == 0) {
                        z = false;
                        break;
                    }
                    break;
                case 6:
                    if (FeedbackSDK.getUserId() == null || FeedbackSDK.getUserId().trim().length() == 0) {
                        z = false;
                        break;
                    }
                    break;
            }
            if (!z) {
                throw new IllegalStateException("Param '" + str + "' is necessary.");
            }
        }
    }
}
