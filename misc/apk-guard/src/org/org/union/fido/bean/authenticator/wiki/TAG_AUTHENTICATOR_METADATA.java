package org.org.union.fido.bean.authenticator.wiki;

import org.org.union.fido.util.Utility;

public class TAG_AUTHENTICATOR_METADATA
{
  public short authenticationAlg;
  public short authenticatorType;
  public short keyProtection;
  public short matcherProtection;
  public byte maxKeyHandles;
  public short tcDisplay;
  public int userVerification;
  
  public TAG_AUTHENTICATOR_METADATA() {}
  
  public void deserialize(byte[] paramArrayOfByte)
  {
    authenticatorType = ((short)Utility.byteToShort(paramArrayOfByte, 0, 2));
    maxKeyHandles = paramArrayOfByte[2];
    userVerification = Utility.byteToInt(paramArrayOfByte, 3, 7);
    keyProtection = ((short)Utility.byteToShort(paramArrayOfByte, 7, 9));
    matcherProtection = ((short)Utility.byteToShort(paramArrayOfByte, 9, 11));
    tcDisplay = ((short)Utility.byteToShort(paramArrayOfByte, 11, 13));
    authenticationAlg = ((short)Utility.byteToShort(paramArrayOfByte, 13, 15));
  }
  
  public byte[] serialize()
  {
    byte[] arrayOfByte1 = new byte['?'];
    Utility.shortToByte(arrayOfByte1, 0, 2, authenticatorType);
    arrayOfByte1[2] = maxKeyHandles;
    Utility.intToByte(arrayOfByte1, 3, 7, userVerification);
    Utility.shortToByte(arrayOfByte1, 7, 9, keyProtection);
    Utility.shortToByte(arrayOfByte1, 9, 11, matcherProtection);
    Utility.shortToByte(arrayOfByte1, 11, 13, tcDisplay);
    Utility.shortToByte(arrayOfByte1, 13, 15, authenticationAlg);
    byte[] arrayOfByte2 = new byte[15];
    System.arraycopy(arrayOfByte1, 0, arrayOfByte2, 0, 15);
    return arrayOfByte2;
  }
}
