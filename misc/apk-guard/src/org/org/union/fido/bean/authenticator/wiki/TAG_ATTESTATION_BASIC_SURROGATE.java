package org.org.union.fido.bean.authenticator.wiki;

import org.org.union.fido.util.CommonTools;
import org.org.union.fido.util.Utility;

public class TAG_ATTESTATION_BASIC_SURROGATE
{
  public byte[] signature;
  
  public TAG_ATTESTATION_BASIC_SURROGATE() {}
  
  public void deserialize(byte[] paramArrayOfByte)
  {
    if (11782 == Utility.byteToShort(paramArrayOfByte, 0, 2))
    {
      int i = Utility.byteToShort(paramArrayOfByte, 2, 4);
      signature = new byte[i];
      System.arraycopy(paramArrayOfByte, 4, signature, 0, i);
    }
  }
  
  public byte[] serialize()
  {
    byte[] arrayOfByte1 = new byte['?'];
    Utility.shortToByte(arrayOfByte1, 0, 2, 15880);
    int i;
    if (CommonTools.isValidateByteArray(signature))
    {
      Utility.shortToByte(arrayOfByte1, 4, 6, 11782);
      i = signature.length;
      Utility.shortToByte(arrayOfByte1, 6, 8, i);
      System.arraycopy(signature, 0, arrayOfByte1, 8, i);
      i += 8;
    }
    else
    {
      i = 4;
    }
    Utility.shortToByte(arrayOfByte1, 2, 4, i - 4);
    byte[] arrayOfByte2 = new byte[i];
    System.arraycopy(arrayOfByte1, 0, arrayOfByte2, 0, i);
    return arrayOfByte2;
  }
}
