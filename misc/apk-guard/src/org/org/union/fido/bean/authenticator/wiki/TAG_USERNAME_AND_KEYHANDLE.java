package org.org.union.fido.bean.authenticator.wiki;

import org.org.union.fido.util.StringTools;
import org.org.union.fido.util.Utility;

public class TAG_USERNAME_AND_KEYHANDLE
{
  public String keyHandle;
  public String userName;
  
  public TAG_USERNAME_AND_KEYHANDLE() {}
  
  public void deserialize(byte[] paramArrayOfByte)
  {
    int i = 0;
    if (10246 == Utility.byteToShort(paramArrayOfByte, 0, 2))
    {
      i = Utility.byteToShort(paramArrayOfByte, 2, 4) + 4;
      userName = Utility.byteToStr(paramArrayOfByte, 4, i);
    }
    int j = i + 2;
    if (10241 == Utility.byteToShort(paramArrayOfByte, i, j))
    {
      i = j + 2;
      keyHandle = Utility.byteToStr(paramArrayOfByte, i, Utility.byteToShort(paramArrayOfByte, j, i) + i);
    }
  }
  
  public byte[] serialize()
  {
    byte[] arrayOfByte1 = new byte['?'];
    Utility.shortToByte(arrayOfByte1, 0, 2, 14338);
    int i;
    if (StringTools.isValidateString(userName))
    {
      Utility.shortToByte(arrayOfByte1, 4, 6, 10246);
      i = userName.getBytes().length;
      Utility.shortToByte(arrayOfByte1, 6, 8, i);
      i += 8;
      Utility.strToByte(arrayOfByte1, 8, i, userName);
    }
    else
    {
      i = 4;
    }
    int j = i;
    if (StringTools.isValidateString(keyHandle))
    {
      j = i + 2;
      Utility.shortToByte(arrayOfByte1, i, j, 10241);
      int k = keyHandle.getBytes().length;
      i = j + 2;
      Utility.shortToByte(arrayOfByte1, j, i, k);
      j = k + i;
      Utility.strToByte(arrayOfByte1, i, j, keyHandle);
    }
    Utility.shortToByte(arrayOfByte1, 2, 4, j - 4);
    byte[] arrayOfByte2 = new byte[j];
    System.arraycopy(arrayOfByte1, 0, arrayOfByte2, 0, j);
    return arrayOfByte2;
  }
}
