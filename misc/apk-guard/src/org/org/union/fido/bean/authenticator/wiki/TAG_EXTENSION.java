package org.org.union.fido.bean.authenticator.wiki;

import org.org.union.fido.util.StringTools;
import org.org.union.fido.util.Utility;

public class TAG_EXTENSION
{
  public String data;
  public short jid = 15889;
  public String realm;
  
  public TAG_EXTENSION() {}
  
  public void deserialize(byte[] paramArrayOfByte)
  {
    int i = 0;
    if (11795 == Utility.byteToShort(paramArrayOfByte, 0, 2))
    {
      i = Utility.byteToShort(paramArrayOfByte, 2, 4) + 4;
      realm = Utility.byteToStr(paramArrayOfByte, 4, i);
    }
    int j = i + 2;
    if (11796 == Utility.byteToShort(paramArrayOfByte, i, j))
    {
      i = j + 2;
      data = Utility.byteToStr(paramArrayOfByte, i, Utility.byteToShort(paramArrayOfByte, j, i) + i);
    }
  }
  
  public byte[] serialize()
  {
    byte[] arrayOfByte1 = new byte['?'];
    Utility.shortToByte(arrayOfByte1, 0, 2, jid);
    int i;
    if (StringTools.isValidateString(realm))
    {
      Utility.shortToByte(arrayOfByte1, 4, 6, 11795);
      i = realm.getBytes().length;
      Utility.shortToByte(arrayOfByte1, 6, 8, i);
      i += 8;
      Utility.strToByte(arrayOfByte1, 8, i, realm);
    }
    else
    {
      i = 4;
    }
    int j = i;
    if (StringTools.isValidateString(data))
    {
      j = i + 2;
      Utility.shortToByte(arrayOfByte1, i, j, 11796);
      int k = data.getBytes().length;
      i = j + 2;
      Utility.shortToByte(arrayOfByte1, j, i, k);
      j = k + i;
      Utility.strToByte(arrayOfByte1, i, j, data);
    }
    Utility.shortToByte(arrayOfByte1, 2, 4, j - 4);
    byte[] arrayOfByte2 = new byte[j];
    System.arraycopy(arrayOfByte1, 0, arrayOfByte2, 0, j);
    return arrayOfByte2;
  }
}
