package org.org.union.fido.service;

import android.content.Context;
import android.os.Binder;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Set;
import org.org.union.fido.bean.Extension;
import org.org.union.fido.bean.Transaction;
import org.org.union.fido.bean.authenticator.DisplayPNGCharacteristicsDescriptor;
import org.org.union.fido.bean.authenticator.command.DeregisterCommand;
import org.org.union.fido.bean.authenticator.command.DeregisterResponse;
import org.org.union.fido.bean.authenticator.command.GetInfoCommand;
import org.org.union.fido.bean.authenticator.command.GetInfoResponse;
import org.org.union.fido.bean.authenticator.command.OpenSettingsCommand;
import org.org.union.fido.bean.authenticator.command.OpenSettingsResponse;
import org.org.union.fido.bean.authenticator.command.RegisterCommand;
import org.org.union.fido.bean.authenticator.command.RegisterResponse;
import org.org.union.fido.bean.authenticator.command.SignCommand;
import org.org.union.fido.bean.authenticator.command.SignResponse;
import org.org.union.fido.bean.authenticator.wiki.TAG_AUTHENTICATOR_INFO;
import org.org.union.fido.bean.authenticator.wiki.TAG_AUTHENTICATOR_METADATA;
import org.org.union.fido.bean.authenticator.wiki.TAG_EXTENSION;
import org.org.union.fido.bean.authenticator.wiki.TAG_TC_DISPLAY_PNG_CHARACTERISTICS;
import org.org.union.fido.bean.authenticator.wiki.TAG_UAFV1_KRD;
import org.org.union.fido.bean.authenticator.wiki.TAG_UAFV1_REG_ASSERTION;
import org.org.union.fido.bean.parts.AuthenticationEntity;
import org.org.union.fido.bean.wiki.ASMRequest;
import org.org.union.fido.bean.wiki.ASMResponse;
import org.org.union.fido.bean.wiki.AppRegistration;
import org.org.union.fido.bean.wiki.AsmStatusCode;
import org.org.union.fido.bean.wiki.AuthenticateIn;
import org.org.union.fido.bean.wiki.AuthenticateOut;
import org.org.union.fido.bean.wiki.AuthenticatorInfo;
import org.org.union.fido.bean.wiki.CommitIn;
import org.org.union.fido.bean.wiki.DeregisterIn;
import org.org.union.fido.bean.wiki.GetInfoOut;
import org.org.union.fido.bean.wiki.GetRegistrationsOut;
import org.org.union.fido.bean.wiki.RegisterIn;
import org.org.union.fido.bean.wiki.RegisterOut;
import org.org.union.fido.common.GlobalConfiguration;
import org.org.union.fido.helpers.AuthenticationManager;
import org.org.union.fido.util.CommonTools;
import org.org.union.fido.util.CryptoTools;
import org.org.union.fido.util.DateTools;
import org.org.union.fido.util.StringTools;
import org.org.union.fido.util.UAFTools;

public class AsmService
  implements AsmStatusCode
{
  static final int MSG_SAY_HELLO = 1;
  private static final String PAGE_KEY = "AsmService";
  private AuthenticationManager authDBManager;
  private AuthenticatorService mAuthenticateService;
  Context mContext;
  
  public AsmService()
  {
    mAuthenticateService = new AuthenticatorService();
  }
  
  public AsmService(Context paramContext)
  {
    mContext = paramContext;
    mAuthenticateService = new AuthenticatorService(paramContext);
    authDBManager = new AuthenticationManager(paramContext.getApplicationContext());
  }
  
  private ASMResponse authenticateRequest(ASMRequest paramASMRequest)
  {
    ASMResponse localASMResponse = new ASMResponse();
    AuthenticatorInfo localAuthenticatorInfo = GlobalConfiguration.locateAuthenticator(authenticatorIndex.shortValue());
    if (localAuthenticatorInfo == null)
    {
      statusCode = 1;
      return localASMResponse;
    }
    Object localObject1 = (AuthenticateIn)paramASMRequest.getArgs();
    paramASMRequest = paramASMRequest.getExts();
    Object localObject2 = appID;
    String str = UAFTools.genKHAccessToken((String)localObject2, null, null, UAFTools.getCallerID(mContext, Binder.getCallingUid()), true);
    Object localObject3 = keyIDs;
    if (!CommonTools.isValidateList((List)localObject3))
    {
      if (!isSecondFactorOnly) {
        break label589;
      }
    }
    else
    {
      ArrayList localArrayList = new ArrayList();
      if (!isRoamingAuthenticator)
      {
        localObject3 = ((List)localObject3).iterator();
        while (((Iterator)localObject3).hasNext())
        {
          Object localObject4 = (String)((Iterator)localObject3).next();
          localObject4 = authDBManager.getEntity((String)localObject2, (String)localObject4);
          if (localObject4 != null)
          {
            localObject4 = ((AuthenticationEntity)localObject4).getKeyHandle();
            if (StringTools.isValidateString((String)localObject4)) {
              localArrayList.add(localObject4);
            }
          }
        }
      }
      localObject2 = ((List)localObject3).iterator();
      while (((Iterator)localObject2).hasNext())
      {
        localObject3 = (String)((Iterator)localObject2).next();
        if (StringTools.isValidateString((String)localObject3)) {
          localArrayList.add(localObject3);
        }
      }
      if (CommonTools.isValidateList(localArrayList))
      {
        localObject2 = new AuthenticateOut();
        assertionScheme = assertionScheme;
        paramASMRequest = triggerSignCommand(localAuthenticatorInfo, (AuthenticateIn)localObject1, str, localArrayList, null, paramASMRequest);
        int i = statusCode;
        s1 = 5;
        if (i == 0)
        {
          localObject1 = userNameAndKeyHandle;
          if ((!isSecondFactorOnly) && (CommonTools.isValidateList((List)localObject1)))
          {
            statusCode = s1;
            return localASMResponse;
          }
          assertion = StringTools.urlSafeBase64Enc(assertion);
          statusCode = 0;
          responseData = localObject2;
          return localASMResponse;
        }
        if (statusCode == 5)
        {
          s1 = 3;
          break label583;
        }
        if (statusCode == 8)
        {
          s1 = 4;
          break label583;
        }
        i = statusCode;
        short s2 = 16;
        if (i == 16)
        {
          s1 = 6;
          break label583;
        }
        if (statusCode == 19)
        {
          s1 = 9;
          break label583;
        }
        i = statusCode;
        s1 = 20;
        if (i == 20) {}
        for (s1 = s2;; s1 = s2)
        {
          statusCode = s1;
          return localASMResponse;
          i = statusCode;
          s2 = 21;
          if (i == 21)
          {
            s1 = 17;
            break label583;
          }
          if (statusCode == 22)
          {
            s1 = 18;
            break label583;
          }
          if (statusCode == 23)
          {
            statusCode = 19;
            return localASMResponse;
          }
          if (statusCode == 24) {
            break;
          }
          if (statusCode != 25) {
            break label535;
          }
        }
        label535:
        if (statusCode == 32)
        {
          statusCode = 22;
          return localASMResponse;
        }
        if (statusCode == 33)
        {
          statusCode = 23;
          return localASMResponse;
        }
        s1 = statusCode;
        break label583;
      }
    }
    short s1 = 2;
    label583:
    statusCode = s1;
    label589:
    return localASMResponse;
  }
  
  private void commitInRequest(ASMRequest paramASMRequest)
  {
    paramASMRequest = (CommitIn)paramASMRequest.getArgs();
    AuthenticationEntity localAuthenticationEntity = new AuthenticationEntity(aaid, keyID, "ready");
    if (commit)
    {
      authDBManager.updateStatus(localAuthenticationEntity);
      return;
    }
    authDBManager.delEntityByAaid(aaid, keyID);
  }
  
  private ASMResponse deregisterRequest(ASMRequest paramASMRequest)
  {
    ASMResponse localASMResponse = new ASMResponse();
    short s = authenticatorIndex.shortValue();
    Object localObject2 = GlobalConfiguration.locateAuthenticator(s);
    if (localObject2 != null)
    {
      DeregisterIn localDeregisterIn = (DeregisterIn)paramASMRequest.getArgs();
      String str1 = appID;
      String str2 = UAFTools.getCallerID(mContext, Binder.getCallingUid());
      paramASMRequest = null;
      Object localObject1 = null;
      str2 = UAFTools.genKHAccessToken(str1, null, null, str2, true);
      if (!isRoamingAuthenticator)
      {
        localObject2 = authDBManager.getEntity(appID, keyID);
        paramASMRequest = (ASMRequest)localObject1;
        if (localObject2 != null) {
          paramASMRequest = ((AuthenticationEntity)localObject2).getUserName();
        }
        authDBManager.delEntityByAppID(appID, keyID);
      }
      localObject1 = new DeregisterCommand();
      authenticatorIndex = ((byte)s);
      appID = str1;
      khAccessToken = str2;
      keyID = keyID;
      if (paramASMRequest != null) {
        userName = paramASMRequest;
      }
      paramASMRequest = mAuthenticateService.process(((DeregisterCommand)localObject1).serialize(), 13316);
      localObject1 = new DeregisterResponse();
      if (CommonTools.isValidateByteArray(paramASMRequest))
      {
        ((DeregisterResponse)localObject1).deserialize(paramASMRequest);
        if (statusCode == 6)
        {
          statusCode = 0;
          return localASMResponse;
        }
      }
    }
    statusCode = 1;
    return localASMResponse;
  }
  
  private ASMResponse getInfoRequest()
  {
    ASMResponse localASMResponse = new ASMResponse();
    Object localObject1 = new GetInfoCommand();
    localObject1 = mAuthenticateService.process(((GetInfoCommand)localObject1).serialize(), 13313);
    Object localObject2 = new GetInfoResponse();
    ((GetInfoResponse)localObject2).deserialize((byte[])localObject1);
    if (statusCode == 0)
    {
      Object localObject3 = authenticatorInfo;
      localObject2 = new ArrayList();
      ((List)localObject2).add(UAFTools.getAsmVersion());
      localObject1 = new ArrayList();
      localObject3 = ((List)localObject3).iterator();
      while (((Iterator)localObject3).hasNext())
      {
        Object localObject4 = (TAG_AUTHENTICATOR_INFO)((Iterator)localObject3).next();
        AuthenticatorInfo localAuthenticatorInfo = new AuthenticatorInfo();
        authenticatorIndex = ((short)authenticatorIndex);
        asmVersions = ((List)localObject2);
        isUserEnrolled = true;
        hasSettings = false;
        aaid = aaid;
        assertionScheme = assertionScheme;
        authenticationAlgorithm = authenticatorMetadata.authenticationAlg;
        attestationTypes = attestationType;
        userVerification = authenticatorMetadata.userVerification;
        keyProtection = authenticatorMetadata.keyProtection;
        matcherProtection = authenticatorMetadata.matcherProtection;
        attachmentHint = 1L;
        isSecondFactorOnly = false;
        isRoamingAuthenticator = false;
        supportedExtensionIDs = supportedExtensionID;
        tcDisplay = authenticatorMetadata.tcDisplay;
        tcDisplayContentType = tcDisplayContentType;
        ArrayList localArrayList = new ArrayList();
        localObject4 = tcDisplayPNGCharacteristics.iterator();
        while (((Iterator)localObject4).hasNext())
        {
          TAG_TC_DISPLAY_PNG_CHARACTERISTICS localTAG_TC_DISPLAY_PNG_CHARACTERISTICS = (TAG_TC_DISPLAY_PNG_CHARACTERISTICS)((Iterator)localObject4).next();
          DisplayPNGCharacteristicsDescriptor localDisplayPNGCharacteristicsDescriptor = new DisplayPNGCharacteristicsDescriptor();
          width = width;
          height = height;
          bitDepth = ((short)bitDepth);
          colorType = ((short)colorType);
          compression = ((short)colorType);
          filter = ((short)filter);
          interlace = ((short)interlace);
          localArrayList.add(localDisplayPNGCharacteristicsDescriptor);
        }
        tcDisplayPNGCharacteristics = localArrayList;
        title = "FIDO UAF1.0 Authenticator (ECDSA) for Android";
        description = "FIDO UAF1.0 Authenticator (ECDSA) for Android";
        icon = "data:image/png;base64,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";
        ((List)localObject1).add(localAuthenticatorInfo);
      }
      localObject2 = new GetInfoOut();
      Authenticators = ((List)localObject1);
      responseData = localObject2;
      statusCode = 0;
      return localASMResponse;
    }
    statusCode = 1;
    return localASMResponse;
  }
  
  private ASMResponse getRegistrationsRequest(ASMRequest paramASMRequest)
  {
    ASMResponse localASMResponse = new ASMResponse();
    Object localObject1 = GlobalConfiguration.locateAuthenticator(authenticatorIndex.shortValue());
    if (localObject1 == null) {}
    for (short s = 1;; s = 0)
    {
      statusCode = s;
      return localASMResponse;
      if (isRoamingAuthenticator) {
        break;
      }
      Object localObject2 = UAFTools.getCallerID(mContext, Binder.getCallingUid());
      paramASMRequest = new ArrayList();
      localObject1 = authDBManager.getRegistrations((String)localObject2, aaid);
      localObject2 = ((Map)localObject1).keySet().iterator();
      while (((Iterator)localObject2).hasNext())
      {
        String str = (String)((Iterator)localObject2).next();
        AppRegistration localAppRegistration = new AppRegistration();
        appID = str;
        keyIDs = ((List)((Map)localObject1).get(str));
        paramASMRequest.add(localAppRegistration);
      }
      localObject1 = new GetRegistrationsOut();
      appRegs = paramASMRequest;
      responseData = localObject1;
    }
    return localASMResponse;
  }
  
  private ASMResponse openSettingsRequest(ASMRequest paramASMRequest)
  {
    ASMResponse localASMResponse = new ASMResponse();
    short s = authenticatorIndex.shortValue();
    paramASMRequest = GlobalConfiguration.locateAuthenticator(s);
    if ((paramASMRequest != null) && (hasSettings))
    {
      paramASMRequest = new OpenSettingsCommand();
      authenticatorIndex = ((byte)s);
      paramASMRequest = mAuthenticateService.process(paramASMRequest.serialize(), 13318);
      OpenSettingsResponse localOpenSettingsResponse = new OpenSettingsResponse();
      if (CommonTools.isValidateByteArray(paramASMRequest))
      {
        localOpenSettingsResponse.deserialize(paramASMRequest);
        if (statusCode == 6)
        {
          statusCode = 0;
          return localASMResponse;
        }
      }
    }
    statusCode = 1;
    return localASMResponse;
  }
  
  private ASMResponse registerRequest(ASMRequest paramASMRequest)
  {
    ASMResponse localASMResponse = new ASMResponse();
    short s2 = authenticatorIndex.shortValue();
    AuthenticatorInfo localAuthenticatorInfo = GlobalConfiguration.locateAuthenticator(s2);
    short s1 = 1;
    if (localAuthenticatorInfo == null)
    {
      statusCode = s1;
      return localASMResponse;
    }
    RegisterIn localRegisterIn = (RegisterIn)paramASMRequest.getArgs();
    String str1 = appID;
    String str2 = UAFTools.getCallerID(mContext, Binder.getCallingUid());
    Object localObject2 = UAFTools.genKHAccessToken(str1, null, null, str2, true);
    Object localObject1 = new RegisterCommand();
    authenticatorIndex = ((byte)s2);
    appID = str1;
    finalChallenge = CryptoTools.doHash(finalChallenge.getBytes(), "SHA256");
    userName = username;
    attestationType = attestationType;
    khAccessToken = ((String)localObject2);
    localObject2 = paramASMRequest.getExts();
    Object localObject3;
    if (localObject2 != null)
    {
      paramASMRequest = new ArrayList();
      localObject2 = ((List)localObject2).iterator();
      while (((Iterator)localObject2).hasNext())
      {
        localObject3 = (Extension)((Iterator)localObject2).next();
        TAG_EXTENSION localTAG_EXTENSION = new TAG_EXTENSION();
        realm = ((Extension)localObject3).getId();
        data = ((Extension)localObject3).getData();
        paramASMRequest.add(localTAG_EXTENSION);
      }
      extensions = paramASMRequest;
    }
    localObject1 = mAuthenticateService.process(((RegisterCommand)localObject1).serialize(), 13314);
    paramASMRequest = new RegisterResponse();
    if (CommonTools.isValidateByteArray((byte[])localObject1)) {
      paramASMRequest.deserialize((byte[])localObject1);
    } else {
      statusCode = 1;
    }
    if (statusCode == 0)
    {
      localObject1 = assertion;
      localObject2 = new TAG_UAFV1_REG_ASSERTION();
      ((TAG_UAFV1_REG_ASSERTION)localObject2).deserialize((byte[])localObject1);
      if (!isRoamingAuthenticator)
      {
        localObject3 = new AuthenticationEntity();
        ((AuthenticationEntity)localObject3).setCallerID(str2);
        ((AuthenticationEntity)localObject3).setAppID(str1);
        ((AuthenticationEntity)localObject3).setKeyHandle(keyHandle);
        ((AuthenticationEntity)localObject3).setKeyID(StringTools.urlSafeBase64Enc(uafv1Krd.keyID));
        ((AuthenticationEntity)localObject3).setCurrentTimestamp(DateTools.getCurrentTimeStamp());
        ((AuthenticationEntity)localObject3).setStatus("ready");
        ((AuthenticationEntity)localObject3).setAaid(aaid);
        ((AuthenticationEntity)localObject3).setUserName(username);
        authDBManager.init((AuthenticationEntity)localObject3);
      }
      paramASMRequest = new RegisterOut();
      assertionScheme = assertionScheme;
      assertion = StringTools.urlSafeBase64Enc((byte[])localObject1);
      statusCode = 0;
      responseData = paramASMRequest;
      return localASMResponse;
    }
    if (statusCode == 5) {
      s1 = 3;
    }
    for (;;)
    {
      label472:
      statusCode = s1;
      return localASMResponse;
      if (statusCode == 8)
      {
        s1 = 4;
      }
      else
      {
        int i = statusCode;
        s2 = 16;
        if (i == 16)
        {
          s1 = 6;
        }
        else
        {
          i = statusCode;
          s1 = 19;
          if (i == 19)
          {
            s1 = 9;
          }
          else
          {
            if (statusCode == 20) {}
            for (s1 = s2;; s1 = s2)
            {
              statusCode = s1;
              return localASMResponse;
              i = statusCode;
              s2 = 21;
              if (i == 21)
              {
                s1 = 17;
                break label472;
              }
              if (statusCode == 22)
              {
                s1 = 18;
                break label472;
              }
              if (statusCode == 23) {
                break;
              }
              if (statusCode == 24)
              {
                statusCode = 20;
                return localASMResponse;
              }
              if (statusCode != 25) {
                break label641;
              }
            }
            label641:
            if (statusCode == 32)
            {
              statusCode = 22;
              return localASMResponse;
            }
            if (statusCode == 33)
            {
              statusCode = 23;
              return localASMResponse;
            }
            s1 = statusCode;
          }
        }
      }
    }
  }
  
  private SignResponse triggerSignCommand(AuthenticatorInfo paramAuthenticatorInfo, AuthenticateIn paramAuthenticateIn, String paramString1, List paramList1, String paramString2, List paramList2)
  {
    SignCommand localSignCommand = new SignCommand();
    authenticatorIndex = ((byte)authenticatorIndex);
    appID = appID;
    finalChallenge = CryptoTools.hash(finalChallenge, "SHA256");
    paramAuthenticatorInfo = transaction;
    if (CommonTools.isValidateList(paramAuthenticatorInfo))
    {
      if (paramAuthenticatorInfo.size() == 1) {}
      for (paramAuthenticatorInfo = new String(StringTools.urlSafeBase64Dec(((Transaction)paramAuthenticatorInfo.get(0)).getContent()));; paramAuthenticatorInfo = new String(StringTools.urlSafeBase64Dec(((Transaction)paramAuthenticatorInfo.get(0)).getContent())))
      {
        transactionContent = paramAuthenticatorInfo;
        break;
        CommonTools.isScreenOriatationPortrait(mContext);
        paramAuthenticateIn = paramAuthenticatorInfo.iterator();
        while (paramAuthenticateIn.hasNext()) {
          ((Transaction)paramAuthenticateIn.next()).getTcDisplayPNGCharacteristics();
        }
      }
    }
    khAccessToken = paramString1;
    keyHandles = paramList1;
    userName = paramString2;
    if (paramList2 != null)
    {
      paramAuthenticatorInfo = new ArrayList();
      paramAuthenticateIn = paramList2.iterator();
      while (paramAuthenticateIn.hasNext())
      {
        paramString1 = (Extension)paramAuthenticateIn.next();
        paramList1 = new TAG_EXTENSION();
        realm = paramString1.getId();
        data = paramString1.getData();
        paramAuthenticatorInfo.add(paramList1);
      }
      extensions = paramAuthenticatorInfo;
    }
    paramAuthenticatorInfo = mAuthenticateService.process(localSignCommand.serialize(), 13315);
    paramAuthenticateIn = new SignResponse();
    if (CommonTools.isValidateByteArray(paramAuthenticatorInfo))
    {
      paramAuthenticateIn.deserialize(paramAuthenticatorInfo);
      return paramAuthenticateIn;
    }
    statusCode = 1;
    return paramAuthenticateIn;
  }
  
  public ASMResponse process(ASMRequest paramASMRequest)
  {
    switch (1.$SwitchMap$cn$com$union$fido$bean$asm$Request[requestType.ordinal()])
    {
    default: 
      break;
    case 7: 
      commitInRequest(paramASMRequest);
      break;
    case 6: 
      return openSettingsRequest(paramASMRequest);
    case 5: 
      return getRegistrationsRequest(paramASMRequest);
    case 4: 
      return deregisterRequest(paramASMRequest);
    case 3: 
      return authenticateRequest(paramASMRequest);
    case 2: 
      return registerRequest(paramASMRequest);
    case 1: 
      return getInfoRequest();
    }
    return null;
  }
  
  public void setmContext(Context paramContext)
  {
    mContext = paramContext;
    mAuthenticateService.setmContext(paramContext);
  }
}
