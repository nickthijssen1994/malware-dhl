package org.org.union.fido.util.management;

import org.org.union.fido.bean.Version;
import org.org.union.fido.bean.uafclient.Operation;
import org.org.union.fido.bean.uafclient.OperationHeader;
import org.org.union.fido.util.StringTools;
import org.org.union.fido.util.UAFTools;

public class HeaderValid
{
  public HeaderValid() {}
  
  public static short validOPHeader(OperationHeader paramOperationHeader, String paramString)
  {
    if (paramOperationHeader != null)
    {
      Object localObject1 = paramOperationHeader.getUpv();
      if (localObject1 != null)
      {
        localObject2 = minor;
        if ((localObject2 != null) && (localObject2 == getClientVersionminor)) {
          s2 = 0;
        } else {
          s2 = 6;
        }
        localObject1 = major;
        s1 = s2;
        if (s2 != 0) {
          break label83;
        }
        if ((localObject1 != null) && (localObject1 == getClientVersionmajor))
        {
          s1 = 0;
          break label83;
        }
      }
      short s1 = 6;
      label83:
      localObject1 = paramOperationHeader.getOp();
      short s2 = s1;
      if (s1 == 0) {
        if (StringTools.isValidateString((String)localObject1))
        {
          s2 = s1;
          if (!((String)localObject1).equals(Operation.SECOND_CLASS.name()))
          {
            s2 = s1;
            if (!((String)localObject1).equals(Operation.Auth.name()))
            {
              s2 = s1;
              if (((String)localObject1).equals(Operation.Dereg.name())) {}
            }
          }
        }
        else
        {
          s2 = 6;
        }
      }
      Object localObject2 = paramOperationHeader.getAppID();
      s1 = s2;
      int i;
      if (s2 == 0)
      {
        if (localObject2 != null)
        {
          i = ((String)localObject2).getBytes().length;
          if (i <= 512)
          {
            s1 = s2;
            if (i <= 0) {
              break label221;
            }
            if ((((String)localObject2).equalsIgnoreCase(paramString)) || (((String)localObject2).indexOf("http") == 0))
            {
              s1 = 0;
              break label221;
            }
          }
        }
        s1 = 6;
      }
      label221:
      paramOperationHeader = paramOperationHeader.getServerData();
      if ((s1 == 0) && (!((String)localObject1).equalsIgnoreCase(Operation.Dereg.name())))
      {
        if (StringTools.isValidateString(paramOperationHeader))
        {
          i = paramOperationHeader.getBytes().length;
          if ((i > 0) && (i <= 1536)) {
            return 0;
          }
        }
      }
      else {
        return s1;
      }
    }
    return 6;
  }
}
