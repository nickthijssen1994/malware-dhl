package org.org.union.fido.util.asn1;

import java.io.FilterOutputStream;
import java.io.IOException;
import java.io.OutputStream;

public class DEROutputStream
  extends FilterOutputStream
  implements DERTags
{
  public DEROutputStream(OutputStream paramOutputStream)
  {
    super(paramOutputStream);
  }
  
  private void writeLength(int paramInt)
  {
    if (paramInt > 127)
    {
      int j = paramInt;
      int i = 1;
      for (;;)
      {
        j >>>= 8;
        if (j == 0) {
          break;
        }
        i += 1;
      }
      write((byte)(i | 0x80));
      i = (i - 1) * 8;
      while (i >= 0)
      {
        write((byte)(paramInt >> i));
        i -= 8;
      }
      return;
    }
    write((byte)paramInt);
  }
  
  public void write(byte[] paramArrayOfByte)
  {
    out.write(paramArrayOfByte, 0, paramArrayOfByte.length);
  }
  
  public void write(byte[] paramArrayOfByte, int paramInt1, int paramInt2)
  {
    out.write(paramArrayOfByte, paramInt1, paramInt2);
  }
  
  void writeEncoded(int paramInt1, int paramInt2, byte[] paramArrayOfByte)
  {
    writeTag(paramInt1, paramInt2);
    writeLength(paramArrayOfByte.length);
    write(paramArrayOfByte);
  }
  
  void writeEncoded(int paramInt, byte[] paramArrayOfByte)
  {
    write(paramInt);
    writeLength(paramArrayOfByte.length);
    write(paramArrayOfByte);
  }
  
  protected void writeNull()
  {
    write(5);
    write(0);
  }
  
  public void writeObject(Object paramObject)
  {
    if (paramObject == null)
    {
      writeNull();
      return;
    }
    if ((paramObject instanceof DERObject)) {}
    for (paramObject = (DERObject)paramObject;; paramObject = ((DEREncodable)paramObject).getDERObject())
    {
      paramObject.encode(this);
      return;
      if (!(paramObject instanceof DEREncodable)) {
        break;
      }
    }
    throw new IOException("object not DEREncodable");
  }
  
  void writeTag(int paramInt1, int paramInt2)
  {
    if (paramInt2 < 31)
    {
      write(paramInt1 | paramInt2);
      return;
    }
    write(paramInt1 | 0x1F);
    if (paramInt2 < 128)
    {
      write(paramInt2);
      return;
    }
    byte[] arrayOfByte = new byte[5];
    int i = (byte)(paramInt2 & 0x7F);
    paramInt1 = 4;
    arrayOfByte[4] = i;
    int j;
    int k;
    do
    {
      j = paramInt2 >> 7;
      k = paramInt1 - 1;
      arrayOfByte[k] = ((byte)(j & 0x7F | 0x80));
      paramInt1 = k;
      paramInt2 = j;
    } while (j > 127);
    write(arrayOfByte, k, 5 - k);
  }
}
