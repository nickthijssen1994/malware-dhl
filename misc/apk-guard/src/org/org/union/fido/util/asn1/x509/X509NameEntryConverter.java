package org.org.union.fido.util.asn1.x509;

import org.org.union.fido.util.asn1.ASN1InputStream;
import org.org.union.fido.util.asn1.DERObject;
import org.org.union.fido.util.asn1.DERObjectIdentifier;
import org.org.union.fido.util.asn1.DERPrintableString;
import org.org.union.fido.util.asn1.util.Strings;

public abstract class X509NameEntryConverter
{
  public X509NameEntryConverter() {}
  
  protected boolean canBePrintable(String paramString)
  {
    return DERPrintableString.isPrintableString(paramString);
  }
  
  protected DERObject convertHexEncoded(String paramString, int paramInt)
  {
    paramString = Strings.toLowerCase(paramString);
    byte[] arrayOfByte = new byte[(paramString.length() - paramInt) / 2];
    int i = 0;
    while (i != arrayOfByte.length)
    {
      int j = i * 2 + paramInt;
      int k = paramString.charAt(j);
      j = paramString.charAt(j + 1);
      if (k < 97) {
        arrayOfByte[i] = ((byte)(k - 48 << 4));
      } else {
        arrayOfByte[i] = ((byte)(k - 97 + 10 << 4));
      }
      if (j < 97)
      {
        k = arrayOfByte[i];
        arrayOfByte[i] = ((byte)((byte)(j - 48) | k));
      }
      else
      {
        k = arrayOfByte[i];
        arrayOfByte[i] = ((byte)((byte)(j - 97 + 10) | k));
      }
      i += 1;
    }
    return new ASN1InputStream(arrayOfByte).readObject();
  }
  
  public abstract DERObject getConvertedValue(DERObjectIdentifier paramDERObjectIdentifier, String paramString);
}
