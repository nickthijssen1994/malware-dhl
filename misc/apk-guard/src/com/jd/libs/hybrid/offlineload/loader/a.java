package com.jd.libs.hybrid.offlineload.loader;

import android.content.Context;
import android.text.TextUtils;
import com.jd.hybrid.downloader.ClassWriter;
import com.jd.libs.hybrid.base.asm.Log;
import com.jd.libs.hybrid.offlineload.curve.CommonFileDatabase;
import com.jd.libs.hybrid.offlineload.entity.CommonEntity;
import com.jd.libs.hybrid.offlineload.entity.FileDetail;
import java.io.File;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Random;

public final class a
{
  final com.jd.libs.hybrid.offlineload.curve.a c;
  final Context d;
  
  public a(Context paramContext)
  {
    d = paramContext;
    c = CommonFileDatabase.all(paramContext).iterator();
  }
  
  private void doInBackground(List paramList, int paramInt)
  {
    ClassWriter localClassWriter = ClassWriter.put();
    if (localClassWriter == null) {
      return;
    }
    ArrayList localArrayList = new ArrayList(paramList.size());
    Iterator localIterator = paramList.iterator();
    while (localIterator.hasNext())
    {
      CommonEntity localCommonEntity = (CommonEntity)localIterator.next();
      String str1 = localCommonEntity.getUrl();
      paramList = new StringBuilder("????(");
      paramList.append(str1);
      paramList.append(")");
      String str2 = paramList.toString();
      paramList = localCommonEntity.getId();
      Object localObject = new StringBuilder("hybrid/.preload/.common");
      ((StringBuilder)localObject).append(File.separator);
      ((StringBuilder)localObject).append(".");
      ((StringBuilder)localObject).append(paramList);
      String str3 = ((StringBuilder)localObject).toString();
      if (!str1.endsWith("/"))
      {
        int i = str1.lastIndexOf("/");
        if (-1 != i)
        {
          paramList = str1.substring(i + 1);
          break label179;
        }
      }
      paramList = "";
      label179:
      localObject = paramList;
      if (TextUtils.isEmpty(paramList)) {
        localObject = com.jd.libs.hybrid.offlineload.asm.Label.read();
      }
      paramList = new StringBuilder();
      paramList.append(System.currentTimeMillis() + new Random().nextInt(1000));
      paramList.append("_");
      paramList.append((String)localObject);
      paramList = new com.jd.hybrid.downloader.Label(str2, str1, str3, paramList.toString(), true, Integer.MAX_VALUE);
      paramList.resolve(0);
      paramList.layout(new com.jd.hybrid.downloader.reflect.Label(localCommonEntity.getMd5()));
      paramList.resolve(new Item(this, localCommonEntity, paramInt));
      localArrayList.add(paramList);
    }
    localClassWriter.put(localArrayList, true);
  }
}
