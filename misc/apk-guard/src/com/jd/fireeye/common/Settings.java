package com.jd.fireeye.common;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import org.json.JSONException;
import org.json.JSONObject;

public class Settings
  extends BroadcastReceiver
{
  private static Settings sSettings;
  private JSONObject a = new JSONObject();
  private long c;
  private boolean s = false;
  
  public Settings() {}
  
  public static Settings getInstance()
  {
    if (sSettings == null) {
      try
      {
        if (sSettings == null) {
          sSettings = new Settings();
        }
      }
      catch (Throwable localThrowable)
      {
        throw localThrowable;
      }
    }
    return sSettings;
  }
  
  private String getSignature()
  {
    if (c == 0L) {
      return "";
    }
    return String.valueOf(System.currentTimeMillis() - c);
  }
  
  public final JSONObject get()
  {
    return a;
  }
  
  public final void init(Context paramContext)
  {
    if ((!s) && (paramContext != null)) {
      try
      {
        IntentFilter localIntentFilter = new IntentFilter();
        localIntentFilter.addAction("android.intent.action.BATTERY_CHANGED");
        localIntentFilter.addAction("android.intent.action.SCREEN_ON");
        localIntentFilter.addAction("android.intent.action.SCREEN_OFF");
        paramContext.registerReceiver(this, localIntentFilter);
        s = true;
        return;
      }
      catch (Exception paramContext)
      {
        paramContext.printStackTrace();
      }
    }
  }
  
  public void onReceive(Context paramContext, Intent paramIntent)
  {
    paramContext = paramIntent.getAction();
    if ("android.intent.action.SCREEN_ON".equals(paramContext)) {
      c = System.currentTimeMillis();
    }
    if ("android.intent.action.SCREEN_OFF".equals(paramContext)) {
      c = System.currentTimeMillis();
    }
    if ("android.intent.action.BATTERY_CHANGED".equals(paramContext))
    {
      int i = paramIntent.getIntExtra("level", 0);
      int j = paramIntent.getIntExtra("status", 0);
      int k = paramIntent.getIntExtra("plugged", 0);
      if (a == null) {
        a = new JSONObject();
      }
      paramContext = a;
      try
      {
        paramContext.put("remainingBatteryLevel", String.valueOf(i));
        paramContext = a;
        paramContext.put("batteryStatus", String.valueOf(j));
        paramContext = a;
        paramContext.put("plugged", String.valueOf(k));
        return;
      }
      catch (JSONException paramContext)
      {
        paramContext.printStackTrace();
      }
    }
  }
}
