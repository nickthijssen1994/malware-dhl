package com.jd.feedback;

import android.content.Context;
import android.content.Intent;
import android.content.res.Resources;
import android.graphics.Bitmap;
import android.graphics.Bitmap.Config;
import android.graphics.Canvas;
import android.graphics.Paint;
import android.graphics.Rect;
import android.graphics.drawable.BitmapDrawable;
import android.graphics.drawable.Drawable;
import android.net.Uri;
import android.os.Bundle;
import android.text.TextPaint;
import android.util.DisplayMetrics;
import android.view.Display;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.WindowManager;
import android.widget.ImageView;
import androidx.appcompat.app.AppCompatActivity;
import com.github.chrisbanes.photoview.PhotoView;
import com.jd.feedback.stream.Utils;

public class PhotoViewActivity
  extends AppCompatActivity
{
  private String data;
  private PhotoView row;
  
  public PhotoViewActivity() {}
  
  private Bitmap init(String paramString)
  {
    TextPaint localTextPaint = new TextPaint(1);
    localTextPaint.setTextSize(Utils.init((Context)this));
    localTextPaint.setColor(getResources().getColor(17170443));
    Rect localRect = new Rect();
    localTextPaint.getTextBounds(paramString, 0, paramString.length(), localRect);
    DisplayMetrics localDisplayMetrics = new DisplayMetrics();
    getWindowManager().getDefaultDisplay().getMetrics(localDisplayMetrics);
    Bitmap localBitmap = Bitmap.createBitmap(widthPixels, heightPixels, Bitmap.Config.ARGB_8888);
    Canvas localCanvas = new Canvas(localBitmap);
    localCanvas.drawText(paramString, (widthPixels - localRect.width()) / 2, heightPixels / 2 + localRect.height() / 2, localTextPaint);
    localCanvas.save();
    localCanvas.restore();
    return localBitmap;
  }
  
  protected void onCreate(Bundle paramBundle)
  {
    super.onCreate(paramBundle);
    setContentView(R.layout.activity_photo_view);
    data = getIntent().getStringExtra("show_image_url");
    findViewById(R.id.back).setOnClickListener(new View.OnClickListener()
    {
      public final void onClick(View paramAnonymousView)
      {
        finish();
      }
    });
    row = ((PhotoView)findViewById(R.id.image));
    row.setOnClickListener(new View.OnClickListener()
    {
      public final void onClick(View paramAnonymousView)
      {
        finish();
      }
    });
    Object localObject2 = init(getResources().getString(R.string.text_loading));
    Object localObject1 = init(getResources().getString(R.string.text_load_failed));
    if (data != null)
    {
      paramBundle = FeedbackSDK.getImageLoader();
      PhotoView localPhotoView = row;
      Uri localUri = Uri.parse(data);
      localObject2 = new BitmapDrawable((Bitmap)localObject2);
      localObject1 = new BitmapDrawable((Bitmap)localObject1);
      paramBundle.load((ImageView)localPhotoView, localUri, (Drawable)localObject2, (Drawable)localObject1, "fit_center");
    }
  }
}
