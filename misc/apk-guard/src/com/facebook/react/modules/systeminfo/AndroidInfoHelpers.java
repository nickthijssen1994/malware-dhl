package com.facebook.react.modules.systeminfo;

import android.os.Build;
import android.os.Build.VERSION;
import java.util.Locale;

public class AndroidInfoHelpers
{
  private static final int DEBUG_SERVER_HOST_PORT = 8081;
  public static final String DEVICE_LOCALHOST = "localhost";
  public static final String EMULATOR_LOCALHOST = "10.0.2.2";
  public static final String GENYMOTION_LOCALHOST = "10.0.3.2";
  private static final int INSPECTOR_PROXY_PORT = 8082;
  public static final String METRO_HOST_PROP_NAME = "metro.host";
  private static final String mLogTag = "AndroidInfoHelpers";
  private static String metroHostPropValue;
  
  public AndroidInfoHelpers() {}
  
  public static String getFriendlyDeviceName()
  {
    if (isRunningOnGenymotion()) {
      return Build.MODEL;
    }
    StringBuilder localStringBuilder = new StringBuilder();
    localStringBuilder.append(Build.MODEL);
    localStringBuilder.append(" - ");
    localStringBuilder.append(Build.VERSION.RELEASE);
    localStringBuilder.append(" - API ");
    localStringBuilder.append(Build.VERSION.SDK_INT);
    return localStringBuilder.toString();
  }
  
  public static String getInspectorProxyHost()
  {
    return getServerIpAddress(8082);
  }
  
  /* Error */
  private static String getMetroHostPropValue()
  {
    // Byte code:
    //   0: ldc 2
    //   2: monitorenter
    //   3: getstatic 80	com/facebook/react/modules/systeminfo/AndroidInfoHelpers:metroHostPropValue	Ljava/lang/String;
    //   6: ifnull +12 -> 18
    //   9: getstatic 80	com/facebook/react/modules/systeminfo/AndroidInfoHelpers:metroHostPropValue	Ljava/lang/String;
    //   12: astore_0
    //   13: ldc 2
    //   15: monitorexit
    //   16: aload_0
    //   17: areturn
    //   18: aconst_null
    //   19: astore_3
    //   20: aconst_null
    //   21: astore_1
    //   22: invokestatic 86	java/lang/Runtime:getRuntime	()Ljava/lang/Runtime;
    //   25: astore_0
    //   26: aload_0
    //   27: iconst_2
    //   28: anewarray 88	java/lang/String
    //   31: dup
    //   32: iconst_0
    //   33: ldc 90
    //   35: aastore
    //   36: dup
    //   37: iconst_1
    //   38: ldc 22
    //   40: aastore
    //   41: invokevirtual 94	java/lang/Runtime:exec	([Ljava/lang/String;)Ljava/lang/Process;
    //   44: astore_2
    //   45: new 96	java/io/BufferedReader
    //   48: dup
    //   49: new 98	java/io/InputStreamReader
    //   52: dup
    //   53: aload_2
    //   54: invokevirtual 104	java/lang/Process:getInputStream	()Ljava/io/InputStream;
    //   57: ldc 106
    //   59: invokestatic 112	java/nio/charset/Charset:forName	(Ljava/lang/String;)Ljava/nio/charset/Charset;
    //   62: invokespecial 115	java/io/InputStreamReader:<init>	(Ljava/io/InputStream;Ljava/nio/charset/Charset;)V
    //   65: invokespecial 118	java/io/BufferedReader:<init>	(Ljava/io/Reader;)V
    //   68: astore_0
    //   69: ldc 120
    //   71: astore_1
    //   72: aload_0
    //   73: invokevirtual 123	java/io/BufferedReader:readLine	()Ljava/lang/String;
    //   76: astore_3
    //   77: aload_3
    //   78: ifnull +8 -> 86
    //   81: aload_3
    //   82: astore_1
    //   83: goto -11 -> 72
    //   86: aload_1
    //   87: putstatic 80	com/facebook/react/modules/systeminfo/AndroidInfoHelpers:metroHostPropValue	Ljava/lang/String;
    //   90: aload_0
    //   91: invokevirtual 126	java/io/BufferedReader:close	()V
    //   94: aload_2
    //   95: ifnull +77 -> 172
    //   98: aload_2
    //   99: invokevirtual 129	java/lang/Process:destroy	()V
    //   102: goto +70 -> 172
    //   105: astore_3
    //   106: aload_0
    //   107: astore_1
    //   108: aload_3
    //   109: astore_0
    //   110: goto +72 -> 182
    //   113: astore_3
    //   114: aload_0
    //   115: astore_1
    //   116: aload_3
    //   117: astore_0
    //   118: goto +24 -> 142
    //   121: astore_0
    //   122: aload_3
    //   123: astore_1
    //   124: goto +58 -> 182
    //   127: astore_0
    //   128: goto +14 -> 142
    //   131: astore_0
    //   132: aconst_null
    //   133: astore_2
    //   134: aload_3
    //   135: astore_1
    //   136: goto +46 -> 182
    //   139: astore_0
    //   140: aconst_null
    //   141: astore_2
    //   142: getstatic 131	com/facebook/react/modules/systeminfo/AndroidInfoHelpers:mLogTag	Ljava/lang/String;
    //   145: ldc -123
    //   147: aload_0
    //   148: invokestatic 139	com/facebook/common/logging/FLog:w	(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
    //   151: ldc 120
    //   153: putstatic 80	com/facebook/react/modules/systeminfo/AndroidInfoHelpers:metroHostPropValue	Ljava/lang/String;
    //   156: aload_1
    //   157: ifnull +7 -> 164
    //   160: aload_1
    //   161: invokevirtual 126	java/io/BufferedReader:close	()V
    //   164: aload_2
    //   165: ifnull +7 -> 172
    //   168: aload_2
    //   169: invokevirtual 129	java/lang/Process:destroy	()V
    //   172: getstatic 80	com/facebook/react/modules/systeminfo/AndroidInfoHelpers:metroHostPropValue	Ljava/lang/String;
    //   175: astore_0
    //   176: ldc 2
    //   178: monitorexit
    //   179: aload_0
    //   180: areturn
    //   181: astore_0
    //   182: aload_1
    //   183: ifnull +7 -> 190
    //   186: aload_1
    //   187: invokevirtual 126	java/io/BufferedReader:close	()V
    //   190: aload_2
    //   191: ifnull +7 -> 198
    //   194: aload_2
    //   195: invokevirtual 129	java/lang/Process:destroy	()V
    //   198: aload_0
    //   199: athrow
    //   200: astore_0
    //   201: ldc 2
    //   203: monitorexit
    //   204: aload_0
    //   205: athrow
    //   206: astore_0
    //   207: goto -113 -> 94
    //   210: astore_0
    //   211: goto -47 -> 164
    //   214: astore_1
    //   215: goto -25 -> 190
    // Local variable table:
    //   start	length	slot	name	signature
    //   12	106	0	localObject1	Object
    //   121	1	0	localThrowable1	Throwable
    //   127	1	0	localException1	Exception
    //   131	1	0	localThrowable2	Throwable
    //   139	9	0	localException2	Exception
    //   175	5	0	str1	String
    //   181	18	0	localThrowable3	Throwable
    //   200	5	0	localThrowable4	Throwable
    //   206	1	0	localException3	Exception
    //   210	1	0	localException4	Exception
    //   21	166	1	localObject2	Object
    //   214	1	1	localException5	Exception
    //   44	151	2	localProcess	Process
    //   19	63	3	str2	String
    //   105	4	3	localThrowable5	Throwable
    //   113	22	3	localException6	Exception
    // Exception table:
    //   from	to	target	type
    //   72	77	105	java/lang/Throwable
    //   86	90	105	java/lang/Throwable
    //   72	77	113	java/lang/Exception
    //   45	69	121	java/lang/Throwable
    //   45	69	127	java/lang/Exception
    //   22	26	131	java/lang/Throwable
    //   26	45	131	java/lang/Throwable
    //   22	26	139	java/lang/Exception
    //   26	45	139	java/lang/Exception
    //   142	156	181	java/lang/Throwable
    //   3	13	200	java/lang/Throwable
    //   90	94	200	java/lang/Throwable
    //   98	102	200	java/lang/Throwable
    //   160	164	200	java/lang/Throwable
    //   168	172	200	java/lang/Throwable
    //   172	176	200	java/lang/Throwable
    //   186	190	200	java/lang/Throwable
    //   194	198	200	java/lang/Throwable
    //   198	200	200	java/lang/Throwable
    //   90	94	206	java/lang/Exception
    //   160	164	210	java/lang/Exception
    //   186	190	214	java/lang/Exception
  }
  
  public static String getServerHost()
  {
    return getServerIpAddress(8081);
  }
  
  private static String getServerIpAddress(int paramInt)
  {
    String str2 = getMetroHostPropValue();
    String str1 = str2;
    if (str2.equals("")) {
      if (isRunningOnGenymotion()) {
        str1 = "10.0.3.2";
      } else if (isRunningOnStockEmulator()) {
        str1 = "10.0.2.2";
      } else {
        str1 = "localhost";
      }
    }
    return String.format(Locale.US, "%s:%d", new Object[] { str1, Integer.valueOf(paramInt) });
  }
  
  private static boolean isRunningOnGenymotion()
  {
    return Build.FINGERPRINT.contains("vbox");
  }
  
  private static boolean isRunningOnStockEmulator()
  {
    return Build.FINGERPRINT.contains("generic");
  }
}
