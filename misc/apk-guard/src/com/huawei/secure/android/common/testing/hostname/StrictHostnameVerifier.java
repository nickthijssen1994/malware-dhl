package com.huawei.secure.android.common.testing.hostname;

import com.huawei.secure.android.common.testing.util.Log;
import java.security.Principal;
import java.security.cert.X509Certificate;
import javax.net.ssl.HostnameVerifier;
import javax.net.ssl.SSLException;
import javax.net.ssl.SSLSession;

public class StrictHostnameVerifier
  implements HostnameVerifier
{
  public StrictHostnameVerifier() {}
  
  public final boolean verify(String paramString, SSLSession paramSSLSession)
  {
    try
    {
      paramSSLSession = paramSSLSession.getPeerCertificates();
      paramSSLSession = (X509Certificate)paramSSLSession[0];
      StringBuilder localStringBuilder = new StringBuilder();
      localStringBuilder.append("verify: certificate is : ");
      localStringBuilder.append(paramSSLSession.getSubjectDN().getName());
      Log.d("", localStringBuilder.toString());
      AbstractVerifier.verify(paramString, paramSSLSession, true);
      return true;
    }
    catch (SSLException paramString)
    {
      paramSSLSession = new StringBuilder();
      paramSSLSession.append("SSLException : ");
      paramSSLSession.append(paramString.getMessage());
      Log.e("", paramSSLSession.toString());
    }
    return false;
  }
}
