package com.huawei.secure.android.common.encrypt.hash;

import android.text.TextUtils;
import com.huawei.secure.android.common.encrypt.utils.HexUtil;
import java.io.UnsupportedEncodingException;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;

public abstract class HMACSHA256
{
  private static final String HMAC_ALGORITHM = "HmacSHA256";
  private static final String RANGE_STARTS = "";
  private static final int TAG_AUDIO = 32;
  private static final String downloadToFile = "HMACSHA256";
  
  public HMACSHA256() {}
  
  public static String hmacSHA256Encrypt(String paramString1, String paramString2)
  {
    if ((!TextUtils.isEmpty(paramString1)) && (!TextUtils.isEmpty(paramString2))) {
      return hmacSHA256Encrypt(paramString1, HexUtil.hexStr2ByteArray(paramString2));
    }
    return "";
  }
  
  public static String hmacSHA256Encrypt(String paramString, byte[] paramArrayOfByte)
  {
    if ((!TextUtils.isEmpty(paramString)) && (paramArrayOfByte != null))
    {
      if (paramArrayOfByte.length < 32)
      {
        com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(downloadToFile, "hmac key length is not right");
        return "";
      }
      try
      {
        paramArrayOfByte = new SecretKeySpec(paramArrayOfByte, "HmacSHA256");
        localObject = Mac.getInstance(paramArrayOfByte.getAlgorithm());
        ((Mac)localObject).init(paramArrayOfByte);
        paramString = HexUtil.byteArray2HexStr(((Mac)localObject).doFinal(paramString.getBytes("UTF-8")));
        return paramString;
      }
      catch (NoSuchAlgorithmException paramString) {}catch (InvalidKeyException paramString) {}catch (UnsupportedEncodingException paramString) {}
      paramArrayOfByte = downloadToFile;
      Object localObject = new StringBuilder();
      ((StringBuilder)localObject).append("hmacsha256 encrypt exception");
      ((StringBuilder)localObject).append(((Exception)paramString).getMessage());
      com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(paramArrayOfByte, ((StringBuilder)localObject).toString());
      return "";
    }
    return "";
  }
}
