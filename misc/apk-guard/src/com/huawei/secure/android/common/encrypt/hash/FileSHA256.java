package com.huawei.secure.android.common.encrypt.hash;

import android.text.TextUtils;
import com.huawei.secure.android.common.encrypt.utils.HexUtil;
import com.huawei.secure.android.common.encrypt.utils.Label;
import com.huawei.secure.android.common.encrypt.utils.StringBuilder;
import java.io.File;
import java.io.IOException;
import java.io.InputStream;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;

public abstract class FileSHA256
{
  private static final int DEFLATER_BLOCK_SIZE = 8192;
  private static final String[] GITLINK = { "SHA-256", "SHA-384", "SHA-512" };
  private static final String NULL_LABEL = "";
  private static final String SHA256 = "SHA-256";
  private static final String downloadToFile = "FileSHA256";
  
  public FileSHA256() {}
  
  private static boolean a(File paramFile)
  {
    return (paramFile != null) && (paramFile.exists()) && (paramFile.length() > 0L);
  }
  
  private static boolean call(String paramString)
  {
    String[] arrayOfString = GITLINK;
    int j = arrayOfString.length;
    int i = 0;
    while (i < j)
    {
      if (arrayOfString[i].equals(paramString)) {
        return true;
      }
      i += 1;
    }
    return false;
  }
  
  public static String fileSHA256Encrypt(File paramFile)
  {
    return fileSHAEncrypt(paramFile, "SHA-256");
  }
  
  /* Error */
  public static String fileSHAEncrypt(File paramFile, String paramString)
  {
    // Byte code:
    //   0: aload_1
    //   1: invokestatic 69	android/text/TextUtils:isEmpty	(Ljava/lang/CharSequence;)Z
    //   4: ifne +275 -> 279
    //   7: aload_1
    //   8: invokestatic 71	com/huawei/secure/android/common/encrypt/hash/FileSHA256:call	(Ljava/lang/String;)Z
    //   11: ifne +6 -> 17
    //   14: goto +265 -> 279
    //   17: aload_0
    //   18: invokestatic 73	com/huawei/secure/android/common/encrypt/hash/FileSHA256:a	(Ljava/io/File;)Z
    //   21: ifne +14 -> 35
    //   24: getstatic 75	com/huawei/secure/android/common/encrypt/hash/FileSHA256:downloadToFile	Ljava/lang/String;
    //   27: ldc 77
    //   29: invokestatic 83	com/huawei/secure/android/common/encrypt/utils/StringBuilder:append	(Ljava/lang/String;Ljava/lang/String;)V
    //   32: ldc 13
    //   34: areturn
    //   35: aconst_null
    //   36: astore 5
    //   38: aload_1
    //   39: invokestatic 89	java/security/MessageDigest:getInstance	(Ljava/lang/String;)Ljava/security/MessageDigest;
    //   42: astore 6
    //   44: new 91	java/io/FileInputStream
    //   47: dup
    //   48: aload_0
    //   49: invokespecial 94	java/io/FileInputStream:<init>	(Ljava/io/File;)V
    //   52: astore_1
    //   53: aload_1
    //   54: astore_0
    //   55: sipush 8192
    //   58: newarray byte
    //   60: astore 4
    //   62: iconst_0
    //   63: istore_2
    //   64: aload_1
    //   65: astore_0
    //   66: aload_1
    //   67: aload 4
    //   69: invokevirtual 98	java/io/FileInputStream:read	([B)I
    //   72: istore_3
    //   73: iload_3
    //   74: ifle +19 -> 93
    //   77: aload_1
    //   78: astore_0
    //   79: aload 6
    //   81: aload 4
    //   83: iconst_0
    //   84: iload_3
    //   85: invokevirtual 102	java/security/MessageDigest:update	([BII)V
    //   88: iconst_1
    //   89: istore_2
    //   90: goto -26 -> 64
    //   93: aload 5
    //   95: astore 4
    //   97: aload_1
    //   98: astore_0
    //   99: iload_2
    //   100: ifeq +17 -> 117
    //   103: aload_1
    //   104: astore_0
    //   105: aload 6
    //   107: invokevirtual 106	java/security/MessageDigest:digest	()[B
    //   110: invokestatic 112	com/huawei/secure/android/common/encrypt/utils/HexUtil:byteArray2HexStr	([B)Ljava/lang/String;
    //   113: astore 4
    //   115: aload_1
    //   116: astore_0
    //   117: aload_0
    //   118: invokestatic 117	com/huawei/secure/android/common/encrypt/utils/Label:a	(Ljava/io/InputStream;)V
    //   121: aload 4
    //   123: areturn
    //   124: astore 4
    //   126: goto +18 -> 144
    //   129: astore 4
    //   131: goto +79 -> 210
    //   134: astore_1
    //   135: aconst_null
    //   136: astore_0
    //   137: goto +136 -> 273
    //   140: astore 4
    //   142: aconst_null
    //   143: astore_1
    //   144: aload_1
    //   145: astore_0
    //   146: getstatic 75	com/huawei/secure/android/common/encrypt/hash/FileSHA256:downloadToFile	Ljava/lang/String;
    //   149: astore 6
    //   151: aload_1
    //   152: astore_0
    //   153: new 119	java/lang/StringBuilder
    //   156: dup
    //   157: invokespecial 120	java/lang/StringBuilder:<init>	()V
    //   160: astore 7
    //   162: aload_1
    //   163: astore_0
    //   164: aload 7
    //   166: ldc 122
    //   168: invokevirtual 125	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   171: pop
    //   172: aload_1
    //   173: astore_0
    //   174: aload 7
    //   176: aload 4
    //   178: invokevirtual 129	java/io/IOException:getMessage	()Ljava/lang/String;
    //   181: invokevirtual 125	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   184: pop
    //   185: aload_1
    //   186: astore_0
    //   187: aload 6
    //   189: aload 7
    //   191: invokevirtual 132	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   194: invokestatic 83	com/huawei/secure/android/common/encrypt/utils/StringBuilder:append	(Ljava/lang/String;Ljava/lang/String;)V
    //   197: aload 5
    //   199: astore 4
    //   201: aload_1
    //   202: astore_0
    //   203: goto -86 -> 117
    //   206: astore 4
    //   208: aconst_null
    //   209: astore_1
    //   210: aload_1
    //   211: astore_0
    //   212: getstatic 75	com/huawei/secure/android/common/encrypt/hash/FileSHA256:downloadToFile	Ljava/lang/String;
    //   215: astore 6
    //   217: aload_1
    //   218: astore_0
    //   219: new 119	java/lang/StringBuilder
    //   222: dup
    //   223: invokespecial 120	java/lang/StringBuilder:<init>	()V
    //   226: astore 7
    //   228: aload_1
    //   229: astore_0
    //   230: aload 7
    //   232: ldc -122
    //   234: invokevirtual 125	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   237: pop
    //   238: aload_1
    //   239: astore_0
    //   240: aload 7
    //   242: aload 4
    //   244: invokevirtual 135	java/security/NoSuchAlgorithmException:getMessage	()Ljava/lang/String;
    //   247: invokevirtual 125	java/lang/StringBuilder:append	(Ljava/lang/String;)Ljava/lang/StringBuilder;
    //   250: pop
    //   251: aload_1
    //   252: astore_0
    //   253: aload 6
    //   255: aload 7
    //   257: invokevirtual 132	java/lang/StringBuilder:toString	()Ljava/lang/String;
    //   260: invokestatic 83	com/huawei/secure/android/common/encrypt/utils/StringBuilder:append	(Ljava/lang/String;Ljava/lang/String;)V
    //   263: aload 5
    //   265: astore 4
    //   267: aload_1
    //   268: astore_0
    //   269: goto -152 -> 117
    //   272: astore_1
    //   273: aload_0
    //   274: invokestatic 117	com/huawei/secure/android/common/encrypt/utils/Label:a	(Ljava/io/InputStream;)V
    //   277: aload_1
    //   278: athrow
    //   279: getstatic 75	com/huawei/secure/android/common/encrypt/hash/FileSHA256:downloadToFile	Ljava/lang/String;
    //   282: ldc -119
    //   284: invokestatic 83	com/huawei/secure/android/common/encrypt/utils/StringBuilder:append	(Ljava/lang/String;Ljava/lang/String;)V
    //   287: ldc 13
    //   289: areturn
    // Local variable table:
    //   start	length	slot	name	signature
    //   0	290	0	paramFile	File
    //   0	290	1	paramString	String
    //   63	37	2	i	int
    //   72	13	3	j	int
    //   60	62	4	localObject1	Object
    //   124	1	4	localIOException1	IOException
    //   129	1	4	localNoSuchAlgorithmException1	NoSuchAlgorithmException
    //   140	37	4	localIOException2	IOException
    //   199	1	4	localObject2	Object
    //   206	37	4	localNoSuchAlgorithmException2	NoSuchAlgorithmException
    //   265	1	4	localObject3	Object
    //   36	228	5	localObject4	Object
    //   42	212	6	localObject5	Object
    //   160	96	7	localStringBuilder	StringBuilder
    // Exception table:
    //   from	to	target	type
    //   66	73	124	java/io/IOException
    //   79	88	124	java/io/IOException
    //   105	115	124	java/io/IOException
    //   66	73	129	java/security/NoSuchAlgorithmException
    //   79	88	129	java/security/NoSuchAlgorithmException
    //   105	115	129	java/security/NoSuchAlgorithmException
    //   38	44	134	java/lang/Throwable
    //   44	53	134	java/lang/Throwable
    //   38	44	140	java/io/IOException
    //   44	53	140	java/io/IOException
    //   38	44	206	java/security/NoSuchAlgorithmException
    //   44	53	206	java/security/NoSuchAlgorithmException
    //   55	62	272	java/lang/Throwable
    //   66	73	272	java/lang/Throwable
    //   79	88	272	java/lang/Throwable
    //   105	115	272	java/lang/Throwable
    //   146	151	272	java/lang/Throwable
    //   153	162	272	java/lang/Throwable
    //   164	172	272	java/lang/Throwable
    //   174	185	272	java/lang/Throwable
    //   187	197	272	java/lang/Throwable
    //   212	217	272	java/lang/Throwable
    //   219	228	272	java/lang/Throwable
    //   230	238	272	java/lang/Throwable
    //   240	251	272	java/lang/Throwable
    //   253	263	272	java/lang/Throwable
  }
  
  public static String inputStreamSHA256Encrypt(InputStream paramInputStream)
  {
    if (paramInputStream == null) {
      return "";
    }
    return inputStreamSHAEncrypt(paramInputStream, "SHA-256");
  }
  
  public static String inputStreamSHAEncrypt(InputStream paramInputStream, String paramString)
  {
    if (paramInputStream == null) {
      return "";
    }
    byte[] arrayOfByte = new byte['?'];
    try
    {
      paramString = MessageDigest.getInstance(paramString);
      for (;;)
      {
        int i = paramInputStream.read(arrayOfByte);
        if (i < 0) {
          break;
        }
        if (i > 0) {
          paramString.update(arrayOfByte, 0, i);
        }
      }
      paramString = HexUtil.byteArray2HexStr(paramString.digest());
      Label.a(paramInputStream);
      return paramString;
    }
    catch (Throwable paramString)
    {
      break label75;
      StringBuilder.append(downloadToFile, "inputstraem exception");
      Label.a(paramInputStream);
      return "";
      Label.a(paramInputStream);
      throw paramString;
    }
    catch (IOException paramString)
    {
      for (;;) {}
    }
    catch (NoSuchAlgorithmException paramString)
    {
      label75:
      for (;;) {}
    }
  }
  
  public static boolean validateFileSHA(File paramFile, String paramString1, String paramString2)
  {
    if ((!TextUtils.isEmpty(paramString1)) && (call(paramString2))) {
      return paramString1.equals(fileSHAEncrypt(paramFile, paramString2));
    }
    StringBuilder.append(downloadToFile, "hash value is null || algorithm is illegal");
    return false;
  }
  
  public static boolean validateFileSHA256(File paramFile, String paramString)
  {
    if (TextUtils.isEmpty(paramString)) {
      return false;
    }
    return paramString.equals(fileSHA256Encrypt(paramFile));
  }
  
  public static boolean validateInputStreamSHA(InputStream paramInputStream, String paramString1, String paramString2)
  {
    if ((!TextUtils.isEmpty(paramString1)) && (call(paramString2))) {
      return paramString1.equals(inputStreamSHAEncrypt(paramInputStream, paramString2));
    }
    StringBuilder.append(downloadToFile, "hash value is null || algorithm is illegal");
    return false;
  }
  
  public static boolean validateInputStreamSHA256(InputStream paramInputStream, String paramString)
  {
    if (TextUtils.isEmpty(paramString)) {
      return false;
    }
    return paramString.equals(inputStreamSHA256Encrypt(paramInputStream));
  }
}
