package com.huawei.secure.android.common.encrypt.utils;

import android.os.Build.VERSION;

public class RootKeyUtil
{
  private static final String LOG_TAG = "RootKeyUtil";
  private byte[] d = null;
  
  private RootKeyUtil() {}
  
  private void computeKey(String paramString1, String paramString2, String paramString3, String paramString4)
  {
    init(paramString1, paramString2, paramString3, HexUtil.hexStr2ByteArray(paramString4));
  }
  
  private void init(String paramString1, String paramString2, String paramString3, byte[] paramArrayOfByte)
  {
    if (Build.VERSION.SDK_INT < 26)
    {
      StringBuilder.i(LOG_TAG, "initRootKey: sha1");
      d = BaseKeyUtil.exportRootKey(paramString1, paramString2, paramString3, paramArrayOfByte, false);
      return;
    }
    StringBuilder.i(LOG_TAG, "initRootKey: sha256");
    d = BaseKeyUtil.exportRootKey(paramString1, paramString2, paramString3, paramArrayOfByte, true);
  }
  
  public static RootKeyUtil newInstance(String paramString1, String paramString2, String paramString3, String paramString4)
  {
    RootKeyUtil localRootKeyUtil = new RootKeyUtil();
    localRootKeyUtil.computeKey(paramString1, paramString2, paramString3, paramString4);
    return localRootKeyUtil;
  }
  
  public static RootKeyUtil newInstance(String paramString1, String paramString2, String paramString3, byte[] paramArrayOfByte)
  {
    RootKeyUtil localRootKeyUtil = new RootKeyUtil();
    localRootKeyUtil.init(paramString1, paramString2, paramString3, paramArrayOfByte);
    return localRootKeyUtil;
  }
  
  public byte[] getRootKey()
  {
    return (byte[])d.clone();
  }
  
  public String getRootKeyHex()
  {
    return HexUtil.byteArray2HexStr(d);
  }
}
