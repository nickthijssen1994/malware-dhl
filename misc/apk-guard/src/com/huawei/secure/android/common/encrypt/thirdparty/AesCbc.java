package com.huawei.secure.android.common.encrypt.thirdparty;

import android.text.TextUtils;
import com.huawei.secure.android.common.encrypt.utils.EncryptUtil;
import com.huawei.secure.android.common.encrypt.utils.HexUtil;
import java.io.UnsupportedEncodingException;
import java.security.InvalidAlgorithmParameterException;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.util.Arrays;
import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;

public final class AesCbc
{
  private static final String CIPHER = "AES";
  private static final int CONTEXT_MENU_DELETE_ID = 16;
  private static final String NULL_LABEL = "";
  private static final String PAGE_KEY = "security:";
  private static final int TRANSACTION_stat = 16;
  private static final String TRANSFORMATION = "AES/CBC/PKCS5Padding";
  private static final String params = "AesCbc";
  
  private AesCbc() {}
  
  static String buildUrl(String paramString)
  {
    if (TextUtils.isEmpty(paramString)) {
      return "";
    }
    if (paramString.indexOf("security:") == -1) {
      return "";
    }
    return paramString.substring(9);
  }
  
  private static String decode(String paramString)
  {
    if (TextUtils.isEmpty(paramString)) {
      return "";
    }
    try
    {
      localObject = new StringBuilder();
      ((StringBuilder)localObject).append(paramString.substring(6, 12));
      ((StringBuilder)localObject).append(paramString.substring(16, 26));
      ((StringBuilder)localObject).append(paramString.substring(32, 48));
      paramString = ((StringBuilder)localObject).toString();
      return paramString;
    }
    catch (Exception paramString)
    {
      Object localObject = params;
      StringBuilder localStringBuilder = new StringBuilder();
      localStringBuilder.append("getIv exception : ");
      localStringBuilder.append(paramString.getMessage());
      com.huawei.secure.android.common.encrypt.utils.StringBuilder.append((String)localObject, localStringBuilder.toString());
    }
    return "";
  }
  
  private static byte[] decodeBase64(byte[] paramArrayOfByte)
  {
    byte[] arrayOfByte = new byte[16];
    System.arraycopy(paramArrayOfByte, 0, arrayOfByte, 0, 16);
    return arrayOfByte;
  }
  
  public static String decrypt(String paramString1, String paramString2)
  {
    if ((!TextUtils.isEmpty(paramString1)) && (!TextUtils.isEmpty(paramString2)))
    {
      paramString2 = HexUtil.hexStr2ByteArray(paramString2);
      if (paramString2.length < 16)
      {
        com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, "key length is not right");
        return "";
      }
      return decrypt(paramString1, paramString2);
    }
    com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, "content or key is null");
    return "";
  }
  
  public static String decrypt(String paramString1, String paramString2, String paramString3)
  {
    if ((!TextUtils.isEmpty(paramString1)) && (!TextUtils.isEmpty(paramString2)) && (!TextUtils.isEmpty(paramString3)))
    {
      paramString2 = HexUtil.hexStr2ByteArray(paramString2);
      paramString3 = HexUtil.hexStr2ByteArray(paramString3);
      if ((paramString2.length >= 16) && (paramString3.length >= 16)) {
        return decrypt(paramString1, paramString2, paramString3);
      }
      com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, "key length or ivParameter is not right");
      return "";
    }
    com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, "cbc decrypt param is not right");
    return "";
  }
  
  public static String decrypt(String paramString, byte[] paramArrayOfByte)
  {
    if ((!TextUtils.isEmpty(paramString)) && (paramArrayOfByte != null) && (paramArrayOfByte.length >= 16))
    {
      String str = decode(paramString);
      paramString = get(paramString);
      if ((!TextUtils.isEmpty(str)) && (!TextUtils.isEmpty(paramString))) {
        return decrypt(paramString, paramArrayOfByte, HexUtil.hexStr2ByteArray(str));
      }
      com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, "ivParameter or encrypedWord is null");
      return "";
    }
    return "";
  }
  
  public static String decrypt(String paramString, byte[] paramArrayOfByte1, byte[] paramArrayOfByte2)
  {
    if ((!TextUtils.isEmpty(paramString)) && (paramArrayOfByte1 != null) && (paramArrayOfByte1.length >= 16) && (paramArrayOfByte2 != null) && (paramArrayOfByte2.length >= 16)) {
      try
      {
        paramString = decrypt(HexUtil.hexStr2ByteArray(paramString), paramArrayOfByte1, paramArrayOfByte2);
        paramString = new String(paramString, "UTF-8");
        return paramString;
      }
      catch (UnsupportedEncodingException paramString)
      {
        paramArrayOfByte1 = params;
        paramArrayOfByte2 = new StringBuilder();
        paramArrayOfByte2.append(" cbc decrypt data error");
        paramArrayOfByte2.append(paramString.getMessage());
        com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(paramArrayOfByte1, paramArrayOfByte2.toString());
        return "";
      }
    }
    com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, "cbc decrypt param is not right");
    return "";
  }
  
  private static byte[] decrypt(byte[] paramArrayOfByte)
  {
    byte[] arrayOfByte = new byte[paramArrayOfByte.length - 16];
    System.arraycopy(paramArrayOfByte, 16, arrayOfByte, 0, paramArrayOfByte.length - 16);
    return arrayOfByte;
  }
  
  public static byte[] decrypt(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2)
  {
    byte[] arrayOfByte = decodeBase64(paramArrayOfByte1);
    return decrypt(decrypt(paramArrayOfByte1), paramArrayOfByte2, arrayOfByte);
  }
  
  public static byte[] decrypt(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2, byte[] paramArrayOfByte3)
  {
    if ((paramArrayOfByte1 != null) && (paramArrayOfByte1.length != 0) && (paramArrayOfByte2 != null) && (paramArrayOfByte2.length >= 16) && (paramArrayOfByte3 != null) && (paramArrayOfByte3.length >= 16))
    {
      paramArrayOfByte2 = new SecretKeySpec(paramArrayOfByte2, "AES");
      try
      {
        Cipher localCipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
        localCipher.init(2, paramArrayOfByte2, new IvParameterSpec(paramArrayOfByte3));
        paramArrayOfByte1 = localCipher.doFinal(paramArrayOfByte1);
        return paramArrayOfByte1;
      }
      catch (BadPaddingException paramArrayOfByte1)
      {
        paramArrayOfByte2 = params;
        paramArrayOfByte3 = new StringBuilder();
        paramArrayOfByte3.append("BadPaddingException: ");
        paramArrayOfByte3.append(paramArrayOfByte1.getMessage());
        com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(paramArrayOfByte2, paramArrayOfByte3.toString());
      }
      catch (IllegalBlockSizeException paramArrayOfByte1)
      {
        paramArrayOfByte2 = params;
        paramArrayOfByte3 = new StringBuilder();
        paramArrayOfByte3.append("IllegalBlockSizeException: ");
        paramArrayOfByte3.append(paramArrayOfByte1.getMessage());
        com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(paramArrayOfByte2, paramArrayOfByte3.toString());
      }
      catch (InvalidAlgorithmParameterException paramArrayOfByte1)
      {
        paramArrayOfByte2 = params;
        paramArrayOfByte3 = new StringBuilder();
        paramArrayOfByte3.append("InvalidAlgorithmParameterException: ");
        paramArrayOfByte3.append(paramArrayOfByte1.getMessage());
        com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(paramArrayOfByte2, paramArrayOfByte3.toString());
      }
      catch (InvalidKeyException paramArrayOfByte1)
      {
        paramArrayOfByte2 = params;
        paramArrayOfByte3 = new StringBuilder();
        paramArrayOfByte3.append("InvalidKeyException: ");
        paramArrayOfByte3.append(paramArrayOfByte1.getMessage());
        com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(paramArrayOfByte2, paramArrayOfByte3.toString());
      }
      catch (NoSuchPaddingException paramArrayOfByte1)
      {
        paramArrayOfByte2 = params;
        paramArrayOfByte3 = new StringBuilder();
        paramArrayOfByte3.append("NoSuchPaddingException: ");
        paramArrayOfByte3.append(paramArrayOfByte1.getMessage());
        com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(paramArrayOfByte2, paramArrayOfByte3.toString());
      }
      catch (NoSuchAlgorithmException paramArrayOfByte1)
      {
        paramArrayOfByte2 = params;
        paramArrayOfByte3 = new StringBuilder();
        paramArrayOfByte3.append("NoSuchAlgorithmException: ");
        paramArrayOfByte3.append(paramArrayOfByte1.getMessage());
        com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(paramArrayOfByte2, paramArrayOfByte3.toString());
      }
      return new byte[0];
    }
    com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, "cbc decrypt param is not right");
    return new byte[0];
  }
  
  public static String decryptWithCryptHead(String paramString, byte[] paramArrayOfByte)
  {
    if ((!TextUtils.isEmpty(paramString)) && (paramArrayOfByte != null) && (paramArrayOfByte.length >= 16))
    {
      paramString = buildUrl(paramString);
      if ("".equals(paramString)) {
        return "";
      }
      int i = paramString.indexOf(':');
      if (i >= 0)
      {
        byte[] arrayOfByte = HexUtil.hexStr2ByteArray(paramString.substring(0, i));
        return decrypt(HexUtil.byteArray2HexStr(HexUtil.hexStr2ByteArray(paramString.substring(i + 1))), paramArrayOfByte, arrayOfByte);
      }
      com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, " cbc cipherText data missing colon");
      return "";
    }
    return "";
  }
  
  public static String decryptWithCryptHead(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2)
  {
    try
    {
      paramArrayOfByte1 = new String(decryptWithCryptHeadReturnByte(paramArrayOfByte1, paramArrayOfByte2), "UTF-8");
      return paramArrayOfByte1;
    }
    catch (UnsupportedEncodingException paramArrayOfByte1)
    {
      for (;;) {}
    }
    com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, "decryptWithCryptHead UnsupportedEncodingException ");
    return "";
  }
  
  public static byte[] decryptWithCryptHeadReturnByte(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2)
  {
    if ((paramArrayOfByte1 != null) && (paramArrayOfByte2 != null) && (paramArrayOfByte2.length >= 16))
    {
      paramArrayOfByte1 = get(paramArrayOfByte1);
      if (paramArrayOfByte1.length == 0) {
        return new byte[0];
      }
      int i = getToken(paramArrayOfByte1);
      if (i >= 0)
      {
        byte[] arrayOfByte1 = Arrays.copyOf(paramArrayOfByte1, i);
        int j = paramArrayOfByte1.length - arrayOfByte1.length - 1;
        byte[] arrayOfByte2 = new byte[j];
        System.arraycopy(paramArrayOfByte1, i + 1, arrayOfByte2, 0, j);
        return decrypt(arrayOfByte2, paramArrayOfByte2, arrayOfByte1);
      }
      com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, " cbc cipherText data missing colon");
      return new byte[0];
    }
    return new byte[0];
  }
  
  private static String encode(String paramString1, String paramString2)
  {
    if ((!TextUtils.isEmpty(paramString1)) && (!TextUtils.isEmpty(paramString2))) {
      try
      {
        localStringBuilder = new StringBuilder();
        localStringBuilder.append(paramString2.substring(0, 6));
        localStringBuilder.append(paramString1.substring(0, 6));
        localStringBuilder.append(paramString2.substring(6, 10));
        localStringBuilder.append(paramString1.substring(6, 16));
        localStringBuilder.append(paramString2.substring(10, 16));
        localStringBuilder.append(paramString1.substring(16));
        localStringBuilder.append(paramString2.substring(16));
        paramString1 = localStringBuilder.toString();
        return paramString1;
      }
      catch (Exception paramString1)
      {
        paramString2 = params;
        StringBuilder localStringBuilder = new StringBuilder();
        localStringBuilder.append("mix exception: ");
        localStringBuilder.append(paramString1.getMessage());
        com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(paramString2, localStringBuilder.toString());
        return "";
      }
    }
    return "";
  }
  
  public static String encrypt(String paramString1, String paramString2)
  {
    if ((!TextUtils.isEmpty(paramString1)) && (!TextUtils.isEmpty(paramString2)))
    {
      paramString2 = HexUtil.hexStr2ByteArray(paramString2);
      if (paramString2.length < 16)
      {
        com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, "key length is not right");
        return "";
      }
      return encrypt(paramString1, paramString2);
    }
    com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, "cbc encrypt param is not right");
    return "";
  }
  
  public static String encrypt(String paramString1, String paramString2, String paramString3)
  {
    if ((!TextUtils.isEmpty(paramString1)) && (!TextUtils.isEmpty(paramString2)) && (!TextUtils.isEmpty(paramString3)))
    {
      paramString2 = HexUtil.hexStr2ByteArray(paramString2);
      paramString3 = HexUtil.hexStr2ByteArray(paramString3);
      if ((paramString2.length >= 16) && (paramString3.length >= 16)) {
        return encrypt(paramString1, paramString2, paramString3);
      }
      com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, "key length or ivParameter length is not right");
      return "";
    }
    com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, "cbc encrypt param is not right");
    return "";
  }
  
  public static String encrypt(String paramString, byte[] paramArrayOfByte)
  {
    if ((!TextUtils.isEmpty(paramString)) && (paramArrayOfByte != null) && (paramArrayOfByte.length >= 16))
    {
      byte[] arrayOfByte = EncryptUtil.generateSecureRandom(16);
      paramString = getEncoded(paramString, paramArrayOfByte, arrayOfByte);
      if ((paramString != null) && (paramString.length != 0)) {
        return encode(HexUtil.byteArray2HexStr(arrayOfByte), HexUtil.byteArray2HexStr(paramString));
      }
      return "";
    }
    com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, "cbc encrypt param is not right");
    return "";
  }
  
  public static String encrypt(String paramString, byte[] paramArrayOfByte1, byte[] paramArrayOfByte2)
  {
    if ((!TextUtils.isEmpty(paramString)) && (paramArrayOfByte1 != null) && (paramArrayOfByte1.length >= 16) && (paramArrayOfByte2 != null) && (paramArrayOfByte2.length >= 16)) {
      return HexUtil.byteArray2HexStr(getEncoded(paramString, paramArrayOfByte1, paramArrayOfByte2));
    }
    com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, "cbc encrypt param is not right");
    return "";
  }
  
  public static byte[] encrypt(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2)
  {
    byte[] arrayOfByte = EncryptUtil.generateSecureRandom(16);
    return toBase64(arrayOfByte, encrypt(paramArrayOfByte1, paramArrayOfByte2, arrayOfByte));
  }
  
  public static byte[] encrypt(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2, byte[] paramArrayOfByte3)
  {
    if ((paramArrayOfByte1 != null) && (paramArrayOfByte1.length != 0) && (paramArrayOfByte2 != null) && (paramArrayOfByte2.length >= 16) && (paramArrayOfByte3 != null) && (paramArrayOfByte3.length >= 16))
    {
      paramArrayOfByte2 = new SecretKeySpec(paramArrayOfByte2, "AES");
      try
      {
        Cipher localCipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
        localCipher.init(1, paramArrayOfByte2, new IvParameterSpec(paramArrayOfByte3));
        paramArrayOfByte1 = localCipher.doFinal(paramArrayOfByte1);
        return paramArrayOfByte1;
      }
      catch (BadPaddingException paramArrayOfByte1)
      {
        paramArrayOfByte2 = params;
        paramArrayOfByte3 = new StringBuilder();
        paramArrayOfByte3.append("BadPaddingException: ");
        paramArrayOfByte3.append(paramArrayOfByte1.getMessage());
        com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(paramArrayOfByte2, paramArrayOfByte3.toString());
      }
      catch (IllegalBlockSizeException paramArrayOfByte1)
      {
        paramArrayOfByte2 = params;
        paramArrayOfByte3 = new StringBuilder();
        paramArrayOfByte3.append("IllegalBlockSizeException: ");
        paramArrayOfByte3.append(paramArrayOfByte1.getMessage());
        com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(paramArrayOfByte2, paramArrayOfByte3.toString());
      }
      catch (InvalidAlgorithmParameterException paramArrayOfByte1)
      {
        paramArrayOfByte2 = params;
        paramArrayOfByte3 = new StringBuilder();
        paramArrayOfByte3.append("InvalidAlgorithmParameterException: ");
        paramArrayOfByte3.append(paramArrayOfByte1.getMessage());
        com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(paramArrayOfByte2, paramArrayOfByte3.toString());
      }
      catch (InvalidKeyException paramArrayOfByte1)
      {
        paramArrayOfByte2 = params;
        paramArrayOfByte3 = new StringBuilder();
        paramArrayOfByte3.append("InvalidKeyException: ");
        paramArrayOfByte3.append(paramArrayOfByte1.getMessage());
        com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(paramArrayOfByte2, paramArrayOfByte3.toString());
      }
      catch (NoSuchPaddingException paramArrayOfByte1)
      {
        paramArrayOfByte2 = params;
        paramArrayOfByte3 = new StringBuilder();
        paramArrayOfByte3.append("NoSuchPaddingException: ");
        paramArrayOfByte3.append(paramArrayOfByte1.getMessage());
        com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(paramArrayOfByte2, paramArrayOfByte3.toString());
      }
      catch (NoSuchAlgorithmException paramArrayOfByte1)
      {
        paramArrayOfByte2 = params;
        paramArrayOfByte3 = new StringBuilder();
        paramArrayOfByte3.append("NoSuchAlgorithmException: ");
        paramArrayOfByte3.append(paramArrayOfByte1.getMessage());
        com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(paramArrayOfByte2, paramArrayOfByte3.toString());
      }
      return new byte[0];
    }
    com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, "cbc encrypt param is not right");
    return new byte[0];
  }
  
  private static String get(String paramString)
  {
    if (TextUtils.isEmpty(paramString)) {
      return "";
    }
    try
    {
      localObject = new StringBuilder();
      ((StringBuilder)localObject).append(paramString.substring(0, 6));
      ((StringBuilder)localObject).append(paramString.substring(12, 16));
      ((StringBuilder)localObject).append(paramString.substring(26, 32));
      ((StringBuilder)localObject).append(paramString.substring(48));
      paramString = ((StringBuilder)localObject).toString();
      return paramString;
    }
    catch (Exception paramString)
    {
      Object localObject = params;
      StringBuilder localStringBuilder = new StringBuilder();
      localStringBuilder.append("get encryptword exception : ");
      localStringBuilder.append(paramString.getMessage());
      com.huawei.secure.android.common.encrypt.utils.StringBuilder.append((String)localObject, localStringBuilder.toString());
    }
    return "";
  }
  
  static byte[] get(byte[] paramArrayOfByte)
  {
    Object localObject = "";
    try
    {
      String str1 = new String(paramArrayOfByte, "UTF-8");
      localObject = str1;
    }
    catch (UnsupportedEncodingException localUnsupportedEncodingException)
    {
      String str2 = params;
      StringBuilder localStringBuilder = new StringBuilder();
      localStringBuilder.append("stripCryptHead: exception : ");
      localStringBuilder.append(localUnsupportedEncodingException.getMessage());
      com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(str2, localStringBuilder.toString());
    }
    if (!((String)localObject).startsWith("security:")) {
      return new byte[0];
    }
    if (paramArrayOfByte.length > 9)
    {
      localObject = new byte[paramArrayOfByte.length - 9];
      System.arraycopy(paramArrayOfByte, 9, localObject, 0, localObject.length);
      return localObject;
    }
    return new byte[0];
  }
  
  private static byte[] getEncoded(String paramString, byte[] paramArrayOfByte1, byte[] paramArrayOfByte2)
  {
    if (TextUtils.isEmpty(paramString))
    {
      com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(params, "cbc encrypt param is not right");
      return new byte[0];
    }
    try
    {
      paramString = encrypt(paramString.getBytes("UTF-8"), paramArrayOfByte1, paramArrayOfByte2);
      return paramString;
    }
    catch (UnsupportedEncodingException paramString)
    {
      paramArrayOfByte1 = params;
      paramArrayOfByte2 = new StringBuilder();
      paramArrayOfByte2.append(" cbc encrypt data error");
      paramArrayOfByte2.append(paramString.getMessage());
      com.huawei.secure.android.common.encrypt.utils.StringBuilder.append(paramArrayOfByte1, paramArrayOfByte2.toString());
    }
    return new byte[0];
  }
  
  private static int getToken(byte[] paramArrayOfByte)
  {
    if (paramArrayOfByte[16] == 58) {
      return 16;
    }
    return -1;
  }
  
  private static byte[] toBase64(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2)
  {
    byte[] arrayOfByte = new byte[paramArrayOfByte1.length + paramArrayOfByte2.length];
    System.arraycopy(paramArrayOfByte1, 0, arrayOfByte, 0, paramArrayOfByte1.length);
    System.arraycopy(paramArrayOfByte2, 0, arrayOfByte, paramArrayOfByte1.length, paramArrayOfByte2.length);
    return arrayOfByte;
  }
}
