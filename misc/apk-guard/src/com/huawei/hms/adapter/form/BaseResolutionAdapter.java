package com.huawei.hms.adapter.form;

import android.app.Activity;
import android.app.PendingIntent;
import android.content.ActivityNotFoundException;
import android.content.Intent;
import android.content.IntentSender.SendIntentException;
import android.os.Bundle;
import android.view.KeyEvent;
import com.huawei.hms.activity.IBridgeActivityDelegate;
import com.huawei.hms.adapter.sysobs.SystemManager;
import com.huawei.hms.support.model.HMSLog;
import java.lang.ref.WeakReference;

public class BaseResolutionAdapter
  implements IBridgeActivityDelegate
{
  public String l = "";
  public WeakReference<Activity> w;
  
  public BaseResolutionAdapter() {}
  
  public final Activity getActivity()
  {
    WeakReference localWeakReference = w;
    if (localWeakReference == null) {
      return null;
    }
    return (Activity)localWeakReference.get();
  }
  
  public int getRequestCode()
  {
    return 1001;
  }
  
  public void onBridgeActivityCreate(Activity paramActivity)
  {
    w = new WeakReference(paramActivity);
    Object localObject = paramActivity.getIntent();
    if (localObject == null)
    {
      updateAddress();
      return;
    }
    Bundle localBundle = ((Intent)localObject).getExtras();
    l = ((Intent)localObject).getStringExtra("transaction_id");
    if (localBundle == null)
    {
      updateAddress();
      return;
    }
    localObject = localBundle.getParcelable("resolution");
    if (localObject == null)
    {
      updateAddress();
      return;
    }
    if ((localObject instanceof Intent)) {
      localObject = (Intent)localObject;
    }
    try
    {
      paramActivity.startActivityForResult((Intent)localObject, 1001);
      return;
    }
    catch (ActivityNotFoundException paramActivity)
    {
      for (;;) {}
    }
    updateAddress();
    HMSLog.toString("BaseResolutionAdapter", "ActivityNotFoundException:exception");
    return;
    if ((localObject instanceof PendingIntent))
    {
      localObject = (PendingIntent)localObject;
      try
      {
        paramActivity.startIntentSenderForResult(((PendingIntent)localObject).getIntentSender(), 1001, null, 0, 0, 0);
        return;
      }
      catch (IntentSender.SendIntentException paramActivity)
      {
        for (;;) {}
      }
      updateAddress();
      HMSLog.toString("BaseResolutionAdapter", "SendIntentException:exception");
      return;
    }
  }
  
  public void onBridgeActivityDestroy()
  {
    HMSLog.append("BaseResolutionAdapter", "onBridgeActivityDestroy");
    w = null;
  }
  
  public boolean onBridgeActivityResult(int paramInt1, int paramInt2, Intent paramIntent)
  {
    if (paramInt1 != getRequestCode()) {
      return false;
    }
    HMSLog.append("BaseResolutionAdapter", "onBridgeActivityResult");
    if ((paramInt2 != -1) && (!paramIntent.hasExtra("kit_update_result"))) {
      SystemManager.getInstance().notifyResolutionResult(null, l);
    } else {
      SystemManager.getInstance().notifyResolutionResult(paramIntent, l);
    }
    updateListView();
    return true;
  }
  
  public void onBridgeConfigurationChanged()
  {
    HMSLog.append("BaseResolutionAdapter", "onBridgeConfigurationChanged");
  }
  
  public void onKeyUp(int paramInt, KeyEvent paramKeyEvent)
  {
    HMSLog.append("BaseResolutionAdapter", "On key up when resolve conn error");
  }
  
  public final void updateAddress()
  {
    SystemManager.getInstance().notifyResolutionResult(null, l);
    updateListView();
  }
  
  public final void updateListView()
  {
    Activity localActivity = getActivity();
    if (localActivity != null)
    {
      if (localActivity.isFinishing()) {
        return;
      }
      localActivity.finish();
    }
  }
}
