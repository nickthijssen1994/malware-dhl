package com.huawei.hms.activity;

import android.app.Activity;
import android.content.Context;
import android.content.ContextWrapper;
import android.content.Intent;
import android.content.res.Configuration;
import android.os.Bundle;
import android.view.KeyEvent;
import android.view.View;
import android.view.Window;
import com.huawei.hms.labs.SafeIntent;
import com.huawei.hms.support.model.HMSLog;
import com.huawei.hms.utils.ResourceLoaderUtil;
import com.huawei.hms.utils.UIUtil;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

public class BridgeActivity
  extends Activity
{
  public static final String EXTRA_DELEGATE_CLASS_NAME = "intent.extra.DELEGATE_CLASS_OBJECT";
  public static final String EXTRA_DELEGATE_UPDATE_INFO = "intent.extra.update.info";
  public static final String EXTRA_INTENT = "intent.extra.intent";
  public static final String EXTRA_IS_FULLSCREEN = "intent.extra.isfullscreen";
  public static final String EXTRA_RESULT = "intent.extra.RESULT";
  public static final int year = get("ro.build.hw_emui_api_level", 0);
  public IBridgeActivityDelegate appView;
  
  public BridgeActivity() {}
  
  public static void create(Window paramWindow, boolean paramBoolean)
  {
    try
    {
      localObject = paramWindow.getClass();
      Class localClass = Boolean.TYPE;
      localObject = ((Class)localObject).getMethod("setHwFloating", new Class[] { localClass });
      ((Method)localObject).invoke(paramWindow, new Object[] { Boolean.valueOf(paramBoolean) });
      return;
    }
    catch (InvocationTargetException paramWindow) {}catch (IllegalArgumentException paramWindow) {}catch (IllegalAccessException paramWindow) {}catch (NoSuchMethodException paramWindow) {}
    Object localObject = new StringBuilder();
    ((StringBuilder)localObject).append("In setHwFloating, Failed to call Window.setHwFloating().");
    ((StringBuilder)localObject).append(((Exception)paramWindow).getMessage());
    HMSLog.toString("BridgeActivity", ((StringBuilder)localObject).toString());
  }
  
  public static int get(String paramString, int paramInt)
  {
    try
    {
      localClass = Class.forName("android.os.SystemProperties");
      localObject = Integer.TYPE;
    }
    catch (ClassNotFoundException paramString)
    {
      Class localClass;
      Object localObject;
      int i;
      for (;;) {}
    }
    catch (NoSuchMethodException paramString)
    {
      for (;;) {}
    }
    catch (IllegalAccessException paramString)
    {
      for (;;) {}
    }
    catch (IllegalArgumentException paramString)
    {
      for (;;) {}
    }
    catch (InvocationTargetException paramString)
    {
      for (;;) {}
    }
    catch (ClassCastException paramString)
    {
      label67:
      for (;;) {}
    }
    try
    {
      localObject = localClass.getDeclaredMethod("getInt", new Class[] { String.class, localObject });
      paramString = ((Method)localObject).invoke(localClass, new Object[] { paramString, Integer.valueOf(paramInt) });
      paramString = (Integer)paramString;
      i = paramString.intValue();
      return i;
    }
    catch (ClassNotFoundException paramString)
    {
      break label67;
    }
    catch (NoSuchMethodException paramString)
    {
      break label67;
    }
    catch (IllegalAccessException paramString)
    {
      break label67;
    }
    catch (IllegalArgumentException paramString)
    {
      break label67;
    }
    catch (InvocationTargetException paramString)
    {
      break label67;
    }
    catch (ClassCastException paramString)
    {
      break label67;
    }
    HMSLog.toString("BridgeActivity", "An exception occurred while reading: EMUI_SDK_INT");
    return paramInt;
  }
  
  public static Intent getIntentStartBridgeActivity(Activity paramActivity, String paramString)
  {
    Intent localIntent = new Intent(paramActivity, BridgeActivity.class);
    localIntent.putExtra("intent.extra.DELEGATE_CLASS_OBJECT", paramString);
    localIntent.putExtra("intent.extra.isfullscreen", UIUtil.isActivityFullscreen(paramActivity));
    return localIntent;
  }
  
  public static Intent getIntentStartBridgeActivity(Context paramContext, String paramString)
  {
    paramContext = new Intent(paramContext, BridgeActivity.class);
    paramContext.putExtra("intent.extra.DELEGATE_CLASS_OBJECT", paramString);
    paramContext.putExtra("intent.extra.isfullscreen", false);
    return paramContext;
  }
  
  public void finish()
  {
    HMSLog.append("BridgeActivity", "Enter finish.");
    super.finish();
  }
  
  public Intent getIntent()
  {
    Intent localIntent = super.getIntent();
    if (localIntent != null) {
      return new SafeIntent(localIntent);
    }
    return localIntent;
  }
  
  public final boolean init()
  {
    Object localObject = getIntent();
    if (localObject == null)
    {
      HMSLog.toString("BridgeActivity", "In initialize, Must not pass in a null intent.");
      return false;
    }
    if (((Intent)localObject).getBooleanExtra("intent.extra.isfullscreen", false)) {
      getWindow().setFlags(1024, 1024);
    }
    localObject = ((Intent)localObject).getStringExtra("intent.extra.DELEGATE_CLASS_OBJECT");
    if (localObject == null)
    {
      HMSLog.toString("BridgeActivity", "In initialize, Must not pass in a null or non class object.");
      return false;
    }
    StringBuilder localStringBuilder;
    try
    {
      localObject = Class.forName((String)localObject).asSubclass(IBridgeActivityDelegate.class).newInstance();
      localObject = (IBridgeActivityDelegate)localObject;
      appView = ((IBridgeActivityDelegate)localObject);
      try
      {
        appView.onBridgeActivityCreate(this);
        return true;
      }
      catch (RuntimeException localRuntimeException)
      {
        localStringBuilder = new StringBuilder();
        localStringBuilder.append("Run time Exception.");
        localStringBuilder.append(localRuntimeException.getMessage());
        HMSLog.toString("BridgeActivity", localStringBuilder.toString());
        return false;
      }
      localStringBuilder = new StringBuilder();
    }
    catch (ClassNotFoundException localClassNotFoundException) {}catch (IllegalAccessException localIllegalAccessException) {}catch (InstantiationException localInstantiationException) {}catch (ClassCastException localClassCastException) {}
    localStringBuilder.append("In initialize, Failed to create 'IUpdateWizard' instance.");
    localStringBuilder.append(((Exception)localClassCastException).getMessage());
    HMSLog.toString("BridgeActivity", localStringBuilder.toString());
    return false;
  }
  
  public void onActivityResult(int paramInt1, int paramInt2, Intent paramIntent)
  {
    paramIntent = new SafeIntent(paramIntent);
    super.onActivityResult(paramInt1, paramInt2, paramIntent);
    IBridgeActivityDelegate localIBridgeActivityDelegate = appView;
    if ((localIBridgeActivityDelegate != null) && (!localIBridgeActivityDelegate.onBridgeActivityResult(paramInt1, paramInt2, paramIntent)) && (!isFinishing()))
    {
      setResult(paramInt2, paramIntent);
      finish();
    }
  }
  
  public void onConfigurationChanged(Configuration paramConfiguration)
  {
    super.onConfigurationChanged(paramConfiguration);
    paramConfiguration = appView;
    if (paramConfiguration != null) {
      paramConfiguration.onBridgeConfigurationChanged();
    }
  }
  
  public void onCreate(Bundle paramBundle)
  {
    super.onCreate(paramBundle);
    if (getIntent() == null) {
      return;
    }
    show();
    if (ResourceLoaderUtil.getmContext() == null) {
      ResourceLoaderUtil.setmContext(getApplicationContext());
    }
    if (!init())
    {
      setResult(1, null);
      finish();
    }
  }
  
  public void onDestroy()
  {
    super.onDestroy();
    IBridgeActivityDelegate localIBridgeActivityDelegate = appView;
    if (localIBridgeActivityDelegate != null) {
      localIBridgeActivityDelegate.onBridgeActivityDestroy();
    }
  }
  
  public boolean onKeyUp(int paramInt, KeyEvent paramKeyEvent)
  {
    IBridgeActivityDelegate localIBridgeActivityDelegate = appView;
    if (localIBridgeActivityDelegate != null) {
      localIBridgeActivityDelegate.onKeyUp(paramInt, paramKeyEvent);
    }
    return super.onKeyUp(paramInt, paramKeyEvent);
  }
  
  public final void show()
  {
    requestWindowFeature(1);
    Window localWindow = getWindow();
    if (year >= 9)
    {
      localWindow.addFlags(67108864);
      create(localWindow, true);
    }
    localWindow.getDecorView().setSystemUiVisibility(0);
  }
}
