package com.p051jd.mrd.flutter.plugins.imagepicker;

import android.os.Environment;
import android.os.Handler;
import android.text.TextUtils;
import io.flutter.plugin.common.MethodCall;
import io.flutter.plugin.common.MethodChannel;
import java.io.File;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

/* compiled from: TbsSdkJava */
/* renamed from: com.jd.mrd.flutter.plugins.imagepicker.a */
/* loaded from: classes.dex */
public class C1982a {

    /* renamed from: a */
    private static ExecutorService f3436a = Executors.newSingleThreadExecutor();

    /* renamed from: b */
    private Handler f3437b = new Handler();

    /* renamed from: c */
    private boolean f3438c;

    /* compiled from: TbsSdkJava */
    /* renamed from: com.jd.mrd.flutter.plugins.imagepicker.a$a */
    /* loaded from: classes.dex */
    public interface AbstractC1990a {
        /* renamed from: a */
        void mo1001a(String str);

        /* renamed from: a */
        void mo1000a(ArrayList<String> arrayList);
    }

    /* renamed from: a */
    public void m1017a(MethodCall methodCall, final MethodChannel.Result result) {
        ArrayList arrayList = (ArrayList) methodCall.argument("imageList");
        if (arrayList != null && !arrayList.isEmpty()) {
            final int size = arrayList.size();
            final String b = m1014b();
            final ArrayList arrayList2 = new ArrayList();
            Iterator it = arrayList.iterator();
            while (it.hasNext()) {
                final String str = (String) it.next();
                f3436a.submit(new Runnable() { // from class: com.jd.mrd.flutter.plugins.imagepicker.a.1
                    @Override // java.lang.Runnable
                    public void run() {
                        if (!C1982a.this.m1019a()) {
                            try {
                                final String a = C1995d.m994a(str, b, 0, 0);
                                C1982a.this.f3437b.post(new Runnable() { // from class: com.jd.mrd.flutter.plugins.imagepicker.a.1.1
                                    @Override // java.lang.Runnable
                                    public void run() {
                                        arrayList2.add(a);
                                        if (arrayList2.size() == size) {
                                            C1982a.this.m1015a(true);
                                            result.success(arrayList2);
                                        }
                                    }
                                });
                            } catch (Exception e) {
                                C1982a.this.m1015a(true);
                                C1982a.this.f3437b.post(new Runnable() { // from class: com.jd.mrd.flutter.plugins.imagepicker.a.1.2
                                    @Override // java.lang.Runnable
                                    public void run() {
                                        result.error(e.getMessage(), (String) null, (Object) null);
                                    }
                                });
                            }
                        }
                    }
                });
            }
        }
    }

    /* renamed from: b */
    public String m1014b() {
        File file = new File(Environment.getExternalStorageDirectory(), "JDCompress/");
        if (!file.exists()) {
            file.mkdirs();
        }
        return file.getAbsolutePath();
    }

    /* renamed from: a */
    public void m1016a(final ArrayList<String> arrayList, final AbstractC1990a aVar) {
        if (arrayList == null || arrayList.size() == 0) {
            aVar.mo1001a("无可压缩的图片");
        } else {
            f3436a.submit(new Runnable() { // from class: com.jd.mrd.flutter.plugins.imagepicker.a.2
                @Override // java.lang.Runnable
                public void run() {
                    final ArrayList arrayList2 = new ArrayList();
                    try {
                        Iterator it = arrayList.iterator();
                        while (it.hasNext()) {
                            String str = (String) it.next();
                            if (C1994c.m999a() != null) {
                                if (!C1994c.m999a().isFinishing()) {
                                    String a = C1995d.m994a(str, C1982a.this.m1014b(), 0, 0);
                                    if (TextUtils.isEmpty(a)) {
                                        C1982a.this.f3437b.post(new Runnable() { // from class: com.jd.mrd.flutter.plugins.imagepicker.a.2.1
                                            @Override // java.lang.Runnable
                                            public void run() {
                                                aVar.mo1001a("压缩图片出错请重试");
                                            }
                                        });
                                        return;
                                    }
                                    arrayList2.add(a);
                                } else {
                                    return;
                                }
                            }
                        }
                        C1982a.this.f3437b.post(new Runnable() { // from class: com.jd.mrd.flutter.plugins.imagepicker.a.2.2
                            @Override // java.lang.Runnable
                            public void run() {
                                aVar.mo1000a(arrayList2);
                            }
                        });
                    } catch (Exception e) {
                        e.printStackTrace();
                        C1982a.this.f3437b.post(new Runnable() { // from class: com.jd.mrd.flutter.plugins.imagepicker.a.2.3
                            @Override // java.lang.Runnable
                            public void run() {
                                aVar.mo1001a("压缩图片出错请重试");
                            }
                        });
                    }
                }
            });
        }
    }

    /* renamed from: a */
    public synchronized boolean m1019a() {
        return this.f3438c;
    }

    /* renamed from: a */
    public synchronized void m1015a(boolean z) {
        this.f3438c = z;
    }
}
