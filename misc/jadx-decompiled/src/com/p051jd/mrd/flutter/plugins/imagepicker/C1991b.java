package com.p051jd.mrd.flutter.plugins.imagepicker;

import android.content.Intent;
import android.util.Log;
import com.jingdong.common.widget.image.UnImageLoader;
import com.p051jd.lib.unification.album.activity.PhotoAlbumActivity;
import com.p051jd.lib.unification.album.entity.AlbumConstant;
import com.p051jd.lib.unification.album.entity.AlbumParam;
import com.p051jd.lib.unification.album.entity.LocalMedia;
import com.p051jd.lib.unification.album.entity.VideoConstant;
import com.p051jd.lib.unification.album.entity.VideoParam;
import com.p051jd.lib.unification.video.recorder.VideoRecorderActivity;
import com.p051jd.mrd.flutter.plugins.imagepicker.C1982a;
import io.flutter.plugin.common.MethodCall;
import io.flutter.plugin.common.MethodChannel;
import io.flutter.plugin.common.PluginRegistry;
import java.io.File;
import java.util.ArrayList;
import java.util.List;

/* compiled from: TbsSdkJava */
/* renamed from: com.jd.mrd.flutter.plugins.imagepicker.b */
/* loaded from: classes.dex */
public class C1991b implements PluginRegistry.ActivityResultListener {

    /* renamed from: a */
    final String f3456a;

    /* renamed from: b */
    private MethodChannel.Result f3457b;

    /* renamed from: c */
    private MethodCall f3458c;

    public C1991b(File file) {
        this(file, null, null);
    }

    C1991b(File file, MethodChannel.Result result, MethodCall methodCall) {
        if (C1994c.m999a() != null) {
            this.f3456a = C1994c.m999a().getPackageName() + ".flutter.image_provider";
        } else {
            this.f3456a = "";
        }
        this.f3457b = result;
        this.f3458c = methodCall;
    }

    /* renamed from: a */
    public void m1009a(MethodCall methodCall, MethodChannel.Result result) {
        if (!m1002c(methodCall, result)) {
            m1012a();
        } else if (C1994c.m999a() != null) {
            UnImageLoader.getUnImageLoader().init(1);
            AlbumParam albumParam = new AlbumParam();
            albumParam.cameraOrVideoAction = 0;
            albumParam.loadCameraOrVideo = 1;
            albumParam.canSelectMediaCount = ((Integer) methodCall.argument("maxPickSize")).intValue();
            albumParam.videoEditorAction = 0;
            Intent intent = new Intent(C1994c.m999a(), PhotoAlbumActivity.class);
            intent.putExtra(AlbumConstant.ALBUM_PARAM, albumParam);
            C1994c.m999a().startActivityForResult(intent, 2342);
        }
    }

    /* renamed from: b */
    public void m1004b(MethodCall methodCall, MethodChannel.Result result) {
        if (!m1002c(methodCall, result)) {
            m1012a();
        } else if (C1994c.m999a() != null) {
            Intent intent = new Intent(C1994c.m999a(), VideoRecorderActivity.class);
            VideoParam videoParam = new VideoParam();
            videoParam.recordFunctionControl = 2;
            videoParam.needEditorPic = false;
            videoParam.editorFunctionControl = 0;
            intent.putExtra(VideoConstant.VIDEO_PARAM, videoParam);
            C1994c.m999a().startActivityForResult(intent, 2343);
        }
    }

    public boolean onActivityResult(int i, int i2, Intent intent) {
        switch (i) {
            case 2342:
                m1011a(i2, intent);
                return true;
            case 2343:
                m1005b(i2, intent);
                return true;
            default:
                return false;
        }
    }

    /* renamed from: a */
    private void m1011a(int i, Intent intent) {
        if (i != -1 || intent == null) {
            m1003b(null);
            return;
        }
        ArrayList<LocalMedia> parcelableArrayListExtra = intent.getParcelableArrayListExtra(AlbumConstant.SELECT_MEDIAS);
        ArrayList<String> arrayList = new ArrayList<>();
        for (LocalMedia localMedia : parcelableArrayListExtra) {
            arrayList.add(localMedia.getPath());
        }
        new C1982a().m1016a(arrayList, new C1982a.AbstractC1990a() { // from class: com.jd.mrd.flutter.plugins.imagepicker.b.1
            @Override // com.p051jd.mrd.flutter.plugins.imagepicker.C1982a.AbstractC1990a
            /* renamed from: a */
            public void mo1000a(ArrayList<String> arrayList2) {
                C1991b.this.m1007a(arrayList2);
            }

            @Override // com.p051jd.mrd.flutter.plugins.imagepicker.C1982a.AbstractC1990a
            /* renamed from: a */
            public void mo1001a(String str) {
                Log.e("ImagePickerDelegate", str + "");
                C1991b.this.m1007a(null);
            }
        });
    }

    /* renamed from: b */
    private void m1005b(int i, Intent intent) {
        if (i == -1) {
            String stringExtra = intent.getStringExtra("photoPath");
            ArrayList<String> arrayList = new ArrayList<>();
            arrayList.add(stringExtra);
            new C1982a().m1016a(arrayList, new C1982a.AbstractC1990a() { // from class: com.jd.mrd.flutter.plugins.imagepicker.b.2
                @Override // com.p051jd.mrd.flutter.plugins.imagepicker.C1982a.AbstractC1990a
                /* renamed from: a */
                public void mo1000a(ArrayList<String> arrayList2) {
                    C1991b.this.m1007a(arrayList2);
                }

                @Override // com.p051jd.mrd.flutter.plugins.imagepicker.C1982a.AbstractC1990a
                /* renamed from: a */
                public void mo1001a(String str) {
                    Log.e("ImagePickerDelegate", str + "");
                    C1991b.this.m1007a(null);
                }
            });
            return;
        }
        m1003b(null);
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* renamed from: a */
    public void m1007a(List<String> list) {
        if (this.f3457b != null) {
            m1003b(list);
            return;
        }
        throw new IllegalStateException("Received image from picker that was not requested");
    }

    /* renamed from: c */
    private boolean m1002c(MethodCall methodCall, MethodChannel.Result result) {
        if (this.f3457b != null) {
            return false;
        }
        this.f3458c = methodCall;
        this.f3457b = result;
        return true;
    }

    /* renamed from: b */
    private void m1003b(List<String> list) {
        this.f3457b.success(list);
        m1006b();
    }

    /* renamed from: a */
    private void m1012a() {
        m1008a("already_active", "Image picker is already active");
    }

    /* renamed from: a */
    private void m1008a(String str, String str2) {
        this.f3457b.error(str, str2, (Object) null);
        m1006b();
    }

    /* renamed from: b */
    private void m1006b() {
        this.f3458c = null;
        this.f3457b = null;
    }
}
