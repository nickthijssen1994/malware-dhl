package com.p051jd.libs.hybrid.performance;

import android.app.Activity;
import android.app.Application;
import android.text.TextUtils;
import com.huawei.hms.push.constant.RemoteMessageConst;
import com.p051jd.framework.json.JDJSONObject;
import com.p051jd.libs.hybrid.performance.p099b.C1916a;
import com.tencent.smtt.export.external.interfaces.SslError;
import com.tencent.smtt.sdk.WebView;

/* renamed from: com.jd.libs.hybrid.performance.WebPerfMonitor */
/* loaded from: classes.dex */
public class WebPerfMonitor {

    /* renamed from: a */
    private static AbstractC1911a f3303a;

    /* renamed from: b */
    private static Application f3304b;

    /* renamed from: c */
    private static String f3305c;

    /* renamed from: d */
    private static String f3306d;

    /* renamed from: e */
    private static boolean f3307e;

    /* renamed from: com.jd.libs.hybrid.performance.WebPerfMonitor$a */
    /* loaded from: classes.dex */
    public interface AbstractC1911a {
        /* renamed from: a */
        String m1175a();

        /* renamed from: b */
        String m1174b();

        /* renamed from: c */
        String m1173c();

        /* renamed from: d */
        String m1172d();

        /* renamed from: e */
        String m1171e();
    }

    private WebPerfMonitor() {
    }

    public static Application getApplication() {
        return f3304b;
    }

    public static AbstractC1911a getPerfSettings() {
        return f3303a;
    }

    public static void init(Application application, AbstractC1911a aVar) {
        f3304b = application;
        f3303a = aVar;
        C1918d.m1117a();
    }

    public static void initEnd(Activity activity) {
        f3306d = String.valueOf(System.currentTimeMillis());
    }

    public static void initStart(Activity activity) {
        f3305c = String.valueOf(System.currentTimeMillis());
    }

    public static void onLoadUrl(WebView webView, String str) {
        if (f3304b != null && f3307e && webView != null && !TextUtils.isEmpty(str)) {
            webView.addJavascriptInterface(new C1916a(webView), "JDPerformance");
            C1917c cVar = new C1917c(webView);
            cVar.m1125b("initStart", f3305c);
            cVar.m1125b("initFinish", f3306d);
            webView.setTag(cVar);
        }
    }

    public static void onMatchOffline(WebView webView) {
        if (f3304b != null && f3307e && webView != null && (webView.getTag() instanceof C1917c)) {
            ((C1917c) webView.getTag()).m1125b("businessType", "1");
        }
    }

    public static void onOfflineBingo(WebView webView) {
        if (f3304b != null && f3307e && webView != null && (webView.getTag() instanceof C1917c)) {
            ((C1917c) webView.getTag()).m1125b("businessBingo", "1");
        }
    }

    public static void onPageCommitVisible(WebView webView, String str) {
        if (f3304b != null && f3307e && webView != null) {
            webView.getTag();
        }
    }

    public static void onPageFinish(WebView webView, String str) {
        if (f3304b != null && f3307e && webView != null && (webView.getTag() instanceof C1917c)) {
            long currentTimeMillis = System.currentTimeMillis();
            C1917c cVar = (C1917c) webView.getTag();
            cVar.m1118e(null);
            C1915b b = cVar.m1126b(str);
            if (b != null) {
                b.m1153a(cVar.m1131a(str) ? "combinedPageFinish" : "pageFinish", String.valueOf(currentTimeMillis));
                b.m1141d(null);
            }
            if (webView.getProgress() >= 100) {
                if (b == null) {
                    b = cVar.m1122c(str);
                }
                if (b != null) {
                    b.m1141d(null);
                    b.m1153a("pageFinish100", String.valueOf(currentTimeMillis));
                }
                webView.loadUrl(String.format("javascript:window.%s&&%s.sendResource(JSON.stringify(window.performance.timing));", "JDPerformance", "JDPerformance"));
            }
            if (b != null) {
                b.m1157a(currentTimeMillis);
                cVar.m1132a(b, false);
            }
        }
    }

    public static void onPageStart(WebView webView, String str) {
        if (f3304b != null && f3307e && webView != null && (webView.getTag() instanceof C1917c)) {
            C1917c cVar = (C1917c) webView.getTag();
            cVar.m1118e("load");
            C1915b c = cVar.m1123c();
            if (c == null || c.m1144c("pageStart") || c.m1139f()) {
                c = cVar.m1135a();
            }
            cVar.m1125b(cVar.m1131a(str) ? "combinedPageStart" : "pageStart", String.valueOf(System.currentTimeMillis()));
            cVar.m1125b("url", str);
            if (c != null) {
                c.m1141d("load");
            }
        }
    }

    public static void onPreloadStatusChange(WebView webView, String str) {
        if (f3304b != null && f3307e && webView != null && (webView.getTag() instanceof C1917c)) {
            ((C1917c) webView.getTag()).m1125b("preloadStatus", str);
        }
    }

    public static void onReceivedError(WebView webView, int i, String str, String str2) {
        if (f3304b != null && f3307e && webView != null && (webView.getTag() instanceof C1917c)) {
            C1917c cVar = (C1917c) webView.getTag();
            cVar.m1118e(null);
            C1915b c = cVar.m1123c();
            if (c != null) {
                c.m1141d(null);
            }
            cVar.m1129a(true);
            cVar.m1120d(str2);
            cVar.m1125b("errorCode", String.valueOf(i));
            cVar.m1125b("errorMsg", str);
        }
    }

    public static void onReceivedHttpError(WebView webView, String str, int i, String str2) {
        if (f3304b != null && f3307e && webView != null && (webView.getTag() instanceof C1917c)) {
            C1917c cVar = (C1917c) webView.getTag();
            cVar.m1124b(true);
            JDJSONObject jDJSONObject = new JDJSONObject();
            jDJSONObject.put("url", (Object) str);
            jDJSONObject.put("errorCode", (Object) String.valueOf(i));
            jDJSONObject.put(RemoteMessageConst.MessageBody.MSG, (Object) str2);
            cVar.m1134a(jDJSONObject);
        }
    }

    public static void onResume(WebView webView) {
        if (f3304b != null && f3307e && webView != null) {
            webView.getTag();
        }
    }

    public static void onSSLErr(WebView webView, String str, SslError sslError) {
        if (f3304b != null && f3307e && webView != null && (webView.getTag() instanceof C1917c)) {
            C1917c cVar = (C1917c) webView.getTag();
            cVar.m1124b(true);
            cVar.m1120d(webView.getUrl());
            JDJSONObject jDJSONObject = new JDJSONObject();
            try {
                jDJSONObject.put("url", (Object) str);
                jDJSONObject.put("errorCode", (Object) String.valueOf(sslError.getPrimaryError()));
                jDJSONObject.put(RemoteMessageConst.MessageBody.MSG, (Object) String.format("SSL primaryError: %s;\nSslCertificate:  %s;\nIssued to: %s;\nIssued by: %s;\nValidNotBeforeDate: %s;\nValidNotAfterDate: %s;", Integer.valueOf(sslError.getPrimaryError()), sslError.getCertificate().toString(), sslError.getCertificate().getIssuedTo().getDName(), sslError.getCertificate().getIssuedBy().getDName(), sslError.getCertificate().getValidNotBeforeDate(), sslError.getCertificate().getValidNotAfterDate()));
            } catch (Exception unused) {
            }
            cVar.m1127b(jDJSONObject);
        }
    }

    public static void onStop(WebView webView) {
        if (f3304b != null && f3307e && webView != null && (webView.getTag() instanceof C1917c)) {
            ((C1917c) webView.getTag()).m1128b();
        }
    }

    public static void setApplication(Application application) {
        f3304b = application;
    }
}
