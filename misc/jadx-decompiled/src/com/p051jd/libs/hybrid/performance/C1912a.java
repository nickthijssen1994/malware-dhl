package com.p051jd.libs.hybrid.performance;

import android.text.TextUtils;
import android.util.Log;
import com.jingdong.sdk.oklog.OKLog;
import com.p051jd.framework.json.JDJSON;
import com.p051jd.framework.json.JDJSONObject;
import com.p051jd.lib.unification.album.mInterface.IBack;
import com.p051jd.libs.hybrid.performance.p098a.C1914a;
import java.net.InetAddress;
import java.net.URL;
import java.text.DecimalFormat;
import java.util.HashMap;
import java.util.Map;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import performance.jd.jdreportperformance.entity.StategyEntity;

/* renamed from: com.jd.libs.hybrid.performance.a */
/* loaded from: classes.dex */
public class C1912a {

    /* renamed from: a */
    private static C1912a f3308a;

    /* renamed from: b */
    private boolean f3309b;

    /* renamed from: c */
    private ExecutorService f3310c;

    /* renamed from: d */
    private volatile boolean f3311d;

    /* renamed from: com.jd.libs.hybrid.performance.a$a */
    /* loaded from: classes.dex */
    static class RunnableC1913a implements Runnable {

        /* renamed from: a */
        HashMap<String, String> f3312a;

        /* renamed from: b */
        boolean f3313b;

        /* renamed from: c */
        String f3314c;

        RunnableC1913a(Map<String, String> map, boolean z, String str) {
            this.f3312a = new HashMap<>(map);
            this.f3313b = z;
            this.f3314c = str;
        }

        @Override // java.lang.Runnable
        public final void run() {
            try {
                if (C1912a.m1170a().m1164c()) {
                    this.f3312a.put("cpu", C1914a.m1163a());
                    this.f3312a.put("usedMem", C1914a.m1160c());
                    this.f3312a.put("mem", C1914a.m1161b());
                    this.f3312a.put("isLowMem", C1914a.m1159d());
                }
                if (this.f3313b && !this.f3312a.containsKey("resolvedIp")) {
                    this.f3312a.put("resolvedIp", C1912a.m1165b(new URL(this.f3314c).getHost()));
                }
            } catch (Exception e) {
                Log.e("WebPerfManager", e.getMessage(), e);
            }
            C1912a.m1170a().m1167a(this.f3312a);
        }
    }

    private C1912a() {
        boolean z = false;
        this.f3309b = false;
        this.f3311d = false;
        try {
            StategyEntity a = C1918d.m1116a(WebPerfMonitor.getApplication(), "7", IBack.PHOTO_BACK);
            if (a != null) {
                this.f3309b = "1".equals(a.ret);
                if (this.f3309b) {
                    this.f3310c = Executors.newFixedThreadPool(1);
                }
                JDJSONObject parseObject = JDJSON.parseObject(a.param);
                if (parseObject != null && 1 == parseObject.getIntValue("detail")) {
                    z = true;
                }
                this.f3311d = z;
                if (OKLog.f4224D) {
                    OKLog.m135d("WebPerfManager", "新版性能监控初始化, enable = " + this.f3309b + ", reportDetail = " + this.f3311d);
                }
            }
        } catch (Exception e) {
            Log.e("WebPerfManager", e.getMessage(), e);
        }
    }

    /* renamed from: a */
    public static C1912a m1170a() {
        if (f3308a == null) {
            synchronized (C1912a.class) {
                if (f3308a == null) {
                    f3308a = new C1912a();
                }
            }
        }
        return f3308a;
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* renamed from: b */
    public static String m1165b(String str) {
        if (TextUtils.isEmpty(str)) {
            return "";
        }
        try {
            InetAddress byName = InetAddress.getByName(str);
            return byName != null ? byName.getHostAddress() : "";
        } catch (Exception unused) {
            return "";
        }
    }

    /* renamed from: a */
    public synchronized void m1169a(C1915b bVar) {
        if (this.f3309b && bVar != null && !bVar.m1139f()) {
            if (bVar.m1138g() != null && !bVar.m1138g().isEmpty()) {
                if (this.f3310c != null) {
                    try {
                        if (!bVar.m1144c("occurTime")) {
                            double currentTimeMillis = (double) System.currentTimeMillis();
                            Double.isNaN(currentTimeMillis);
                            bVar.m1153a("occurTime", new DecimalFormat("0.000000").format(currentTimeMillis / 1000.0d));
                        }
                        bVar.m1143c(true);
                        this.f3310c.submit(new RunnableC1913a(bVar.m1138g(), bVar.m1149b(), !TextUtils.isEmpty(bVar.m1140e()) ? bVar.m1140e() : bVar.m1142d()));
                    } catch (Exception e) {
                        Log.e("WebPerfManager", e.getMessage(), e);
                    }
                }
            }
        }
    }

    /* renamed from: a */
    public void m1167a(HashMap<String, String> hashMap) {
        if (this.f3309b && hashMap != null && !hashMap.isEmpty()) {
            try {
                if (!hashMap.containsKey("occurTime")) {
                    double currentTimeMillis = (double) System.currentTimeMillis();
                    Double.isNaN(currentTimeMillis);
                    hashMap.put("occurTime", new DecimalFormat("0.000000").format(currentTimeMillis / 1000.0d));
                }
                hashMap.put("typeId", "7");
                hashMap.put("chId", IBack.PHOTO_BACK);
                if (OKLog.f4224D) {
                    OKLog.m135d("WebPerfManager", "上报性能数据 = " + hashMap.toString());
                }
                C1918d.m1115a(hashMap);
            } catch (Exception e) {
                Log.e("WebPerfManager", e.getMessage(), e);
            }
        }
    }

    /* renamed from: b */
    public boolean m1166b() {
        return this.f3309b;
    }

    /* renamed from: c */
    public boolean m1164c() {
        return this.f3311d;
    }
}
