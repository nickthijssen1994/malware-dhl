package com.p051jd.libs.hybrid.performance;

import android.text.TextUtils;
import com.huawei.hms.push.constant.RemoteMessageConst;
import com.jingdong.sdk.oklog.OKLog;
import com.p051jd.framework.json.JDJSONObject;
import com.p051jd.libs.hybrid.performance.p098a.C1914a;
import com.tencent.smtt.sdk.CookieManager;
import com.tencent.smtt.sdk.WebView;
import java.util.Collections;
import java.util.HashMap;
import java.util.LinkedList;
import java.util.List;
import java.util.Map;

/* renamed from: com.jd.libs.hybrid.performance.c */
/* loaded from: classes.dex */
public class C1917c {

    /* renamed from: a */
    private WebView f3334a;

    /* renamed from: c */
    private volatile C1915b f3336c;

    /* renamed from: b */
    private final List<C1915b> f3335b = Collections.synchronizedList(new LinkedList());

    /* renamed from: d */
    private String f3337d = "webview";

    /* renamed from: e */
    private String f3338e = null;

    public C1917c(WebView webView) {
        C1912a.m1170a();
        this.f3334a = webView;
        m1135a();
    }

    /* renamed from: a */
    public C1915b m1135a() {
        if (!C1912a.m1170a().m1166b()) {
            return null;
        }
        C1915b bVar = new C1915b(System.currentTimeMillis());
        this.f3336c = bVar;
        bVar.m1153a("pageType", this.f3337d);
        WebView webView = this.f3334a;
        bVar.m1153a("pageName", (webView == null || webView.getContext() == null) ? "" : this.f3334a.getContext().getClass().getSimpleName());
        bVar.m1153a("businessType", "0");
        bVar.m1153a("businessBingo", "0");
        bVar.m1153a("preloadStatus", "0");
        this.f3335b.add(bVar);
        if (OKLog.f4224D) {
            OKLog.m135d("WebPerformanceHolder", "新增一条性能数据，目前size = " + this.f3335b.size() + ", 当前数据 = " + this.f3336c.toString());
        }
        return bVar;
    }

    /* renamed from: a */
    public C1915b m1130a(String str, String str2) {
        if (!C1912a.m1170a().m1166b() || TextUtils.isEmpty(str) || this.f3335b.isEmpty()) {
            return null;
        }
        synchronized (this.f3335b) {
            if (this.f3335b.isEmpty()) {
                return null;
            }
            for (C1915b bVar : this.f3335b) {
                if (!(bVar == null || !str.equalsIgnoreCase(bVar.m1142d()) || bVar.m1144c(str2))) {
                    return bVar;
                }
            }
            return null;
        }
    }

    /* renamed from: a */
    public void m1134a(JDJSONObject jDJSONObject) {
        if (this.f3336c != null) {
            this.f3336c.m1156a(jDJSONObject);
        }
    }

    /* renamed from: a */
    public void m1133a(C1915b bVar) {
        if (C1912a.m1170a().m1166b() && bVar != null) {
            if (bVar.m1144c("pageFinish100")) {
                bVar.m1154a("pageFinish100", (Object) bVar.m1147b("pageFinish100"));
            }
            if (m1121d() && bVar.m1144c("initStart")) {
                bVar.m1153a("interrupt", String.valueOf(System.currentTimeMillis()));
                bVar.m1154a("firstInterruptMsg", (Object) m1119e());
            }
            if (bVar.m1137h()) {
                bVar.m1152a("singleInterrupt", "time", String.valueOf(System.currentTimeMillis()));
                bVar.m1152a("singleInterrupt", RemoteMessageConst.MessageBody.MSG, bVar.m1136i());
            }
            if (bVar.m1144c("combinedPageStart") || bVar.m1144c("combinedPageFinish")) {
                bVar.m1152a("combined", "combinedPageStart", bVar.m1147b("combinedPageStart"));
                bVar.m1152a("combined", "combinedPageFinish", bVar.m1147b("combinedPageFinish"));
            }
            if (bVar.m1145c()) {
                WebView webView = this.f3334a;
                bVar.m1153a("useragent", webView != null ? webView.getSettings().getUserAgentString() : "");
                String d = bVar.m1142d();
                if (!TextUtils.isEmpty(d)) {
                    HashMap hashMap = new HashMap();
                    hashMap.put("cookies", CookieManager.getInstance().getCookie(d));
                    bVar.m1151a("header", (Map<String, String>) hashMap);
                }
            }
            WebView webView2 = this.f3334a;
            bVar.m1153a("coreType", webView2 != null ? webView2.getX5WebViewExtension() != null ? "x5" : "system" : "");
            bVar.m1153a("coreVersion", String.valueOf(WebView.getTbsCoreVersion(WebPerfMonitor.getApplication())));
            C1912a.m1170a().m1169a(bVar);
        }
    }

    /* renamed from: a */
    public void m1132a(C1915b bVar, boolean z) {
        if (C1912a.m1170a().m1166b() && bVar != null && bVar.m1158a() != 0 && !this.f3335b.isEmpty()) {
            C1915b bVar2 = null;
            while (true) {
                C1915b bVar3 = this.f3335b.get(0);
                if (bVar3 != null && bVar2 != bVar3) {
                    if (z) {
                        if (bVar3.m1158a() > bVar.m1158a()) {
                            return;
                        }
                    } else if (bVar3.m1158a() >= bVar.m1158a()) {
                        return;
                    }
                    if (!bVar3.m1139f()) {
                        m1133a(bVar3);
                    }
                    this.f3335b.remove(bVar3);
                    if (OKLog.f4224D) {
                        OKLog.m135d("WebPerformanceHolder", "[删除]一条性能数据，目前size = " + this.f3335b.size());
                    }
                    if (!this.f3335b.isEmpty()) {
                        bVar2 = bVar3;
                    } else {
                        return;
                    }
                } else {
                    return;
                }
            }
        }
    }

    /* renamed from: a */
    public void m1129a(boolean z) {
        if (this.f3336c != null) {
            this.f3336c.m1146b(z);
        }
    }

    /* renamed from: a */
    public boolean m1131a(String str) {
        return C1914a.m1162a(str);
    }

    /* renamed from: b */
    public C1915b m1126b(String str) {
        return m1130a(str, "pageFinish");
    }

    /* renamed from: b */
    public void m1128b() {
        if (C1912a.m1170a().m1166b() && !this.f3335b.isEmpty()) {
            m1132a(this.f3336c, true);
        }
    }

    /* renamed from: b */
    public void m1127b(JDJSONObject jDJSONObject) {
        if (this.f3336c != null) {
            this.f3336c.m1148b(jDJSONObject);
        }
    }

    /* renamed from: b */
    public void m1125b(String str, String str2) {
        if (this.f3336c != null) {
            this.f3336c.m1153a(str, str2);
        }
    }

    /* renamed from: b */
    public void m1124b(boolean z) {
        if (this.f3336c != null) {
            this.f3336c.m1150a(z);
        }
    }

    /* renamed from: c */
    public C1915b m1123c() {
        return this.f3336c;
    }

    /* renamed from: c */
    public C1915b m1122c(String str) {
        return m1130a(str, "pageFinish100");
    }

    /* renamed from: d */
    public void m1120d(String str) {
        if (this.f3336c != null) {
            this.f3336c.m1155a(str);
        }
    }

    /* renamed from: d */
    public boolean m1121d() {
        return !TextUtils.isEmpty(this.f3338e);
    }

    /* renamed from: e */
    public String m1119e() {
        return this.f3338e;
    }

    /* renamed from: e */
    public void m1118e(String str) {
        this.f3338e = str;
    }
}
