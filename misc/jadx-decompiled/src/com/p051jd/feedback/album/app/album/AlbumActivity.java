package com.p051jd.feedback.album.app.album;

import android.content.Context;
import android.content.Intent;
import android.content.res.Configuration;
import android.content.res.Resources;
import android.os.Bundle;
import android.text.TextUtils;
import android.view.MenuItem;
import android.view.View;
import android.widget.CompoundButton;
import androidx.annotation.NonNull;
import androidx.appcompat.widget.PopupMenu;
import com.p051jd.feedback.C1287R;
import com.p051jd.feedback.album.AbstractC1303a;
import com.p051jd.feedback.album.AbstractC1377g;
import com.p051jd.feedback.album.C1363b;
import com.p051jd.feedback.album.C1371d;
import com.p051jd.feedback.album.C1373e;
import com.p051jd.feedback.album.app.C1320a;
import com.p051jd.feedback.album.app.album.GalleryActivity;
import com.p051jd.feedback.album.app.album.p068a.AsyncTaskC1337a;
import com.p051jd.feedback.album.app.album.p068a.AsyncTaskC1342d;
import com.p051jd.feedback.album.app.album.p068a.AsyncTaskC1344e;
import com.p051jd.feedback.album.app.album.p068a.C1340b;
import com.p051jd.feedback.album.app.album.p068a.C1341c;
import com.p051jd.feedback.album.mvp.BaseActivity;
import com.p051jd.feedback.album.p064a.C1317d;
import com.p051jd.feedback.album.p064a.C1319f;
import com.p051jd.feedback.album.p064a.p067c.C1311a;
import com.p051jd.feedback.album.p069b.AbstractC1366c;
import com.p051jd.feedback.album.p070c.C1369a;
import com.p051jd.feedback.album.widget.DialogC1388a;
import com.p051jd.feedback.p075ui.C1448b;
import com.yanzhenjie.mediascanner.a;
import java.io.File;
import java.util.ArrayList;
import java.util.List;

/* compiled from: TbsSdkJava */
/* renamed from: com.jd.feedback.album.app.album.AlbumActivity */
/* loaded from: classes.dex */
public class AlbumActivity extends BaseActivity implements C1320a.AbstractC1321a, GalleryActivity.AbstractC1330a, AsyncTaskC1337a.AbstractC1338a, AsyncTaskC1342d.AbstractC1343a, AsyncTaskC1344e.AbstractC1345a {

    /* renamed from: a */
    public static AbstractC1377g<Long> f2281a;

    /* renamed from: b */
    public static AbstractC1377g<String> f2282b;

    /* renamed from: c */
    public static AbstractC1377g<Long> f2283c;

    /* renamed from: d */
    public static AbstractC1303a<ArrayList<C1371d>> f2284d;

    /* renamed from: e */
    public static AbstractC1303a<String> f2285e;

    /* renamed from: f */
    static final /* synthetic */ boolean f2286f = !AlbumActivity.class.desiredAssertionStatus();

    /* renamed from: A */
    private DialogC1388a f2287A;

    /* renamed from: B */
    private AsyncTaskC1337a f2288B;

    /* renamed from: C */
    private AbstractC1303a<String> f2289C = new AbstractC1303a<String>() { // from class: com.jd.feedback.album.app.album.AlbumActivity.3
        /* JADX WARN: Type inference failed for: r0v7, types: [android.content.Context, com.jd.feedback.album.app.album.AlbumActivity] */
        /* JADX WARN: Type inference failed for: r1v0, types: [android.content.Context, com.jd.feedback.album.app.album.AlbumActivity] */
        /* JADX WARN: Unknown variable types count: 1 */
        @Override // com.p051jd.feedback.album.AbstractC1303a
        /* renamed from: a */
        /* Code decompiled incorrectly, please refer to instructions dump */
        public final /* synthetic */ void mo2162a(@NonNull String str) {
            String str2 = str;
            if (AlbumActivity.this.f2303w == null) {
                ?? r0 = AlbumActivity.this;
                ((AlbumActivity) r0).f2303w = new a((Context) r0);
            }
            AlbumActivity.this.f2303w.a(str2);
            new AsyncTaskC1342d(new C1341c(AlbumActivity.this, AlbumActivity.f2281a, AlbumActivity.f2282b, AlbumActivity.f2283c), AlbumActivity.this).execute(str2);
        }
    };

    /* renamed from: j */
    private List<C1373e> f2290j;

    /* renamed from: k */
    private int f2291k;

    /* renamed from: l */
    private C1311a f2292l;

    /* renamed from: m */
    private int f2293m;

    /* renamed from: n */
    private int f2294n;

    /* renamed from: o */
    private int f2295o;

    /* renamed from: p */
    private boolean f2296p;

    /* renamed from: q */
    private int f2297q;

    /* renamed from: r */
    private int f2298r;

    /* renamed from: s */
    private long f2299s;

    /* renamed from: t */
    private long f2300t;

    /* renamed from: u */
    private boolean f2301u;

    /* renamed from: v */
    private ArrayList<C1371d> f2302v;

    /* renamed from: w */
    private a f2303w;

    /* renamed from: x */
    private C1320a.AbstractC1322b f2304x;

    /* renamed from: y */
    private C1354d f2305y;

    /* renamed from: z */
    private PopupMenu f2306z;

    @Override // com.p051jd.feedback.album.mvp.BaseActivity
    public void onCreate(Bundle bundle) {
        int i;
        super.onCreate(bundle);
        Bundle extras = getIntent().getExtras();
        if (f2286f || extras != null) {
            this.f2292l = (C1311a) extras.getParcelable("KEY_INPUT_WIDGET");
            this.f2293m = extras.getInt("KEY_INPUT_FUNCTION");
            this.f2294n = extras.getInt("KEY_INPUT_CHOICE_MODE");
            this.f2295o = extras.getInt("KEY_INPUT_COLUMN_COUNT");
            this.f2296p = extras.getBoolean("KEY_INPUT_ALLOW_CAMERA");
            this.f2297q = extras.getInt("KEY_INPUT_LIMIT_COUNT");
            this.f2298r = extras.getInt("KEY_INPUT_CAMERA_QUALITY");
            this.f2299s = extras.getLong("KEY_INPUT_CAMERA_DURATION");
            this.f2300t = extras.getLong("KEY_INPUT_CAMERA_BYTES");
            this.f2301u = extras.getBoolean("KEY_INPUT_FILTER_VISIBILITY");
            switch (this.f2292l.f2253a) {
                case 1:
                    i = C1287R.layout.album_activity_album_light;
                    break;
                case 2:
                    i = C1287R.layout.album_activity_album_dark;
                    break;
                default:
                    throw new AssertionError("This should not be the case.");
            }
            setContentView(i);
            this.f2304x = new View$OnClickListenerC1347b(this, this, this.f2297q);
            this.f2304x.mo2141a(this.f2292l, this.f2295o, this.f2296p, this.f2294n);
            this.f2304x.m2065c(this.f2292l.f2257e);
            this.f2304x.mo2139a(true);
            m2075a(f2478i, 1);
            return;
        }
        throw new AssertionError();
    }

    public void onConfigurationChanged(Configuration configuration) {
        super.onConfigurationChanged(configuration);
        this.f2304x.mo2142a(configuration);
        C1354d dVar = this.f2305y;
        if (dVar != null && !dVar.isShowing()) {
            this.f2305y = null;
        }
    }

    /* JADX WARN: Multi-variable type inference failed */
    @Override // com.p051jd.feedback.album.mvp.BaseActivity
    /* renamed from: b */
    public final void mo2073b(int i) {
        this.f2288B = new AsyncTaskC1337a(this.f2293m, getIntent().getParcelableArrayListExtra("KEY_INPUT_CHECKED_LIST"), new C1340b(this, f2281a, f2282b, f2283c, this.f2301u), this);
        this.f2288B.execute(new Void[0]);
    }

    /* JADX WARN: Multi-variable type inference failed */
    @Override // com.p051jd.feedback.album.mvp.BaseActivity
    /* renamed from: a_ */
    public final void mo2074a_() {
        C1448b.m1940a(this, getResources().getString(C1287R.string.album_permission_storage_failed_hint)).show();
    }

    /* JADX WARN: Multi-variable type inference failed */
    @Override // com.p051jd.feedback.album.app.album.p068a.AsyncTaskC1337a.AbstractC1338a
    /* renamed from: a */
    public final void mo2161a(ArrayList<C1373e> arrayList, ArrayList<C1371d> arrayList2) {
        this.f2288B = null;
        switch (this.f2294n) {
            case 1:
            case 2:
                this.f2304x.mo2139a(false);
                this.f2290j = arrayList;
                this.f2302v = arrayList2;
                if (this.f2290j.get(0).f2473b.isEmpty()) {
                    Intent intent = new Intent((Context) this, (Class<?>) NullActivity.class);
                    intent.putExtras(getIntent());
                    startActivityForResult(intent, 1);
                    return;
                }
                m2178c(0);
                this.f2304x.mo2136c(this.f2302v.size());
                return;
            default:
                throw new AssertionError("This should not be the case.");
        }
    }

    protected void onActivityResult(int i, int i2, Intent intent) {
        if (i == 1) {
            if (i2 == -1) {
                String a = NullActivity.m2164a(intent);
                if (!TextUtils.isEmpty(C1369a.m2094a(a))) {
                    this.f2289C.mo2162a(a);
                    return;
                }
                return;
            }
            m2171l();
        }
    }

    /* JADX WARN: Multi-variable type inference failed */
    @Override // com.p051jd.feedback.album.app.C1320a.AbstractC1321a
    /* renamed from: a */
    public final void mo2187a() {
        if (this.f2305y == null) {
            this.f2305y = new C1354d(this, this.f2292l, this.f2290j, new AbstractC1366c() { // from class: com.jd.feedback.album.app.album.AlbumActivity.1
                @Override // com.p051jd.feedback.album.p069b.AbstractC1366c
                /* renamed from: a */
                public final void mo2103a(View view, int i) {
                    AlbumActivity.this.f2291k = i;
                    AlbumActivity albumActivity = AlbumActivity.this;
                    albumActivity.m2178c(albumActivity.f2291k);
                }
            });
        }
        if (!this.f2305y.isShowing()) {
            this.f2305y.show();
        }
    }

    /* renamed from: c */
    public void m2178c(int i) {
        this.f2291k = i;
        this.f2304x.mo2140a(this.f2290j.get(i));
    }

    /* JADX WARN: Multi-variable type inference failed */
    @Override // com.p051jd.feedback.album.app.C1320a.AbstractC1321a
    public void clickCamera(View view) {
        int i;
        if (this.f2302v.size() >= this.f2297q) {
            switch (this.f2293m) {
                case 0:
                    i = C1287R.plurals.album_check_image_limit_camera;
                    break;
                case 1:
                    i = C1287R.plurals.album_check_video_limit_camera;
                    break;
                case 2:
                    i = C1287R.plurals.album_check_album_limit_camera;
                    break;
                default:
                    throw new AssertionError("This should not be the case.");
            }
            C1320a.AbstractC1322b bVar = this.f2304x;
            Resources resources = getResources();
            int i2 = this.f2297q;
            bVar.m2067a(resources.getQuantityString(i, i2, Integer.valueOf(i2)));
            return;
        }
        switch (this.f2293m) {
            case 0:
                m2175h();
                return;
            case 1:
                m2174i();
                return;
            case 2:
                if (this.f2306z == null) {
                    this.f2306z = new PopupMenu(this, view);
                    this.f2306z.getMenuInflater().inflate(C1287R.menu.album_menu_item_camera, this.f2306z.getMenu());
                    this.f2306z.setOnMenuItemClickListener(new PopupMenu.OnMenuItemClickListener() { // from class: com.jd.feedback.album.app.album.AlbumActivity.2
                        public final boolean onMenuItemClick(MenuItem menuItem) {
                            int itemId = menuItem.getItemId();
                            if (itemId == C1287R.C1290id.album_menu_camera_image) {
                                AlbumActivity.this.m2175h();
                                return true;
                            } else if (itemId != C1287R.C1290id.album_menu_camera_video) {
                                return true;
                            } else {
                                AlbumActivity.this.m2174i();
                                return true;
                            }
                        }
                    });
                }
                this.f2306z.show();
                return;
            default:
                throw new AssertionError("This should not be the case.");
        }
    }

    /* JADX WARN: Multi-variable type inference failed */
    /* renamed from: h */
    public void m2175h() {
        String str;
        int i = this.f2291k;
        if (i == 0) {
            str = C1369a.m2100a();
        } else {
            str = C1369a.m2095a(new File(this.f2290j.get(i).f2473b.get(0).f2460b).getParentFile(), ".jpg");
        }
        C1317d b = C1363b.m2106a(this).mo2198b();
        b.f2246d = str;
        C1317d dVar = b;
        dVar.f2244b = this.f2289C;
        dVar.m2190a();
    }

    /* JADX WARN: Multi-variable type inference failed */
    /* renamed from: i */
    public void m2174i() {
        String str;
        int i = this.f2291k;
        if (i == 0) {
            str = C1369a.m2093b();
        } else {
            str = C1369a.m2095a(new File(this.f2290j.get(i).f2473b.get(0).f2460b).getParentFile(), ".mp4");
        }
        C1319f a = C1363b.m2106a(this).mo2199a();
        a.f2246d = str;
        C1319f fVar = a;
        fVar.f2278e = this.f2298r;
        fVar.f2279f = this.f2299s;
        fVar.f2280g = this.f2300t;
        fVar.f2244b = this.f2289C;
        fVar.m2188a();
    }

    @Override // com.p051jd.feedback.album.app.album.p068a.AsyncTaskC1342d.AbstractC1343a
    /* renamed from: d */
    public final void mo2151d() {
        m2170m();
        this.f2287A.m2044a(C1287R.string.album_converting);
    }

    @Override // com.p051jd.feedback.album.app.C1320a.AbstractC1321a
    /* renamed from: a */
    public final void mo2185a(CompoundButton compoundButton, int i) {
        int i2;
        C1371d dVar = this.f2290j.get(this.f2291k).f2473b.get(i);
        if (!compoundButton.isChecked()) {
            dVar.f2470l = false;
            this.f2302v.remove(dVar);
            m2173j();
        } else if (this.f2302v.size() >= this.f2297q) {
            switch (this.f2293m) {
                case 0:
                    i2 = C1287R.plurals.album_check_image_limit;
                    break;
                case 1:
                    i2 = C1287R.plurals.album_check_video_limit;
                    break;
                case 2:
                    i2 = C1287R.plurals.album_check_album_limit;
                    break;
                default:
                    throw new AssertionError("This should not be the case.");
            }
            C1320a.AbstractC1322b bVar = this.f2304x;
            Resources resources = getResources();
            int i3 = this.f2297q;
            bVar.m2067a(resources.getQuantityString(i2, i3, Integer.valueOf(i3)));
            compoundButton.setChecked(false);
        } else {
            dVar.f2470l = true;
            this.f2302v.add(dVar);
            m2173j();
        }
    }

    /* renamed from: j */
    private void m2173j() {
        this.f2304x.mo2136c(this.f2302v.size());
    }

    /* JADX WARN: Multi-variable type inference failed */
    @Override // com.p051jd.feedback.album.app.C1320a.AbstractC1321a
    /* renamed from: a */
    public final void mo2186a(int i) {
        switch (this.f2294n) {
            case 1:
                GalleryActivity.f2310a = this.f2290j.get(this.f2291k).f2473b;
                GalleryActivity.f2311b = this.f2302v.size();
                GalleryActivity.f2312c = i;
                GalleryActivity.f2313d = this;
                Intent intent = new Intent((Context) this, (Class<?>) GalleryActivity.class);
                intent.putExtras(getIntent());
                startActivity(intent);
                return;
            case 2:
                this.f2302v.add(this.f2290j.get(this.f2291k).f2473b.get(i));
                m2173j();
                m2172k();
                return;
            default:
                throw new AssertionError("This should not be the case.");
        }
    }

    @Override // com.p051jd.feedback.album.app.album.GalleryActivity.AbstractC1330a
    /* renamed from: e */
    public final void mo2166e() {
        m2172k();
    }

    @Override // com.p051jd.feedback.album.app.album.GalleryActivity.AbstractC1330a
    /* renamed from: b */
    public final void mo2167b(C1371d dVar) {
        int indexOf = this.f2290j.get(this.f2291k).f2473b.indexOf(dVar);
        if (this.f2296p) {
            indexOf++;
        }
        this.f2304x.mo2138b(indexOf);
        if (dVar.f2470l) {
            if (!this.f2302v.contains(dVar)) {
                this.f2302v.add(dVar);
            }
        } else if (this.f2302v.contains(dVar)) {
            this.f2302v.remove(dVar);
        }
        m2173j();
    }

    @Override // com.p051jd.feedback.album.app.C1320a.AbstractC1321a
    /* renamed from: b */
    public final void mo2181b() {
        int i;
        if (this.f2302v.isEmpty()) {
            switch (this.f2293m) {
                case 0:
                    i = C1287R.string.album_check_image_little;
                    break;
                case 1:
                    i = C1287R.string.album_check_video_little;
                    break;
                case 2:
                    i = C1287R.string.album_check_album_little;
                    break;
                default:
                    throw new AssertionError("This should not be the case.");
            }
            this.f2304x.m2059h(i);
            return;
        }
        m2172k();
    }

    public void onBackPressed() {
        AsyncTaskC1337a aVar = this.f2288B;
        if (aVar != null) {
            aVar.cancel(true);
        }
        m2171l();
    }

    /* JADX WARN: Multi-variable type inference failed */
    /* renamed from: k */
    private void m2172k() {
        new AsyncTaskC1344e(this, this.f2302v, this).execute(new Void[0]);
    }

    @Override // com.p051jd.feedback.album.app.album.p068a.AsyncTaskC1344e.AbstractC1345a
    /* renamed from: f */
    public final void mo2149f() {
        m2170m();
        this.f2287A.m2044a(C1287R.string.album_thumbnail);
    }

    @Override // com.p051jd.feedback.album.app.album.p068a.AsyncTaskC1344e.AbstractC1345a
    /* renamed from: a */
    public final void mo2150a(ArrayList<C1371d> arrayList) {
        AbstractC1303a<ArrayList<C1371d>> aVar = f2284d;
        if (aVar != null) {
            aVar.mo2162a(arrayList);
        }
        m2169n();
        finish();
    }

    /* renamed from: l */
    private void m2171l() {
        AbstractC1303a<String> aVar = f2285e;
        if (aVar != null) {
            aVar.mo2162a("User canceled.");
        }
        finish();
    }

    /* JADX WARN: Multi-variable type inference failed */
    /* renamed from: m */
    private void m2170m() {
        if (this.f2287A == null) {
            this.f2287A = new DialogC1388a(this);
            this.f2287A.m2043a(this.f2292l);
        }
        if (!this.f2287A.isShowing()) {
            this.f2287A.show();
        }
    }

    /* renamed from: n */
    private void m2169n() {
        DialogC1388a aVar = this.f2287A;
        if (aVar != null && aVar.isShowing()) {
            this.f2287A.dismiss();
        }
    }

    public void finish() {
        f2281a = null;
        f2282b = null;
        f2283c = null;
        f2284d = null;
        f2285e = null;
        super.finish();
    }

    @Override // com.p051jd.feedback.album.app.album.p068a.AsyncTaskC1342d.AbstractC1343a
    /* renamed from: a */
    public final void mo2152a(C1371d dVar) {
        dVar.f2470l = !dVar.f2471m;
        if (!dVar.f2471m || this.f2301u) {
            if (this.f2291k != 0) {
                ArrayList<C1371d> arrayList = this.f2290j.get(0).f2473b;
                if (arrayList.size() > 0) {
                    arrayList.add(0, dVar);
                } else {
                    arrayList.add(dVar);
                }
            }
            C1373e eVar = this.f2290j.get(this.f2291k);
            ArrayList<C1371d> arrayList2 = eVar.f2473b;
            if (arrayList2.isEmpty()) {
                arrayList2.add(dVar);
                this.f2304x.mo2140a(eVar);
            } else {
                arrayList2.add(0, dVar);
                this.f2304x.mo2143a(this.f2296p ? 1 : 0);
            }
            this.f2302v.add(dVar);
            this.f2304x.mo2136c(this.f2302v.size());
            switch (this.f2294n) {
                case 1:
                    break;
                default:
                    throw new AssertionError("This should not be the case.");
                case 2:
                    m2172k();
                    break;
            }
        } else {
            this.f2304x.m2067a(getString(C1287R.string.album_take_file_unavailable));
        }
        m2169n();
    }
}
