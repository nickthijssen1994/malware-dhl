package com.p051jd.sentry.performance.block.p115a;

import com.jd.sentry.Sentry;
import com.jd.sentry.util.Log;
import com.p051jd.sentry.performance.block.p117c.C2091d;
import com.p051jd.sentry.performance.block.p117c.C2092e;
import com.p051jd.sentry.performance.block.p119e.C2098a;
import java.util.ArrayList;
import java.util.LinkedHashMap;

/* renamed from: com.jd.sentry.performance.block.a.c */
/* loaded from: classes.dex */
public class C2080c extends AbstractC2077a {

    /* renamed from: c */
    private static final LinkedHashMap<Long, C2091d> f3673c = new LinkedHashMap<>();

    /* renamed from: d */
    private int f3674d;

    /* renamed from: e */
    private Thread f3675e;

    public C2080c(Thread thread, int i, long j) {
        super(j);
        this.f3674d = 40;
        this.f3675e = thread;
        this.f3674d = i;
    }

    public C2080c(Thread thread, long j) {
        this(thread, 40, j);
    }

    /* renamed from: a */
    public ArrayList<C2092e> m781a(long j, long j2, String str) {
        ArrayList<C2092e> arrayList = new ArrayList<>();
        synchronized (f3673c) {
            String str2 = "";
            String str3 = "";
            for (Long l : f3673c.keySet()) {
                if (j < l.longValue() && l.longValue() < j2) {
                    if (!f3673c.get(l).f3728d.equals(str2) || !f3673c.get(l).f3729e.equals(str3)) {
                        C2092e eVar = new C2092e();
                        eVar.f3730a = str;
                        eVar.f3734e = l.longValue();
                        eVar.f3736g = f3673c.get(l).f3728d;
                        eVar.f3737h = f3673c.get(l).f3729e;
                        eVar.f3735f = f3673c.get(l).m757a();
                        if (f3673c.get(l).f3727c != null && f3673c.get(l).f3727c.length > 1) {
                            eVar.f3738i = eVar.f3736g;
                            StackTraceElement[] stackTraceElementArr = f3673c.get(l).f3727c;
                            int length = stackTraceElementArr.length;
                            int i = 0;
                            while (true) {
                                if (i >= length) {
                                    break;
                                }
                                StackTraceElement stackTraceElement = stackTraceElementArr[i];
                                if (C2098a.m741a().m740a(stackTraceElement.toString())) {
                                    eVar.f3738i = stackTraceElement.toString();
                                    break;
                                }
                                i++;
                            }
                        }
                        arrayList.add(eVar);
                        str2 = eVar.f3736g;
                        str3 = eVar.f3737h;
                    } else {
                        arrayList.get(arrayList.size() - 1).f3739j++;
                        arrayList.get(arrayList.size() - 1).f3740k = true;
                    }
                }
            }
        }
        return arrayList;
    }

    @Override // com.p051jd.sentry.performance.block.p115a.AbstractC2077a
    /* renamed from: c */
    long mo780c() {
        return (long) Sentry.getSentryConfig().getBlockContext().c();
    }

    @Override // com.p051jd.sentry.performance.block.p115a.AbstractC2077a
    /* renamed from: d */
    protected void mo779d() {
        C2091d remove;
        if (Log.LOGSWITCH && Log.LOGSWICTH_BLOCK) {
            Log.d("block", "StackSampler doSample");
        }
        try {
            C2091d b = C2091d.m756b();
            StackTraceElement[] stackTrace = this.f3675e.getStackTrace();
            synchronized (f3673c) {
                if (f3673c.size() == this.f3674d && this.f3674d > 0 && (remove = f3673c.remove(f3673c.keySet().iterator().next())) != null) {
                    remove.m755c();
                }
                if (stackTrace.length > 2) {
                    b.f3727c = stackTrace;
                    b.f3728d = stackTrace[0].toString();
                    b.f3729e = stackTrace[1].toString();
                    f3673c.put(Long.valueOf(System.currentTimeMillis()), b);
                }
            }
        } catch (Exception e) {
            Log.e(e.getMessage());
        }
    }
}
