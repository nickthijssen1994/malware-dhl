package com.p051jd.fireeye.common;

import android.content.Context;
import android.content.pm.ApplicationInfo;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import com.alibaba.fastjson.asm.Opcodes;
import com.p051jd.fireeye.common.process.C1477f;
import com.p051jd.fireeye.security.C1500d;
import java.util.List;
import org.json.JSONException;
import org.json.JSONObject;

/* compiled from: TbsSdkJava */
/* renamed from: com.jd.fireeye.common.f */
/* loaded from: classes.dex */
public final class C1461f {

    /* renamed from: a */
    private static final int f2615a = 300000;

    /* renamed from: b */
    private static final String f2616b = "InstalledAppGetter";

    /* renamed from: c */
    private static long f2617c;

    /* renamed from: d */
    private static JSONObject f2618d = new JSONObject();

    /* renamed from: e */
    private static String[] f2619e;

    static {
        String[] strArr = new String[Opcodes.IF_ICMPNE];
        strArr[0] = "com.eonsun.root";
        strArr[1] = "com.qihoo.permmgr";
        strArr[2] = "com.firstapq";
        strArr[3] = "cocoon.crimson.roots";
        strArr[4] = "com.hostei.exsetup";
        strArr[5] = "com.gmd.immersive";
        strArr[6] = "com.goodmooddroid.gesturecontrol";
        strArr[7] = "com.hroot.www.hrootnews";
        strArr[8] = "com.kingroot.kinguser";
        strArr[9] = "com.cafeteam.user";
        strArr[10] = "chili.app.mi6tool";
        strArr[11] = "com.pky.mifontinstaller";
        strArr[12] = "com.kdfly.miuihelper";
        strArr[13] = "app.greyshirts.sslcapture";
        strArr[14] = "com.speedsoftware.rootexplorer";
        strArr[15] = "com.apkol.root";
        strArr[16] = "com.rootuninstaller.pro";
        strArr[17] = "com.mgyun.shua.su";
        strArr[18] = "com.cpu82.roottoolcase";
        strArr[19] = "com.juxian.jxbestroot";
        strArr[20] = "com.shuame.rootgenius";
        strArr[21] = "com.myrootexplorer";
        strArr[22] = "com.NBRootwifl.urtws";
        strArr[23] = "com.vroot.hyn";
        strArr[24] = "com.zhiqupk.root";
        strArr[25] = "com.corner23.android.universalandroot";
        strArr[26] = "com.skeleton.root";
        strArr[27] = "com.fansapk.rootex";
        strArr[28] = "com.xxnoroot";
        strArr[29] = "com.jianjia.firewall";
        strArr[30] = "cn.com.opda.android.update";
        strArr[31] = "com.flamingo.cloudmachine";
        strArr[32] = "com.baiyi_mobile.easyroot";
        strArr[33] = "mobi.bihu.recovery";
        strArr[34] = "com.qitu.market";
        strArr[35] = "com.wmshua.wmroot";
        strArr[36] = "cn.hd.mobileforce";
        strArr[37] = "com.screeclibinvoke";
        strArr[38] = "shouyou.luping.jingl";
        strArr[39] = "com.smart.swkey";
        strArr[40] = "com.kiuasgames.rootworld";
        strArr[41] = "com.baidu.easyroot";
        strArr[42] = "com.wksall";
        strArr[43] = "com.genymotion.superuser";
        strArr[44] = "com.qihoo.magic";
        strArr[45] = "com.example.manyopen";
        strArr[46] = "com.parallelspace.multipleaccounts.appclone";
        strArr[47] = "com.excelliance.dualaid.vend";
        strArr[48] = "com.duv.example";
        strArr[49] = "com.wifi.box";
        strArr[50] = "com.godinsec.godinsec_private_space";
        strArr[51] = "com.lylm.dkzs";
        strArr[52] = "com.zeyilinxin.wavatar";
        strArr[53] = "com.youtang.youtang_private_space_multi";
        strArr[54] = "com.mi.multifission";
        strArr[55] = "com.sheep2.dkfs";
        strArr[56] = "com.qihoo.magic.xposed";
        strArr[57] = "com.cn.doubleapp";
        strArr[58] = "com.rinzz.avatar";
        strArr[59] = "com.excelliance.dualaid";
        strArr[60] = "com.ssapk.smartapp";
        strArr[61] = "com.wqhy.qqdkb";
        strArr[62] = "com.bly.dkplat";
        strArr[63] = "com.example.readidtest";
        strArr[64] = "com.magic.app.reader01";
        strArr[65] = "com.tyzhzxl.wxdkdsqd04";
        strArr[66] = "com.tom.kaikaikai";
        strArr[67] = "com.ludashi.dualspace";
        strArr[68] = "com.rinzz.avataryouzi";
        strArr[69] = "com.leaves.mulopen";
        strArr[70] = "com.rinzz.wdf";
        strArr[71] = "com.plda.dualapp";
        strArr[72] = "com.sheep2.xyfs";
        strArr[73] = "com.smallyin.Avaassis";
        strArr[74] = "com.xuanmutech.fenkai";
        strArr[75] = "com.jtjsb.yingyongfenshen";
        strArr[76] = "com.huihui.multopen";
        strArr[77] = "com.qihoo.magic_mutiple";
        strArr[78] = "com.weishang.sfduokai";
        strArr[79] = "com.keyuanmeng.wsfs";
        strArr[80] = "cn.fingera.mutlapp";
        strArr[81] = "com.tools.vaclone";
        strArr[82] = "com.juying.Jixiaomi.fenshen";
        strArr[83] = "com.svm.proteinbox_multi";
        strArr[84] = "com.xunrui.gamesaggregator";
        strArr[85] = "cn.com.vapp.nxfs";
        strArr[86] = "io.virtualapp.luohe";
        strArr[87] = "com.meta.app.fenshen";
        strArr[88] = "com.multi.app";
        strArr[89] = "com.soft.apk008v";
        strArr[90] = "com.cyzen.toolbox";
        strArr[91] = "com.lmiot.autotool";
        strArr[92] = "com.omarea.vboot";
        strArr[93] = "com.VTechno.androididchanger";
        strArr[94] = "com.shyl.artifact";
        strArr[95] = "com.doubee.ig";
        strArr[96] = "name.caiyao.sporteditor";
        strArr[97] = "zpp.wjy.xxsq";
        strArr[98] = "com.placering51.wap";
        strArr[99] = "com.lerist.fakelocation";
        strArr[100] = "com.hy.hywatch.t1";
        strArr[101] = "com.rong.xposed.fakelocation";
        strArr[102] = "com.finger.location";
        strArr[103] = "com.xingkong.kilolocation";
        strArr[104] = "com.dingweizshou";
        strArr[105] = "com.deniu.daniu";
        strArr[106] = "com.txy.anywhere";
        strArr[107] = "com.placeringqp.wap";
        strArr[108] = "com.cxjz.kaitian.locationsssh";
        strArr[109] = "com.yy.monidingwei";
        strArr[110] = "net.wecare.home";
        strArr[111] = "com.dtyh.locationfriend";
        strArr[112] = "com.xiaoqiang.location";
        strArr[113] = "com.ctbri.smartgraze";
        strArr[114] = "com.cc.meader.xdfree.locate";
        strArr[115] = "com.unking.weiguanai";
        strArr[116] = "com.dhuiwqna.xewqqem";
        strArr[117] = "com.kk.dingwei";
        strArr[118] = "com.zhongan.papa";
        strArr[119] = "com.pho.course";
        strArr[120] = "com.kmflocation.dn";
        strArr[121] = "com.findhim";
        strArr[122] = "com.yy.kaitian.phonelocationfifth";
        strArr[123] = "com.gps.appnew3";
        strArr[124] = "com.yy.kaitian.phonelocationone";
        strArr[125] = "com.ppkj.ppmonitor";
        strArr[126] = "com.xcloudtech.locate";
        strArr[127] = "com.lylm.virtualposition";
        strArr[128] = "com.chinamobile.iot.find";
        strArr[129] = "com.node.locationtrace";
        strArr[130] = "com.akuan.friend";
        strArr[131] = "xyz.wehere";
        strArr[132] = "com.app.aenson";
        strArr[133] = "cn.chinachip.qqwatch";
        strArr[134] = "com.seeworld.immediateposition";
        strArr[135] = "com.imibean.client";
        strArr[136] = "com.gps.location.gpstracker";
        strArr[137] = "com.yitong.pandabus.jingwei";
        strArr[138] = "com.sadjoke.fake";
        strArr[139] = "io.xudwoftencentmm";
        strArr[140] = "io.xudwofdd";
        strArr[141] = "com.felix.dingmock";
        strArr[142] = "com.xiaoya.xndw";
        strArr[143] = "com.perfay.blackcat.ui";
        strArr[144] = "de.robv.android.xposed.installer";
        strArr[145] = "com.devadvance.rootcloak2";
        strArr[146] = "just.trust.me";
        strArr[147] = "io.va.exposed";
        strArr[148] = "me.weishu.exp";
        strArr[149] = "com.topjohnwu.magisk";
        strArr[150] = "org.itxtech.daedalus";
        strArr[151] = "com.ansoft.utilitybox";
        strArr[152] = "zone.bytesreverser.xposeddeviceidmaskerfree";
        strArr[153] = "li.lingfeng.ltweaks";
        strArr[154] = "com.bigsing.fakemap";
        strArr[155] = "com.gnufabio.simeditor";
        strArr[156] = "com.fakemygps.android";
        strArr[157] = "eu.faircode.xlua";
        strArr[158] = "com.thermatk.android.xf.fakegapps";
        strArr[159] = "com.jy.taofanfan";
        f2619e = strArr;
    }

    /* renamed from: a */
    public static JSONObject m1898a(Context context) {
        if (!m1899a()) {
            return f2618d;
        }
        List<PackageInfo> installedPackages = context.getPackageManager().getInstalledPackages(0);
        StringBuilder sb = new StringBuilder();
        StringBuilder sb2 = new StringBuilder();
        int i = 0;
        int i2 = 0;
        int i3 = 0;
        for (int i4 = 0; i4 < installedPackages.size(); i4++) {
            PackageInfo packageInfo = installedPackages.get(i4);
            ApplicationInfo applicationInfo = packageInfo.applicationInfo;
            if (C1500d.f2727j.contains(packageInfo.packageName)) {
                String a = C1477f.m1740a(context, applicationInfo.packageName);
                if ((applicationInfo.flags & 1) <= 0) {
                    m1897a(sb2, a, packageInfo, "###");
                    sb2.append("0");
                    sb2.append("$$$");
                    i3++;
                    i2++;
                } else if ((applicationInfo.flags & 128) != 0) {
                    m1897a(sb2, a, packageInfo, "###");
                    sb2.append("1");
                    sb2.append("$$$");
                    i3++;
                    i2++;
                } else if ((applicationInfo.flags & 262144) != 0) {
                    m1897a(sb2, a, packageInfo, "###");
                    sb2.append("0");
                    sb2.append("$$$");
                    i3++;
                    i2++;
                }
            } else if (i < 200) {
                String a2 = C1477f.m1740a(context, applicationInfo.packageName);
                if ((applicationInfo.flags & 1) <= 0) {
                    m1897a(sb, a2, packageInfo, "###");
                    sb.append("0");
                    sb.append("$$$");
                    i3++;
                    i++;
                } else if ((applicationInfo.flags & 128) != 0) {
                    m1897a(sb, a2, packageInfo, "###");
                    sb.append("1");
                    sb.append("$$$");
                    i3++;
                    i++;
                } else if ((applicationInfo.flags & 262144) != 0) {
                    m1897a(sb, a2, packageInfo, "###");
                    sb.append("0");
                    sb.append("$$$");
                    i3++;
                    i++;
                }
            } else if ((applicationInfo.flags & 1) <= 0 || (applicationInfo.flags & 128) != 0 || (applicationInfo.flags & 262144) != 0) {
                i3++;
            }
        }
        sb2.append((CharSequence) sb);
        int i5 = i + i2;
        String str = "";
        if (sb2.length() > 3) {
            str = sb2.delete(sb2.length() - 3, sb2.length()).toString();
        }
        String str2 = str;
        for (int i6 = 0; i6 < i5 - 200; i6++) {
            try {
                str2 = str2.substring(0, str2.lastIndexOf("$$$"));
            } catch (Exception unused) {
            }
        }
        if (f2618d == null) {
            f2618d = new JSONObject();
        }
        try {
            f2618d.put("appCount", String.valueOf(i3));
            f2618d.put("appList", str2);
        } catch (JSONException e) {
            e.printStackTrace();
        }
        f2617c = System.currentTimeMillis();
        return f2618d;
    }

    /* renamed from: b */
    public static JSONObject m1896b(Context context) {
        if (C1500d.f2726i == null || C1500d.f2726i.size() == 0) {
            if (f2618d == null) {
                f2618d = new JSONObject();
            }
            try {
                f2618d.put("appCount", "");
                f2618d.put("appList", "");
            } catch (JSONException e) {
                e.printStackTrace();
            }
            return f2618d;
        } else if (!m1899a()) {
            return f2618d;
        } else {
            List<PackageInfo> installedPackages = context.getPackageManager().getInstalledPackages(0);
            StringBuilder sb = new StringBuilder();
            int i = 0;
            int i2 = 0;
            for (int i3 = 0; i3 < installedPackages.size(); i3++) {
                PackageInfo packageInfo = installedPackages.get(i3);
                ApplicationInfo applicationInfo = packageInfo.applicationInfo;
                if (C1500d.f2726i.contains(packageInfo.packageName)) {
                    i++;
                    String a = C1477f.m1740a(context, applicationInfo.packageName);
                    if ((applicationInfo.flags & 1) <= 0) {
                        m1897a(sb, a, packageInfo, "###");
                        sb.append("0");
                        sb.append("$$$");
                        i2++;
                    } else if ((applicationInfo.flags & 128) != 0) {
                        m1897a(sb, a, packageInfo, "###");
                        sb.append("1");
                        sb.append("$$$");
                        i2++;
                    } else if ((applicationInfo.flags & 262144) != 0) {
                        m1897a(sb, a, packageInfo, "###");
                        sb.append("0");
                        sb.append("$$$");
                        i2++;
                    }
                }
                if (i == C1500d.f2726i.size()) {
                    break;
                }
            }
            String str = "";
            if (sb.length() > 3) {
                str = sb.delete(sb.length() - 3, sb.length()).toString();
            }
            if (f2618d == null) {
                f2618d = new JSONObject();
            }
            try {
                f2618d.put("appCount", String.valueOf(i2));
                f2618d.put("appList", str);
            } catch (JSONException e2) {
                e2.printStackTrace();
            }
            f2617c = System.currentTimeMillis();
            return f2618d;
        }
    }

    /* renamed from: a */
    private static boolean m1899a() {
        JSONObject jSONObject = f2618d;
        return jSONObject == null || jSONObject.isNull("appList") || System.currentTimeMillis() - f2617c >= 300000;
    }

    /* renamed from: a */
    private static void m1897a(StringBuilder sb, String str, PackageInfo packageInfo, String str2) {
        sb.append(str);
        sb.append(str2);
        sb.append(packageInfo.versionName);
        sb.append(str2);
        sb.append(packageInfo.packageName);
        sb.append(str2);
        sb.append(C1483s.m1703a(packageInfo.firstInstallTime));
        sb.append(str2);
        sb.append(C1483s.m1703a(packageInfo.lastUpdateTime));
        sb.append(str2);
    }

    /* renamed from: c */
    private static String m1895c(Context context) {
        StringBuilder sb = new StringBuilder();
        for (int i = 0; i < f2619e.length; i++) {
            try {
                PackageManager packageManager = context.getPackageManager();
                PackageInfo packageInfo = packageManager.getPackageInfo(f2619e[i], 8192);
                String charSequence = packageInfo.applicationInfo.loadLabel(packageManager).toString();
                m1897a(sb, charSequence, packageInfo, "###");
                sb.append("0");
                sb.append("$$$");
                C1462g.m1893a("appName ====== " + charSequence + "; suspPackage ====== " + f2619e[i]);
            } catch (PackageManager.NameNotFoundException unused) {
            }
        }
        return sb.toString();
    }
}
