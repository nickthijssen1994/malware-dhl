package com.p051jd.lib.p083un.p084a.p085a;

import android.app.Activity;
import android.content.Context;
import android.graphics.Rect;
import android.hardware.Camera;
import android.hardware.Sensor;
import android.hardware.SensorEvent;
import android.hardware.SensorEventListener;
import android.hardware.SensorManager;
import android.view.View;
import android.widget.FrameLayout;
import android.widget.ImageView;
import android.widget.RelativeLayout;
import android.widget.TextView;
import androidx.annotation.ColorInt;
import com.p051jd.scan.C2042R;

/* renamed from: com.jd.lib.un.a.a.a */
/* loaded from: classes.dex */
public abstract class AbstractC1589a extends FrameLayout implements Camera.PreviewCallback, SensorEventListener, AbstractC1604h {

    /* renamed from: a */
    public C1601e f2862a;

    /* renamed from: b */
    public SurfaceHolder$CallbackC1596c f2863b;

    /* renamed from: c */
    public HandlerThreadC1593b f2864c;

    /* renamed from: d */
    public AbstractC1604h f2865d;

    /* renamed from: f */
    private AbstractC1603g f2867f;

    /* renamed from: g */
    private Boolean f2868g;

    /* renamed from: w */
    private Rect f2884w;

    /* renamed from: x */
    private ImageView f2885x;

    /* renamed from: y */
    private TextView f2886y;

    /* renamed from: z */
    private TextView f2887z;

    /* renamed from: h */
    private boolean f2869h = true;

    /* renamed from: i */
    private boolean f2870i = true;

    /* renamed from: j */
    private boolean f2871j = true;

    /* renamed from: k */
    private boolean f2872k = false;
    @ColorInt

    /* renamed from: l */
    private int f2873l = getResources().getColor(C2042R.color.viewfinder_laser);
    @ColorInt

    /* renamed from: m */
    private int f2874m = getResources().getColor(C2042R.color.viewfinder_border);

    /* renamed from: n */
    private int f2875n = getResources().getColor(C2042R.color.viewfinder_mask);

    /* renamed from: o */
    private int f2876o = getResources().getInteger(C2042R.integer.viewfinder_border_width);

    /* renamed from: p */
    private int f2877p = getResources().getInteger(C2042R.integer.viewfinder_border_length);

    /* renamed from: q */
    private boolean f2878q = false;

    /* renamed from: r */
    private int f2879r = 0;

    /* renamed from: s */
    private boolean f2880s = false;

    /* renamed from: t */
    private float f2881t = 1.0f;

    /* renamed from: u */
    private int f2882u = 0;

    /* renamed from: v */
    private float f2883v = 0.1f;

    /* renamed from: e */
    public SensorManager f2866e = (SensorManager) getContext().getSystemService("sensor");

    public AbstractC1589a(Context context) {
        super(context);
        C1605i iVar = new C1605i(getContext());
        iVar.setBorderColor(this.f2874m);
        iVar.setLaserColor(this.f2873l);
        iVar.setLaserEnabled(this.f2871j);
        iVar.setDrawDetect(this.f2872k);
        iVar.setBorderStrokeWidth(this.f2876o);
        iVar.setBorderLineLength(this.f2877p);
        iVar.setMaskColor(this.f2875n);
        iVar.setBorderCornerRounded(this.f2878q);
        iVar.setBorderCornerRadius(this.f2879r);
        iVar.setSquareViewFinder(this.f2880s);
        iVar.setViewFinderOffset(this.f2882u);
        this.f2867f = iVar;
    }

    @Override // com.p051jd.lib.p083un.p084a.p085a.AbstractC1604h
    /* renamed from: a */
    public final void mo1504a(float f) {
        ImageView imageView = this.f2885x;
        if (imageView != null) {
            if (((double) f) < 50.0d) {
                if (imageView.getVisibility() != 0) {
                    post(new Runnable() { // from class: com.jd.lib.un.a.a.a.2
                        @Override // java.lang.Runnable
                        public final void run() {
                            AbstractC1589a.this.f2885x.setVisibility(0);
                            AbstractC1589a.this.f2887z.setVisibility(0);
                            AbstractC1589a.this.f2886y.setVisibility(4);
                        }
                    });
                }
            } else if (imageView.getVisibility() == 0 && !getFlash()) {
                post(new Runnable() { // from class: com.jd.lib.un.a.a.a.3
                    @Override // java.lang.Runnable
                    public final void run() {
                        AbstractC1589a.this.f2885x.setVisibility(4);
                        AbstractC1589a.this.f2887z.setVisibility(4);
                        AbstractC1589a.this.f2886y.setVisibility(0);
                    }
                });
            }
        }
    }

    public boolean getFlash() {
        C1601e eVar = this.f2862a;
        return eVar != null && C1600d.m1509a(eVar.f2913a) && this.f2862a.f2913a.getParameters().getFlashMode().equals("torch");
    }

    public SurfaceHolder$CallbackC1596c getPreview() {
        return this.f2863b;
    }

    public Rect getQrDetectRect() {
        return this.f2884w;
    }

    public int getRotationCount() {
        return this.f2863b.getDisplayOrientation() / 90;
    }

    public int getScanRectEnd() {
        return (C1602f.m1505b((Activity) getContext()) / 2) + (getScanRectHeight() / 2);
    }

    public int getScanRectHeight() {
        return (int) (((float) C1602f.m1508a((Activity) getContext())) * 0.6666667f * 1.0f);
    }

    public int getScanRectTop() {
        return (C1602f.m1505b((Activity) getContext()) / 2) - (getScanRectHeight() / 2);
    }

    public AbstractC1603g getViewFinderView() {
        return this.f2867f;
    }

    @Override // android.hardware.SensorEventListener
    public void onAccuracyChanged(Sensor sensor, int i) {
    }

    @Override // android.hardware.SensorEventListener
    public void onSensorChanged(SensorEvent sensorEvent) {
        if (sensorEvent.sensor.getType() == 5) {
            float f = sensorEvent.values[0];
            AbstractC1604h hVar = this.f2865d;
            if (hVar != null) {
                hVar.mo1504a(f);
            }
        }
    }

    public void setAspectTolerance(float f) {
        this.f2883v = f;
    }

    public void setAutoFocus(boolean z) {
        this.f2869h = z;
        SurfaceHolder$CallbackC1596c cVar = this.f2863b;
        if (cVar != null) {
            cVar.setAutoFocus(z);
        }
    }

    public void setBorderAlpha(float f) {
        this.f2881t = f;
        this.f2867f.setBorderAlpha(this.f2881t);
        this.f2867f.mo1503a();
    }

    public void setBorderColor(int i) {
        this.f2874m = i;
        this.f2867f.setBorderColor(this.f2874m);
        this.f2867f.mo1503a();
    }

    public void setBorderCornerRadius(int i) {
        this.f2879r = i;
        this.f2867f.setBorderCornerRadius(this.f2879r);
        this.f2867f.mo1503a();
    }

    public void setBorderLineLength(int i) {
        this.f2877p = i;
        this.f2867f.setBorderLineLength(this.f2877p);
        this.f2867f.mo1503a();
    }

    public void setBorderStrokeWidth(int i) {
        this.f2876o = i;
        this.f2867f.setBorderStrokeWidth(this.f2876o);
        this.f2867f.mo1503a();
    }

    public void setDrawDetect(boolean z) {
        this.f2872k = z;
        this.f2867f.setDrawDetect(z);
        this.f2867f.mo1503a();
    }

    public void setFlash(boolean z) {
        String str;
        this.f2868g = Boolean.valueOf(z);
        C1601e eVar = this.f2862a;
        if (eVar != null && C1600d.m1509a(eVar.f2913a)) {
            Camera.Parameters parameters = this.f2862a.f2913a.getParameters();
            if (z) {
                if (!parameters.getFlashMode().equals("torch")) {
                    str = "torch";
                } else {
                    return;
                }
            } else if (!parameters.getFlashMode().equals("off")) {
                str = "off";
            } else {
                return;
            }
            parameters.setFlashMode(str);
            this.f2862a.f2913a.setParameters(parameters);
        }
    }

    public void setFlashButtonEnable(boolean z) {
        if (z) {
            this.f2865d = this;
        }
    }

    public void setIsBorderCornerRounded(boolean z) {
        this.f2878q = z;
        this.f2867f.setBorderCornerRounded(this.f2878q);
        this.f2867f.mo1503a();
    }

    public void setLaserColor(int i) {
        this.f2873l = i;
        this.f2867f.setLaserColor(this.f2873l);
        this.f2867f.mo1503a();
    }

    public void setLaserEnabled(boolean z) {
        this.f2871j = z;
        this.f2867f.setLaserEnabled(this.f2871j);
        this.f2867f.mo1503a();
    }

    public void setMaskColor(int i) {
        this.f2875n = i;
        this.f2867f.setMaskColor(this.f2875n);
        this.f2867f.mo1503a();
    }

    public void setOnLightChangedListener(AbstractC1604h hVar) {
        this.f2865d = hVar;
    }

    public void setShouldScaleToFill(boolean z) {
        this.f2870i = z;
    }

    public void setSquareViewFinder(boolean z) {
        this.f2880s = z;
        this.f2867f.setSquareViewFinder(this.f2880s);
        this.f2867f.mo1503a();
    }

    public void setupCameraPreview(C1601e eVar) {
        this.f2862a = eVar;
        C1601e eVar2 = this.f2862a;
        if (eVar2 != null) {
            setupLayout(eVar2);
            this.f2867f.mo1503a();
            Boolean bool = this.f2868g;
            if (bool != null) {
                setFlash(bool.booleanValue());
            }
            setAutoFocus(this.f2869h);
        }
    }

    public final void setupLayout(C1601e eVar) {
        RelativeLayout relativeLayout;
        removeAllViews();
        this.f2863b = new SurfaceHolder$CallbackC1596c(getContext(), eVar, this);
        this.f2863b.setAspectTolerance(this.f2883v);
        this.f2863b.setShouldScaleToFill(this.f2870i);
        if (!this.f2870i) {
            RelativeLayout relativeLayout2 = new RelativeLayout(getContext());
            relativeLayout2.setGravity(17);
            relativeLayout2.setBackgroundColor(-16777216);
            relativeLayout2.addView(this.f2863b);
            relativeLayout = relativeLayout2;
        } else {
            relativeLayout = this.f2863b;
        }
        addView(relativeLayout);
        AbstractC1603g gVar = this.f2867f;
        if (gVar instanceof View) {
            addView((View) gVar);
            this.f2885x = new ImageView(getContext());
            FrameLayout.LayoutParams layoutParams = new FrameLayout.LayoutParams(C1602f.m1506a(getContext(), 63.0f), C1602f.m1506a(getContext(), 63.0f));
            layoutParams.gravity = 17;
            this.f2885x.setVisibility(4);
            layoutParams.topMargin = (getScanRectHeight() / 3) - C1602f.m1506a(getContext(), 20.0f);
            this.f2885x.setImageResource(C2042R.C2043drawable.un_scan_flash_default_new);
            this.f2885x.setOnClickListener(new View.OnClickListener() { // from class: com.jd.lib.un.a.a.a.1
                @Override // android.view.View.OnClickListener
                public final void onClick(View view) {
                    TextView textView;
                    String str;
                    AbstractC1589a aVar = AbstractC1589a.this;
                    if (aVar.f2862a != null && C1600d.m1509a(aVar.f2862a.f2913a)) {
                        Camera.Parameters parameters = aVar.f2862a.f2913a.getParameters();
                        parameters.setFlashMode(parameters.getFlashMode().equals("torch") ? "off" : "torch");
                        aVar.f2862a.f2913a.setParameters(parameters);
                    }
                    if (AbstractC1589a.this.getFlash()) {
                        AbstractC1589a.this.f2885x.setImageResource(C2042R.C2043drawable.un_scan_flash_light_new);
                        textView = AbstractC1589a.this.f2887z;
                        str = "轻点关闭";
                    } else {
                        AbstractC1589a.this.f2885x.setImageResource(C2042R.C2043drawable.un_scan_flash_default_new);
                        textView = AbstractC1589a.this.f2887z;
                        str = "轻点开启";
                    }
                    textView.setText(str);
                }
            });
            addView(this.f2885x, layoutParams);
            this.f2885x.setVisibility(8);
            this.f2887z = new TextView(getContext());
            FrameLayout.LayoutParams layoutParams2 = new FrameLayout.LayoutParams(-2, -2);
            layoutParams2.gravity = 17;
            layoutParams2.topMargin = (getScanRectHeight() / 3) + C1602f.m1506a(getContext(), 20.0f);
            this.f2887z.setTextSize(16.0f);
            this.f2887z.setTextColor(-1);
            this.f2887z.setText("轻点开启");
            addView(this.f2887z, layoutParams2);
            this.f2887z.setVisibility(8);
            this.f2886y = new TextView(getContext());
            FrameLayout.LayoutParams layoutParams3 = new FrameLayout.LayoutParams(-2, -2);
            layoutParams3.gravity = 17;
            layoutParams3.topMargin = getScanRectHeight() / 3;
            this.f2886y.setTextSize(16.0f);
            this.f2886y.setTextColor(-1);
            this.f2886y.setText("扫描二维码");
            addView(this.f2886y, layoutParams3);
            return;
        }
        throw new IllegalArgumentException("IViewFinder object returned by 'createViewFinderView()' should be instance of android.view.View");
    }
}
