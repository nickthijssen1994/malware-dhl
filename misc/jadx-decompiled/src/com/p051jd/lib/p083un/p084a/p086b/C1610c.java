package com.p051jd.lib.p083un.p084a.p086b;

import android.animation.ValueAnimator;
import android.content.Context;
import android.graphics.Point;
import android.hardware.Camera;
import android.os.Handler;
import android.os.Looper;
import android.util.Log;
import android.view.Display;
import android.view.WindowManager;
import com.a.a.a;
import com.a.a.c;
import com.a.a.e;
import com.a.a.h;
import com.a.a.j;
import com.a.a.m;
import com.a.a.n;
import com.p051jd.lib.p083un.p084a.p085a.AbstractC1589a;
import com.p051jd.lib.p083un.p084a.p085a.C1602f;
import java.util.ArrayList;
import java.util.Collection;
import java.util.EnumMap;
import java.util.List;
import java.util.Map;

/* renamed from: com.jd.lib.un.a.b.c */
/* loaded from: classes.dex */
public final class C1610c extends AbstractC1589a {

    /* renamed from: f */
    public static final List<a> f2954f;

    /* renamed from: g */
    public AbstractC1612a f2955g;

    /* renamed from: h */
    private h f2956h;

    /* renamed from: i */
    private List<a> f2957i;

    /* renamed from: j */
    private int f2958j = 0;

    /* renamed from: k */
    private C1608a f2959k;

    /* renamed from: l */
    private ValueAnimator f2960l;

    /* renamed from: com.jd.lib.un.a.b.c$a */
    /* loaded from: classes.dex */
    public interface AbstractC1612a {
        /* renamed from: a */
        void mo853a(n nVar);
    }

    static {
        ArrayList arrayList = new ArrayList();
        f2954f = arrayList;
        arrayList.add(a.a);
        f2954f.add(a.b);
        f2954f.add(a.c);
        f2954f.add(a.d);
        f2954f.add(a.e);
        f2954f.add(a.f);
        f2954f.add(a.g);
        f2954f.add(a.h);
        f2954f.add(a.i);
        f2954f.add(a.j);
        f2954f.add(a.k);
        f2954f.add(a.l);
        f2954f.add(a.m);
        f2954f.add(a.n);
        f2954f.add(a.o);
        f2954f.add(a.p);
        f2954f.add(a.q);
    }

    public C1610c(Context context) {
        super(context);
        m1497a();
    }

    /* renamed from: a */
    private void m1497a() {
        EnumMap enumMap = new EnumMap(e.class);
        enumMap.put((EnumMap) e.c, (e) getFormats());
        this.f2956h = new h();
        this.f2956h.a(enumMap);
        this.f2959k = new C1608a();
    }

    /* renamed from: a */
    private static byte[] m1495a(byte[] bArr, int i, int i2) {
        int i3 = i * i2;
        int i4 = (i3 * 3) / 2;
        byte[] bArr2 = new byte[i4];
        int i5 = 0;
        for (int i6 = 0; i6 < i; i6++) {
            for (int i7 = i2 - 1; i7 >= 0; i7--) {
                bArr2[i5] = bArr[(i7 * i) + i6];
                i5++;
            }
        }
        int i8 = i4 - 1;
        int i9 = i - 1;
        while (i9 > 0) {
            for (int i10 = 0; i10 < i2 / 2; i10++) {
                int i11 = (i10 * i) + i3;
                bArr2[i8] = bArr[i11 + i9];
                int i12 = i8 - 1;
                bArr2[i12] = bArr[i11 + (i9 - 1)];
                i8 = i12 - 1;
            }
            i9 -= 2;
            i8 = i8;
        }
        return bArr2;
    }

    /* renamed from: b */
    private static j m1493b(byte[] bArr, int i, int i2) {
        try {
            return new j(bArr, i, i2, i, i2);
        } catch (Exception unused) {
            return null;
        }
    }

    public final Collection<a> getFormats() {
        List<a> list = this.f2957i;
        return list == null ? f2954f : list;
    }

    @Override // android.view.View, android.view.ViewGroup
    protected final void onDetachedFromWindow() {
        super.onDetachedFromWindow();
        ValueAnimator valueAnimator = this.f2960l;
        if (valueAnimator != null) {
            valueAnimator.cancel();
        }
    }

    @Override // android.widget.FrameLayout, android.view.View, android.view.ViewGroup
    protected final void onLayout(boolean z, int i, int i2, int i3, int i4) {
        super.onLayout(z, i, i2, i3, i4);
        C1608a aVar = this.f2959k;
        aVar.f2947a = i3 - i;
        aVar.f2948b = i4 - i2;
        aVar.m1499a();
    }

    @Override // android.hardware.Camera.PreviewCallback
    public final void onPreviewFrame(byte[] bArr, Camera camera) {
        h hVar;
        int rotationCount;
        if (this.f2955g != null) {
            try {
                Camera.Size previewSize = camera.getParameters().getPreviewSize();
                int i = previewSize.width;
                int i2 = previewSize.height;
                int i3 = previewSize.width;
                int i4 = previewSize.height;
                Display defaultDisplay = ((WindowManager) getContext().getSystemService("window")).getDefaultDisplay();
                Point point = new Point();
                defaultDisplay.getSize(point);
                boolean z = point.y > point.x;
                C1608a aVar = this.f2959k;
                aVar.f2949c = i3;
                aVar.f2950d = i4;
                if (z) {
                    int i5 = aVar.f2949c;
                    aVar.f2949c = aVar.f2950d;
                    aVar.f2950d = i5;
                }
                aVar.m1499a();
                if (C1602f.m1507a(getContext()) == 1 && ((rotationCount = getRotationCount()) == 1 || rotationCount == 3)) {
                    bArr = m1495a(bArr, i, i2);
                    i2 = i;
                    i = i2;
                }
                j b = m1493b(bArr, i, i2);
                final n nVar = null;
                if (b != null) {
                    c cVar = new c(new com.a.a.b.j(b));
                    try {
                        try {
                            try {
                                h hVar2 = this.f2956h;
                                if (hVar2.a == null) {
                                    hVar2.a((Map) null);
                                }
                                nVar = hVar2.a(cVar);
                                hVar = this.f2956h;
                            } catch (m unused) {
                                hVar = this.f2956h;
                            }
                        } catch (ArrayIndexOutOfBoundsException unused2) {
                            hVar = this.f2956h;
                        }
                    } catch (NullPointerException unused3) {
                        hVar = this.f2956h;
                    } catch (Throwable th) {
                        this.f2956h.a();
                        throw th;
                    }
                    hVar.a();
                }
                if (nVar != null) {
                    new Handler(Looper.getMainLooper()).post(new Runnable() { // from class: com.jd.lib.un.a.b.c.1
                        @Override // java.lang.Runnable
                        public final void run() {
                            AbstractC1612a aVar2 = C1610c.this.f2955g;
                            C1610c.this.f2955g = null;
                            C1610c cVar2 = C1610c.this;
                            if (cVar2.f2863b != null) {
                                cVar2.f2863b.m1516c();
                            }
                            if (aVar2 != null) {
                                aVar2.mo853a(nVar);
                            }
                        }
                    });
                } else {
                    camera.setOneShotPreviewCallback(this);
                }
            } catch (RuntimeException e) {
                Log.e("ZXingScannerView", e.toString(), e);
            }
        }
    }

    public final void setFormats(List<a> list) {
        this.f2957i = list;
        m1497a();
    }

    public final void setResultHandler(AbstractC1612a aVar) {
        this.f2955g = aVar;
    }
}
