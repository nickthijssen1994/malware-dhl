package com.huawei.hms.availableupdate;

import android.app.Activity;
import android.content.Intent;
import android.text.TextUtils;
import android.view.KeyEvent;
import com.huawei.hms.activity.BridgeActivity;
import com.huawei.hms.activity.IBridgeActivityDelegate;
import com.huawei.hms.android.SystemUtils;
import com.huawei.hms.common.util.AGCUtils;
import com.huawei.hms.support.hianalytics.HiAnalyticsConstant;
import com.huawei.hms.support.hianalytics.HiAnalyticsUtils;
import com.huawei.hms.support.log.HMSLog;
import com.huawei.hms.update.p021ui.UpdateBean;
import com.huawei.hms.utils.NetWorkUtil;
import com.huawei.hms.utils.PackageManagerHelper;
import java.lang.ref.WeakReference;
import java.util.ArrayList;
import java.util.HashMap;

/* compiled from: TbsSdkJava */
/* renamed from: com.huawei.hms.availableupdate.n */
/* loaded from: classes.dex */
public abstract class AbstractC0802n implements IBridgeActivityDelegate {

    /* renamed from: a */
    public WeakReference<Activity> f922a;

    /* renamed from: b */
    public IBridgeActivityDelegate f923b;

    /* renamed from: c */
    public UpdateBean f924c = null;

    /* renamed from: d */
    public AbstractC0803o f925d = null;

    /* renamed from: e */
    public boolean f926e = false;

    /* renamed from: f */
    public int f927f = -1;

    /* renamed from: g */
    public String f928g = null;

    /* renamed from: h */
    public String f929h = null;

    /* renamed from: i */
    public int f930i = 0;

    /* renamed from: a */
    public static String m4007a(int i) {
        if (i == 0) {
            return C0788e0.class.getName();
        }
        switch (i) {
            case 5:
                return C0817x.class.getName();
            case 6:
                return C0792f0.class.getName();
            case 7:
                return C0805p.class.getName();
            default:
                return "";
        }
    }

    /* renamed from: a */
    public void mo3981a(AbstractC0803o oVar) {
    }

    /* renamed from: a */
    public abstract void mo3980a(Class<? extends AbstractC0803o> cls);

    /* renamed from: b */
    public Activity m4001b() {
        WeakReference<Activity> weakReference = this.f922a;
        if (weakReference == null) {
            return null;
        }
        return weakReference.get();
    }

    /* renamed from: b */
    public void mo3979b(AbstractC0803o oVar) {
    }

    /* renamed from: c */
    public void m3999c(int i, int i2) {
        Activity b = m4001b();
        if (b != null && !b.isFinishing()) {
            m4006a(i, i2);
            Intent intent = new Intent();
            intent.putExtra(BridgeActivity.EXTRA_DELEGATE_CLASS_NAME, getClass().getName());
            intent.putExtra(BridgeActivity.EXTRA_RESULT, i);
            b.setResult(-1, intent);
            b.finish();
        }
    }

    @Override // com.huawei.hms.activity.IBridgeActivityDelegate
    public void onBridgeActivityCreate(Activity activity) {
        this.f922a = new WeakReference<>(activity);
        if (this.f924c == null) {
            Intent intent = activity.getIntent();
            if (intent != null) {
                this.f924c = (UpdateBean) intent.getSerializableExtra(BridgeActivity.EXTRA_DELEGATE_UPDATE_INFO);
                if (this.f924c == null) {
                    return;
                }
            } else {
                return;
            }
        }
        this.f928g = this.f924c.m3158b();
        this.f929h = this.f924c.getClientAppName();
        this.f930i = this.f924c.m3157c();
        this.f924c.m3160a();
        this.f923b = null;
        this.f926e = false;
        this.f927f = -1;
    }

    @Override // com.huawei.hms.activity.IBridgeActivityDelegate
    public void onBridgeActivityDestroy() {
        IBridgeActivityDelegate iBridgeActivityDelegate;
        this.f922a = null;
        m4008a();
        if (this.f926e && (iBridgeActivityDelegate = this.f923b) != null) {
            iBridgeActivityDelegate.onBridgeActivityDestroy();
        }
    }

    /* JADX WARN: Multi-variable type inference failed */
    @Override // com.huawei.hms.activity.IBridgeActivityDelegate
    public void onBridgeConfigurationChanged() {
        IBridgeActivityDelegate iBridgeActivityDelegate;
        if (!this.f926e || (iBridgeActivityDelegate = this.f923b) == null) {
            AbstractC0803o oVar = this.f925d;
            if (oVar != null) {
                Class<?> cls = oVar.getClass();
                this.f925d.m3995b();
                this.f925d = null;
                mo3980a((Class<? extends AbstractC0803o>) cls);
                return;
            }
            return;
        }
        iBridgeActivityDelegate.onBridgeConfigurationChanged();
    }

    @Override // com.huawei.hms.activity.IBridgeActivityDelegate
    public void onKeyUp(int i, KeyEvent keyEvent) {
        IBridgeActivityDelegate iBridgeActivityDelegate;
        if (this.f926e && (iBridgeActivityDelegate = this.f923b) != null) {
            iBridgeActivityDelegate.onKeyUp(i, keyEvent);
        }
    }

    /* renamed from: b */
    public final String m4000b(int i, int i2) {
        String valueOf = String.valueOf(i);
        if (i2 == 0) {
            return "0000" + valueOf;
        } else if (i2 == 5) {
            return "5000" + valueOf;
        } else if (i2 != 6) {
            return valueOf;
        } else {
            return "4000" + valueOf;
        }
    }

    /* renamed from: a */
    public void m4008a() {
        AbstractC0803o oVar = this.f925d;
        if (oVar != null) {
            try {
                oVar.m3995b();
                this.f925d = null;
            } catch (IllegalStateException e) {
                HMSLog.m3177e("AbsUpdateWizard", "In dismissDialog, Failed to dismiss the dialog." + e.getMessage());
            }
        }
    }

    /* renamed from: a */
    public void m4006a(int i, int i2) {
        if (!SystemUtils.isChinaROM()) {
            HMSLog.m3175i("AbsUpdateWizard", "not ChinaROM ");
            return;
        }
        Activity b = m4001b();
        if (b != null && !b.isFinishing()) {
            int packageVersionCode = new PackageManagerHelper(b).getPackageVersionCode(this.f928g);
            HashMap hashMap = new HashMap();
            hashMap.put("package", b.getPackageName());
            hashMap.put(HiAnalyticsConstant.BI_KEY_TARGET_PACKAGE, this.f928g);
            hashMap.put(HiAnalyticsConstant.BI_KEY_TARGET_VER, String.valueOf(packageVersionCode));
            hashMap.put(HiAnalyticsConstant.BI_KEY_SDK_VER, String.valueOf(50005300));
            hashMap.put(HiAnalyticsConstant.BI_KEY_APP_ID, AGCUtils.getAppId(b));
            hashMap.put(HiAnalyticsConstant.BI_KEY_TRIGGER_API, "core.connnect");
            hashMap.put(HiAnalyticsConstant.BI_KEY_UPDATE_TYPE, String.valueOf(i2));
            hashMap.put(HiAnalyticsConstant.BI_KEY_NET_TYPE, String.valueOf(NetWorkUtil.getNetworkType(b)));
            hashMap.put("result", m4000b(i, i2));
            HiAnalyticsUtils.getInstance().onEvent(b, HiAnalyticsConstant.BI_TYPE_UPDATE, hashMap);
        }
    }

    /* renamed from: a */
    public boolean m4002a(boolean z) {
        Activity b = m4001b();
        boolean z2 = false;
        if (b == null) {
            return false;
        }
        ArrayList typeList = this.f924c.getTypeList();
        if (typeList.size() > 0) {
            typeList.remove(0);
        }
        if (this.f923b == null) {
            m4003a(typeList);
        }
        if (this.f923b != null) {
            z2 = true;
            this.f926e = true;
            this.f924c.setTypeList(typeList);
            this.f924c.setNeedConfirm(z);
            IBridgeActivityDelegate iBridgeActivityDelegate = this.f923b;
            if (iBridgeActivityDelegate instanceof AbstractC0802n) {
                ((AbstractC0802n) iBridgeActivityDelegate).m4005a(this.f924c);
            }
            this.f923b.onBridgeActivityCreate(b);
        }
        return z2;
    }

    /* renamed from: a */
    public final void m4003a(ArrayList arrayList) {
        String a = (arrayList == null || arrayList.size() <= 0) ? null : m4007a(((Integer) arrayList.get(0)).intValue());
        if (a != null) {
            try {
                this.f923b = (IBridgeActivityDelegate) Class.forName(a).asSubclass(IBridgeActivityDelegate.class).newInstance();
            } catch (ClassCastException | ClassNotFoundException | IllegalAccessException | InstantiationException e) {
                HMSLog.m3177e("AbsUpdateWizard", "getBridgeActivityDelegate error" + e.getMessage());
            }
        }
    }

    /* renamed from: a */
    public final void m4005a(UpdateBean updateBean) {
        this.f924c = updateBean;
    }

    /* renamed from: a */
    public boolean m4004a(String str, int i) {
        Activity b;
        if (!TextUtils.isEmpty(str) && (b = m4001b()) != null && !b.isFinishing() && new PackageManagerHelper(b).getPackageVersionCode(str) >= i) {
            return true;
        }
        return false;
    }
}
