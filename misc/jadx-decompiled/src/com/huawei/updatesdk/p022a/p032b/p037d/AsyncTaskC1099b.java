package com.huawei.updatesdk.p022a.p032b.p037d;

import android.os.AsyncTask;
import android.text.TextUtils;
import android.util.Log;
import com.huawei.updatesdk.p022a.p023a.p024a.C1064b;
import com.huawei.updatesdk.p022a.p023a.p025b.p026a.p027a.C1069a;
import com.huawei.updatesdk.p022a.p023a.p028c.AbstractC1076g;
import com.huawei.updatesdk.p022a.p023a.p028c.p030i.C1083b;
import com.huawei.updatesdk.p022a.p032b.p033a.C1089a;
import com.huawei.updatesdk.p022a.p032b.p037d.p038c.AbstractC1100a;
import com.huawei.updatesdk.p022a.p032b.p037d.p038c.C1103c;
import com.huawei.updatesdk.p022a.p032b.p037d.p038c.C1104d;
import com.huawei.updatesdk.p039b.p046e.p047a.C1122a;
import com.huawei.updatesdk.p039b.p046e.p047a.C1123b;
import java.io.IOException;
import java.io.InterruptedIOException;
import java.net.ConnectException;
import java.net.SocketTimeoutException;
import java.util.concurrent.Executor;
import org.apache.http.conn.ConnectTimeoutException;
import org.json.JSONException;
import org.json.JSONObject;

/* compiled from: TbsSdkJava */
/* renamed from: com.huawei.updatesdk.a.b.d.b */
/* loaded from: classes.dex */
public class AsyncTaskC1099b extends AsyncTask<C1103c, Void, C1104d> {

    /* renamed from: a */
    protected C1103c f1758a;

    /* renamed from: c */
    private AbstractC1100a f1760c;

    /* renamed from: b */
    private C1104d f1759b = null;

    /* renamed from: d */
    private C1064b f1761d = null;

    /* renamed from: e */
    private int f1762e = 0;

    public AsyncTaskC1099b(C1103c cVar, AbstractC1100a aVar) {
        this.f1758a = null;
        this.f1760c = null;
        this.f1758a = cVar;
        this.f1760c = aVar;
    }

    /* renamed from: a */
    private C1104d m2743a(String str, String str2, C1104d dVar) {
        try {
            dVar.fromJson(new JSONObject(str2));
            dVar.m2718b(0);
        } catch (ClassNotFoundException | IllegalAccessException | InstantiationException | JSONException e) {
            C1069a.m2878a("StoreTask", "parse json error", e);
        }
        return dVar;
    }

    /* renamed from: a */
    private void m2746a(C1104d dVar, int i, C1104d.EnumC1105a aVar, Throwable th) {
        if (dVar != null) {
            dVar.m2718b(i);
            dVar.m2721a(aVar);
            dVar.m2720a(th.toString());
        }
    }

    /* renamed from: a */
    private void m2745a(C1104d dVar, Throwable th, String str) {
        C1104d.EnumC1105a aVar;
        int i = 1;
        if (th instanceof ConnectException) {
            aVar = C1104d.EnumC1105a.CONNECT_EXCEPTION;
        } else if ((th instanceof SocketTimeoutException) || (th instanceof ConnectTimeoutException)) {
            aVar = C1104d.EnumC1105a.CONNECT_EXCEPTION;
            i = 2;
        } else if (th instanceof IllegalArgumentException) {
            aVar = C1104d.EnumC1105a.PARAM_ERROR;
            i = 5;
        } else if (th instanceof IllegalAccessException) {
            aVar = C1104d.EnumC1105a.UNKNOWN_EXCEPTION;
        } else if (th instanceof ArrayIndexOutOfBoundsException) {
            aVar = C1104d.EnumC1105a.NO_PROGUARD;
            i = 6;
        } else {
            if ((th instanceof InterruptedException) || (th instanceof InterruptedIOException)) {
                m2746a(dVar, 0, C1104d.EnumC1105a.NORMAL, th);
                Log.e("StoreTask", "UpdateSDK task is canceled");
            } else if (th instanceof IOException) {
                aVar = C1104d.EnumC1105a.IO_EXCEPTION;
            } else if (dVar != null) {
                dVar.m2720a(th.toString());
            }
            m2742a(str, th);
        }
        m2746a(dVar, i, aVar, th);
        m2742a(str, th);
    }

    /* renamed from: a */
    private void m2742a(String str, Throwable th) {
        StringBuilder sb = new StringBuilder();
        sb.append("invoke store error");
        sb.append(", exceptionType:");
        sb.append(th.getClass().getName());
        sb.append(", url:");
        sb.append(str);
        sb.append(", method:");
        sb.append(this.f1758a.m2728b());
        sb.append(", retryTimes:" + this.f1762e);
        String sb2 = sb.toString();
        C1069a.m2878a("StoreTask", sb2, th);
        Log.e("StoreTask", "UpdateSDK call store error: " + sb2);
    }

    /* renamed from: a */
    private boolean m2744a(String str) {
        return TextUtils.isEmpty(str) || !AbstractC1076g.m2853d(str);
    }

    /* renamed from: b */
    private void m2737b(String str) {
        String str2;
        String str3;
        if (TextUtils.isEmpty(str)) {
            str2 = "StoreTask";
            str3 = "UpdateSDK response error, resData == null";
        } else {
            str2 = "StoreTask";
            str3 = "UpdateSDK response error, resData is not json string";
        }
        Log.e(str2, str3);
    }

    /* JADX WARN: Removed duplicated region for block: B:15:0x0044  */
    /* JADX WARN: Removed duplicated region for block: B:16:0x004c  */
    /* renamed from: c */
    /* Code decompiled incorrectly, please refer to instructions dump */
    private void m2735c(C1104d dVar) {
        C1104d.EnumC1105a aVar;
        StringBuilder sb;
        Throwable e;
        if (!isCancelled() && this.f1760c != null) {
            if (dVar == null) {
                C1069a.m2877b("StoreTask", "notifyResult, response is null");
                try {
                    dVar = C1098a.m2749a(this.f1758a.m2728b());
                } catch (IllegalAccessException e2) {
                    e = e2;
                    sb = new StringBuilder();
                    sb.append("notifyResult, create response error, method:");
                    sb.append(this.f1758a.m2728b());
                    C1069a.m2878a("StoreTask", sb.toString(), e);
                    if (dVar == null) {
                    }
                    dVar.m2721a(aVar);
                    dVar.m2718b(1);
                    this.f1760c.mo2522b(this.f1758a, dVar);
                } catch (InstantiationException e3) {
                    e = e3;
                    sb = new StringBuilder();
                    sb.append("notifyResult, create response error, method:");
                    sb.append(this.f1758a.m2728b());
                    C1069a.m2878a("StoreTask", sb.toString(), e);
                    if (dVar == null) {
                    }
                    dVar.m2721a(aVar);
                    dVar.m2718b(1);
                    this.f1760c.mo2522b(this.f1758a, dVar);
                }
                if (dVar == null) {
                    dVar = new C1104d();
                    aVar = C1104d.EnumC1105a.PARAM_ERROR;
                } else {
                    aVar = C1104d.EnumC1105a.UNKNOWN_EXCEPTION;
                }
                dVar.m2721a(aVar);
                dVar.m2718b(1);
            }
            this.f1760c.mo2522b(this.f1758a, dVar);
        }
    }

    /* renamed from: d */
    private boolean m2733d(C1104d dVar) {
        if (isCancelled()) {
            return false;
        }
        if (dVar.m2716d() != 1 && dVar.m2716d() != 2) {
            return false;
        }
        int i = this.f1762e;
        this.f1762e = i + 1;
        if (i >= 3) {
            C1069a.m2879a("StoreTask", "retry completed total times = " + this.f1762e + ",response.responseCode = " + dVar.m2716d());
            return false;
        }
        C1069a.m2879a("StoreTask", "retry times = " + this.f1762e + ",response.responseCode = " + dVar.m2716d());
        return true;
    }

    /* renamed from: e */
    private void m2732e() {
        m2735c(this.f1759b);
    }

    /* JADX WARN: Removed duplicated region for block: B:28:0x0105  */
    /* JADX WARN: Removed duplicated region for block: B:33:? A[RETURN, SYNTHETIC] */
    /* renamed from: a */
    /* Code decompiled incorrectly, please refer to instructions dump */
    protected C1104d m2748a() {
        C1104d dVar;
        Throwable th;
        try {
            dVar = C1098a.m2749a(this.f1758a.m2728b());
            try {
                if (!C1083b.m2800d(C1089a.m2785c().m2788a())) {
                    dVar.m2718b(3);
                    dVar.m2721a(C1104d.EnumC1105a.NO_NETWORK);
                } else {
                    String a = this.f1758a.m2731a();
                    String d = this.f1758a.m2724d();
                    C1069a.m2879a("StoreTask", "callStore, method:" + this.f1758a.m2728b() + ", url:" + d + ", body:" + a);
                    this.f1761d = new C1064b();
                    C1064b.C1065a a2 = this.f1761d.m2893a(d, a, "UTF-8", m2734d(), C1089a.m2785c().m2788a());
                    String b = a2.m2888b();
                    dVar.m2722a(a2.m2891a());
                    Log.i("StoreTask", "UpdateSDK call store responsecode: " + dVar.m2719b());
                    if (a2.m2891a() / 100 == 5) {
                        dVar.m2718b(0);
                        return dVar;
                    } else if (m2744a(b)) {
                        dVar.m2718b(1);
                        dVar.m2721a(C1104d.EnumC1105a.JSON_ERROR);
                        m2737b(b);
                    } else {
                        dVar = m2743a(a, b, dVar);
                        C1069a.m2879a("StoreTask", "callStore response, method:" + this.f1758a.m2728b() + ", url:" + d + ", body:" + a + ", Receive Json msg:" + dVar.toJson());
                    }
                }
            } catch (Throwable th2) {
                th = th2;
                m2745a(dVar, th, (String) null);
                if (dVar == null) {
                }
            }
        } catch (Throwable th3) {
            th = th3;
            dVar = null;
        }
        if (dVar == null) {
            return dVar;
        }
        C1104d dVar2 = new C1104d();
        dVar2.m2718b(5);
        dVar2.m2721a(C1104d.EnumC1105a.PARAM_ERROR);
        return dVar2;
    }

    /* renamed from: a */
    public C1104d doInBackground(C1103c... cVarArr) {
        C1069a.m2879a("StoreTask", "doInBackground, method:" + this.f1758a.m2728b());
        C1123b.m2658a(this);
        C1104d c = m2736c();
        AbstractC1100a aVar = this.f1760c;
        if (aVar != null) {
            aVar.mo2523a(this.f1758a, c);
        }
        return c;
    }

    /* renamed from: a */
    public void m2747a(C1104d dVar) {
    }

    /* renamed from: a */
    public final void m2741a(Executor executor) {
        executeOnExecutor(executor, this.f1758a);
    }

    /* renamed from: b */
    public void m2739b() {
        C1064b bVar = this.f1761d;
        if (bVar != null) {
            bVar.m2895a();
            this.f1761d = null;
        }
    }

    /* renamed from: b */
    public void onPostExecute(C1104d dVar) {
        C1069a.m2879a("StoreTask", "onPostExecute, method:" + this.f1758a.m2728b());
        C1123b.m2659a().remove(this);
        m2732e();
    }

    /* renamed from: c */
    public final C1104d m2736c() {
        C1104d dVar = null;
        do {
            if (this.f1762e > 0 && dVar != null) {
                C1069a.m2879a("StoreTask", "call store error! responseCode:" + dVar.m2716d() + ", retryTimes:" + this.f1762e);
            }
            dVar = m2748a();
            m2747a(dVar);
        } while (m2733d(dVar));
        this.f1759b = dVar;
        return this.f1759b;
    }

    /* renamed from: d */
    protected String m2734d() {
        String a = C1122a.m2661a();
        return TextUtils.isEmpty(a) ? "Android/1.0" : a;
    }
}
