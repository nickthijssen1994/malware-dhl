package com.jingdong.aura.core.p122b;

import android.os.Build;
import com.jingdong.aura.core.p121a.C2119a;
import com.jingdong.aura.core.p122b.p123a.AbstractC2128c;
import com.jingdong.aura.core.p122b.p124b.C2131b;
import com.jingdong.aura.core.p122b.p125c.AbstractC2139a;
import com.jingdong.aura.core.reflection.C2166b;
import com.jingdong.aura.core.runing.C2181k;
import com.jingdong.aura.core.util.p127a.AbstractC2197b;
import com.jingdong.aura.core.util.p127a.C2198c;
import dalvik.system.BaseDexClassLoader;
import java.io.File;
import java.io.IOException;
import java.lang.reflect.Method;
import java.net.URL;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Enumeration;
import java.util.HashSet;
import java.util.List;
import org.osgi.framework.BundleException;

/* compiled from: TbsSdkJava */
/* renamed from: com.jingdong.aura.core.b.f */
/* loaded from: classes.dex */
public final class C2151f extends BaseDexClassLoader implements AbstractC2128c {

    /* renamed from: d */
    private final AbstractC2139a f3949d;

    /* renamed from: e */
    private C2153h f3950e;

    /* renamed from: c */
    private static final AbstractC2197b f3948c = C2198c.m255a(C2151f.class);

    /* renamed from: b */
    private static final HashSet<String> f3947b = new HashSet<>();

    /* renamed from: a */
    private static final List<URL> f3946a = new ArrayList();

    static {
        f3947b.add("com.jingdong.aura.core.framework");
        f3947b.add("org.osgi.framework");
        f3947b.add("org.osgi.service.packageadmin");
        f3947b.add("org.osgi.service.startlevel");
    }

    public C2151f(C2153h hVar, String str) {
        super(".", null, str, Object.class.getClassLoader());
        if (Build.VERSION.SDK_INT >= 25) {
            try {
                Class<?> cls = Class.forName("com.android.internal.os.PathClassLoaderFactory");
                Method declaredMethod = cls.getDeclaredMethod("createClassloaderNamespace", ClassLoader.class, Integer.TYPE, String.class, String.class, Boolean.TYPE);
                declaredMethod.setAccessible(true);
                declaredMethod.invoke(cls, this, Integer.valueOf(C2181k.f4098a.getApplicationInfo().targetSdkVersion), str, str, true);
            } catch (Throwable unused) {
            }
        }
        this.f3950e = hVar;
        this.f3949d = hVar.m414b();
        if (this.f3949d == null) {
            throw new BundleException("Not Component valid bundle: " + hVar.m402n());
        }
    }

    @Override // com.jingdong.aura.core.p122b.p123a.AbstractC2128c
    /* renamed from: a */
    public C2153h mo427a() {
        return this.f3950e;
    }

    /* renamed from: a */
    public static void m426a(String str) {
        HashSet<String> hashSet = f3947b;
        if (hashSet != null) {
            hashSet.add(str);
        }
    }

    @Override // dalvik.system.BaseDexClassLoader, java.lang.ClassLoader
    protected Class<?> findClass(String str) {
        List<String> a;
        if (f3947b.contains(m421d(str))) {
            return C2131b.m583b().loadClass(str);
        }
        Class<?> b = m424b(str);
        if (b != null) {
            return b;
        }
        if (!(this.f3950e == null || (a = C2119a.m656a().m654a(this.f3950e.m402n())) == null || a.size() <= 0)) {
            for (int i = 0; i < a.size(); i++) {
                try {
                    C2153h a2 = C2131b.m590a(a.get(i));
                    if (a2 == null) {
                        continue;
                    } else {
                        try {
                            a2.m406j();
                        } catch (BundleException e) {
                            e.printStackTrace();
                        }
                        Class<?> loadClass = a2.m411e().loadClass(str);
                        if (loadClass != null) {
                            return loadClass;
                        }
                    }
                } catch (Exception unused) {
                }
            }
        }
        try {
            Class<?> loadClass2 = C2131b.m583b().loadClass(str);
            if (loadClass2 != null) {
                return loadClass2;
            }
            throw new ClassNotFoundException("Can't find class " + str + " in BundleClassLoader: " + this.f3950e.m402n());
        } catch (Exception e2) {
            throw new ClassNotFoundException("Can't find class " + str + " in BundleClassLoader: " + this.f3950e.m402n(), e2);
        }
    }

    /* renamed from: b */
    private Class<?> m424b(String str) {
        try {
            return this.f3949d.mo477a(str, this);
        } catch (ClassNotFoundException unused) {
            return null;
        }
    }

    @Override // dalvik.system.BaseDexClassLoader, java.lang.ClassLoader
    protected URL findResource(String str) {
        String c = m422c(str);
        List<URL> a = m425a(c, false);
        if (a.size() > 0) {
            return a.get(0);
        }
        List<URL> b = m423b(c, false);
        a.addAll(m423b(c, true));
        if (b.size() > 0) {
            return b.get(0);
        }
        return null;
    }

    @Override // dalvik.system.BaseDexClassLoader, java.lang.ClassLoader
    protected Enumeration<URL> findResources(String str) {
        return Collections.enumeration(m425a(m422c(str), true));
    }

    /* renamed from: a */
    private List<URL> m425a(String str, boolean z) {
        try {
            return this.f3949d.mo475b(str);
        } catch (IOException e) {
            e.printStackTrace();
            return f3946a;
        }
    }

    /* renamed from: b */
    private List<URL> m423b(String str, boolean z) {
        return f3946a;
    }

    @Override // dalvik.system.BaseDexClassLoader, java.lang.ClassLoader
    public String findLibrary(String str) {
        File a = this.f3949d.mo479a(System.mapLibraryName(str));
        if (a != null) {
            return a.getAbsolutePath();
        }
        try {
            return (String) C2166b.f4050o.m377a(C2131b.m583b(), str);
        } catch (Exception e) {
            f3948c.mo263a(e.getMessage(), e);
            return null;
        }
    }

    @Override // dalvik.system.BaseDexClassLoader, java.lang.Object
    public String toString() {
        return "BundleClassLoader[Bundle" + this.f3950e + "]";
    }

    /* renamed from: c */
    private static String m422c(String str) {
        return (str.startsWith("/") || str.startsWith("\\")) ? str.substring(1) : str;
    }

    /* renamed from: d */
    private static String m421d(String str) {
        int lastIndexOf = str.lastIndexOf(46);
        return lastIndexOf > -1 ? str.substring(0, lastIndexOf) : "";
    }
}
