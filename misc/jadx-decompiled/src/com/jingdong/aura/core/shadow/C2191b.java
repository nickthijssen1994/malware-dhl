package com.jingdong.aura.core.shadow;

import android.content.ComponentName;
import android.content.pm.ActivityInfo;
import android.content.pm.ApplicationInfo;
import android.content.pm.ComponentInfo;
import android.content.res.AssetManager;
import android.content.res.Resources;
import android.content.res.XmlResourceParser;
import android.os.Build;
import android.text.TextUtils;
import com.jingdong.aura.core.reflection.C2166b;
import com.jingdong.aura.core.reflection.Hack;
import com.jingdong.aura.core.runing.C2181k;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;

/* compiled from: TbsSdkJava */
/* renamed from: com.jingdong.aura.core.shadow.b */
/* loaded from: classes.dex */
public class C2191b {

    /* renamed from: a */
    private final HashMap<ComponentName, Object> f4117a = new HashMap<>();

    /* compiled from: TbsSdkJava */
    /* renamed from: com.jingdong.aura.core.shadow.b$a */
    /* loaded from: classes.dex */
    private static class C2192a {

        /* renamed from: a */
        private static C2191b f4118a = new C2191b();
    }

    /* renamed from: a */
    public static C2191b m288a() {
        return C2192a.f4118a;
    }

    /* renamed from: a */
    public <T extends ComponentInfo> T m287a(ComponentName componentName, Class<T> cls) {
        Object obj = this.f4117a.get(componentName);
        if (obj == null) {
            return null;
        }
        try {
            return (T) ((ComponentInfo) obj.getClass().getField("info").get(obj));
        } catch (IllegalAccessException e) {
            e.printStackTrace();
            return null;
        } catch (NoSuchFieldException e2) {
            e2.printStackTrace();
            return null;
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:22:0x0056 A[RETURN] */
    /* JADX WARN: Removed duplicated region for block: B:23:0x0057  */
    /* JADX WARN: Removed duplicated region for block: B:48:0x01cb  */
    /* renamed from: a */
    /* Code decompiled incorrectly, please refer to instructions dump */
    public void m285a(AssetManager assetManager, int i, String str) {
        XmlResourceParser xmlResourceParser;
        Exception e;
        Object obj;
        Resources resources;
        XmlResourceParser openXmlResourceParser;
        XmlResourceParser xmlResourceParser2 = null;
        r0 = null;
        Object obj2 = null;
        try {
            if (Build.VERSION.SDK_INT <= 20) {
                obj = C2166b.f4030ah.m384a(str);
            } else {
                obj = C2166b.f4030ah.m384a(new Object[0]);
            }
            resources = new Resources(assetManager, C2181k.f4101d.getDisplayMetrics(), C2181k.f4101d.getConfiguration());
            openXmlResourceParser = assetManager.openXmlResourceParser(i, "AndroidManifest.xml");
        } catch (Exception e2) {
            e = e2;
            xmlResourceParser = null;
        } catch (Throwable th) {
            th = th;
        }
        try {
            obj2 = m284a(obj, resources, openXmlResourceParser);
            if (openXmlResourceParser != null) {
                openXmlResourceParser.close();
            }
        } catch (Exception e3) {
            e = e3;
            xmlResourceParser = openXmlResourceParser;
            try {
                e.printStackTrace();
                if (xmlResourceParser != null) {
                    xmlResourceParser.close();
                }
                if (obj2 == null) {
                }
            } catch (Throwable th2) {
                th = th2;
                xmlResourceParser2 = xmlResourceParser;
                if (xmlResourceParser2 != null) {
                    xmlResourceParser2.close();
                }
                throw th;
            }
        } catch (Throwable th3) {
            th = th3;
            xmlResourceParser2 = openXmlResourceParser;
            if (xmlResourceParser2 != null) {
            }
            throw th;
        }
        if (obj2 == null) {
            C2166b.f4025ac.m379a((Hack.C2161d<Object, String>) obj2, C2181k.f4098a.getPackageName());
            ApplicationInfo a = C2166b.f4027ae.m381a((Hack.C2161d<Object, ApplicationInfo>) obj2);
            a.name = C2181k.f4098a.getApplicationInfo().name;
            a.className = C2181k.f4098a.getApplicationInfo().className;
            a.taskAffinity = C2181k.f4098a.getApplicationInfo().taskAffinity;
            a.permission = C2181k.f4098a.getApplicationInfo().permission;
            a.processName = C2181k.f4098a.getApplicationInfo().processName;
            a.theme = C2181k.f4098a.getApplicationInfo().theme;
            a.flags = C2181k.f4098a.getApplicationInfo().flags;
            a.uiOptions = C2181k.f4098a.getApplicationInfo().uiOptions;
            a.backupAgentName = C2181k.f4098a.getApplicationInfo().backupAgentName;
            a.descriptionRes = C2181k.f4098a.getApplicationInfo().descriptionRes;
            a.targetSdkVersion = C2181k.f4098a.getApplicationInfo().targetSdkVersion;
            a.compatibleWidthLimitDp = C2181k.f4098a.getApplicationInfo().compatibleWidthLimitDp;
            a.uid = C2181k.f4098a.getApplicationInfo().uid;
            a.largestWidthLimitDp = C2181k.f4098a.getApplicationInfo().largestWidthLimitDp;
            a.enabled = C2181k.f4098a.getApplicationInfo().enabled;
            a.requiresSmallestWidthDp = C2181k.f4098a.getApplicationInfo().requiresSmallestWidthDp;
            a.packageName = C2181k.f4098a.getApplicationInfo().packageName;
            ArrayList<Object> a2 = C2166b.f4026ad.m381a((Hack.C2161d<Object, ArrayList<Object>>) obj2);
            if (a2 != null) {
                Iterator<Object> it = a2.iterator();
                while (it.hasNext()) {
                    Object next = it.next();
                    try {
                        ActivityInfo activityInfo = (ActivityInfo) next.getClass().getField("info").get(next);
                        if (activityInfo.targetActivity != null || activityInfo.taskAffinity.equals(activityInfo.packageName)) {
                            activityInfo.taskAffinity = C2181k.f4098a.getApplicationInfo().taskAffinity;
                        }
                        activityInfo.processName = TextUtils.isEmpty(activityInfo.processName) ? C2181k.f4098a.getPackageName() : activityInfo.processName;
                        if (activityInfo.processName.startsWith(activityInfo.packageName + ":")) {
                            activityInfo.processName = C2181k.f4098a.getApplicationInfo().packageName + activityInfo.processName.substring(activityInfo.packageName.length());
                        }
                        activityInfo.packageName = C2181k.f4098a.getApplicationInfo().packageName;
                        m286a((ComponentName) C2166b.f4029ag.m377a(next, new Object[0]), next);
                    } catch (Exception e4) {
                        e4.printStackTrace();
                    }
                }
            }
        }
    }

    /* renamed from: a */
    private Object m284a(Object obj, Resources resources, XmlResourceParser xmlResourceParser) {
        String[] strArr = new String[1];
        try {
            if (Build.VERSION.SDK_INT >= 26) {
                return C2166b.f4019X.m387a("parseBaseApk", String.class, Resources.class, XmlResourceParser.class, Integer.TYPE, String[].class).m377a(obj, C2181k.f4098a.getPackageName(), resources, xmlResourceParser, 0, strArr);
            }
            if (Build.VERSION.SDK_INT > 20) {
                return C2166b.f4019X.m387a("parseBaseApk", Resources.class, XmlResourceParser.class, Integer.TYPE, String[].class).m377a(obj, resources, xmlResourceParser, 0, strArr);
            }
            try {
                return C2166b.f4019X.m387a("parsePackage", Resources.class, XmlResourceParser.class, Integer.TYPE, String[].class).m377a(obj, resources, xmlResourceParser, 0, strArr);
            } catch (Hack.HackDeclaration.HackAssertionException unused) {
                return C2166b.f4019X.m387a("parsePackage", Resources.class, XmlResourceParser.class, Integer.TYPE, Boolean.TYPE, String[].class).m377a(obj, resources, xmlResourceParser, 0, false, strArr);
            }
        } catch (Throwable th) {
            if ((C2181k.f4098a.getApplicationInfo().flags & 2) == 0) {
                return null;
            }
            throw new RuntimeException(th);
        }
    }

    /* renamed from: a */
    private void m286a(ComponentName componentName, Object obj) {
        this.f4117a.put(componentName, obj);
    }
}
