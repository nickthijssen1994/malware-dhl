{
  "inputs": [
    {
      "name": "input_buffer",
      "type": "bufferFloat"
    },
    {
      "name": "input_image",
      "type": "image"
    },
    {
      "name": "texture",
      "type": "image"
    }
  ],
  "name": "ColoredLights3",
  "outputs": [
    {
      "name": "output_image",
      "type": "image",
      "value": "cache.value"
    }
  ],
  "params": [{
    "min_max": [
      0,
      360
    ],
    "name": "hue",
    "type": "int",
    "value": 0
  }
  ],
  "patches": [
    {
      "name": "fade",
      "param": {
        "value": 0
      }
    }
  ],
  "graph": {
    "sourceShape": {
      "kernel": "ShapeOf",
      "inputs": {
        "input":"inputs:input_image.value"
      }
    },
    "newSize": {
      "kernel": "AspectFitByArea",
      "inputs": {
        "size": "sourceShape.size",
        "area": {
          "value": 2100000
        },
        "skip_condition": {
          "value": 0
        }
      }
    },
    "resizedSource": {
      "kernel": "Resize",
      "inputs": {
        "input": "inputs:input_image.value",
        "dimensions": "newSize.output"
      }
    },
    "grayscaleSource": {
      "kernel": "Gray8",
      "inputs": {
        "image": "resizedSource.output"
      }
    },
    "bilateralPacked": {
      "kernel": "BilateralFilterPacked",
      "inputs": {
        "input": "grayscaleSource.output",
        "d": {
          "value": 19
        },
        "sigma_space": {
          "value": 170
        },
        "sigma_color": {
          "value": 170
        }
      }
    },
    "bilateral": {
      "kernel": "BilateralFilterUnpack",
      "inputs": {
        "input": "bilateralPacked.packed_output"
      }
    },
    "displacementMap": {
      "kernel": "DisplacementMap",
      "inputs": {
        "input": "bilateral.output",
        "amount": {
          "value": 0.028
        }
      }
    },
    "emptyColor": {
      "kernel": "ARGB_8888",
      "set-inputs": {
        "value": [
          0,
          0,
          0,
          0
        ]
      }
    },
    "emptyImage": {
      "kernel": "SolidColor",
      "inputs": {
        "color": "emptyColor.value",
        "size": "sourceShape.size"
      }
    },
    "idle": {
      "kernel": "Idle",
      "inputs": {
        "image": "emptyImage.output"
      }
    },
    "mesh": {
      "inputs": {
        "input": "idle.output",
        "image": "inputs:texture.value",
        "model_matrix": "inputs:input_buffer.value",
        "disable_culling": {
          "value": 1
        }
      },
      "kernel": "TempMesh"
    },
    "resizedTexture": {
      "kernel": "Resize",
      "inputs": {
        "input": "mesh.output",
        "dimensions": "newSize.output"
      }
    },
    "displaced": {
      "kernel": "Morphing",
      "inputs": {
        "input": "resizedTexture.output",
        "coordsImage": "displacementMap.output"
      }
    },
    "resizedDisplaced": {
      "kernel": "Resize",
      "inputs": {
        "input": "displaced.output",
        "dimensions": "sourceShape.size"
      }
    },
    "displaced_cache" : {
      "kernel" : "Image",
      "inputs" : {
        "value" : "resizedDisplaced.output"
      }
    },
    "cast_amount": {
      "inputs": {
        "input": "params:hue.value"
      },
      "kernel": "Cast"
    },
    "effect": {
      "inputs": {
        "hueAdjust": "cast_amount.output",
        "input": "displaced_cache.value"
      },
      "kernel": "HueEffect"
    },
    "unPremultDisplaced": {
      "kernel": "Unpremultiply",
      "inputs": {
        "input": "effect.output"
      }
    },
    "blend1": {
      "kernel": "PSBlend",
      "inputs": {
        "top": "unPremultDisplaced.output",
        "bottom": "inputs:input_image.value",
        "blend_mode": {
          "value": 13
        }
      }
    },
    "alphaBlended": {
      "kernel": "CopySourceAlpha",
      "inputs": {
        "source": "unPremultDisplaced.output",
        "destination": "blend1.output"
      }
    },
    "output_image": {
      "kernel": "PSBlend",
      "inputs": {
        "top": "alphaBlended.output",
        "bottom": "blend1.output",
        "blend_mode": {
          "value": 25
        }
      }
    },
    "cache" : {
      "kernel": "Image",
      "inputs": {
        "value": "output_image.output"
      }
    }
  },
  "targets": [
    "photo"
  ]
}