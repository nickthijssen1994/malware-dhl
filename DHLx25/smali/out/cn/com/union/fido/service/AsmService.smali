.class public Lcn/com/union/fido/service/AsmService;
.super Ljava/lang/Object;

# interfaces
.implements Lcn/com/union/fido/bean/asm/AsmStatusCode;


# static fields
.field static final MSG_SAY_HELLO:I = 0x1

.field private static final TAG:Ljava/lang/String; = "AsmService"


# instance fields
.field private authDBManager:Lcn/com/union/fido/db/AuthenticationManager;

.field private mAuthenticateService:Lcn/com/union/fido/service/AuthenticatorService;

.field mContext:Landroid/content/Context;


# direct methods
.method public constructor <init>()V
    .registers 2

    invoke-direct {p0}, Ljava/lang/Object;-><init>()V

    new-instance v0, Lcn/com/union/fido/service/AuthenticatorService;

    invoke-direct {v0}, Lcn/com/union/fido/service/AuthenticatorService;-><init>()V

    iput-object v0, p0, Lcn/com/union/fido/service/AsmService;->mAuthenticateService:Lcn/com/union/fido/service/AuthenticatorService;

    return-void
.end method

.method public constructor <init>(Landroid/content/Context;)V
    .registers 3

    invoke-direct {p0}, Ljava/lang/Object;-><init>()V

    iput-object p1, p0, Lcn/com/union/fido/service/AsmService;->mContext:Landroid/content/Context;

    new-instance v0, Lcn/com/union/fido/service/AuthenticatorService;

    invoke-direct {v0, p1}, Lcn/com/union/fido/service/AuthenticatorService;-><init>(Landroid/content/Context;)V

    iput-object v0, p0, Lcn/com/union/fido/service/AsmService;->mAuthenticateService:Lcn/com/union/fido/service/AuthenticatorService;

    new-instance v0, Lcn/com/union/fido/db/AuthenticationManager;

    invoke-virtual {p1}, Landroid/content/Context;->getApplicationContext()Landroid/content/Context;

    move-result-object p1

    invoke-direct {v0, p1}, Lcn/com/union/fido/db/AuthenticationManager;-><init>(Landroid/content/Context;)V

    iput-object v0, p0, Lcn/com/union/fido/service/AsmService;->authDBManager:Lcn/com/union/fido/db/AuthenticationManager;

    return-void
.end method

.method private authenticateRequest(Lcn/com/union/fido/bean/asm/ASMRequest;)Lcn/com/union/fido/bean/asm/ASMResponse;
    .registers 11

    new-instance v0, Lcn/com/union/fido/bean/asm/ASMResponse;

    invoke-direct {v0}, Lcn/com/union/fido/bean/asm/ASMResponse;-><init>()V

    iget-object v1, p1, Lcn/com/union/fido/bean/asm/ASMRequest;->authenticatorIndex:Ljava/lang/Short;

    invoke-virtual {v1}, Ljava/lang/Short;->shortValue()S

    move-result v1

    invoke-static {v1}, Lcn/com/union/fido/common/GlobalConfiguration;->locateAuthenticator(S)Lcn/com/union/fido/bean/asm/AuthenticatorInfo;

    move-result-object v1

    const/4 v2, 0x1

    if-nez v1, :cond_16

    iput-short v2, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    goto/16 :goto_12d

    :cond_16
    invoke-virtual {p1}, Lcn/com/union/fido/bean/asm/ASMRequest;->getArgs()Ljava/lang/Object;

    move-result-object v3

    move-object v4, v3

    check-cast v4, Lcn/com/union/fido/bean/asm/AuthenticateIn;

    invoke-virtual {p1}, Lcn/com/union/fido/bean/asm/ASMRequest;->getExts()Ljava/util/List;

    move-result-object v8

    iget-object p1, v4, Lcn/com/union/fido/bean/asm/AuthenticateIn;->appID:Ljava/lang/String;

    iget-object v3, p0, Lcn/com/union/fido/service/AsmService;->mContext:Landroid/content/Context;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    invoke-static {v3, v5}, Lcn/com/union/fido/util/UAFTools;->getCallerID(Landroid/content/Context;I)Ljava/lang/String;

    move-result-object v3

    const/4 v5, 0x0

    invoke-static {p1, v5, v5, v3, v2}, Lcn/com/union/fido/util/UAFTools;->genKHAccessToken(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)Ljava/lang/String;

    move-result-object v5

    iget-object v2, v4, Lcn/com/union/fido/bean/asm/AuthenticateIn;->keyIDs:Ljava/util/List;

    invoke-static {v2}, Lcn/com/union/fido/util/CommonTools;->isValidateList(Ljava/util/List;)Z

    move-result v3

    if-nez v3, :cond_40

    iget-boolean p1, v1, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->isSecondFactorOnly:Z

    if-eqz p1, :cond_12d

    goto/16 :goto_12a

    :cond_40
    new-instance v6, Ljava/util/ArrayList;

    invoke-direct {v6}, Ljava/util/ArrayList;-><init>()V

    iget-boolean v3, v1, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->isRoamingAuthenticator:Z

    if-nez v3, :cond_6f

    invoke-interface {v2}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v2

    :cond_4d
    :goto_4d
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_89

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    iget-object v7, p0, Lcn/com/union/fido/service/AsmService;->authDBManager:Lcn/com/union/fido/db/AuthenticationManager;

    invoke-virtual {v7, p1, v3}, Lcn/com/union/fido/db/AuthenticationManager;->getEntity(Ljava/lang/String;Ljava/lang/String;)Lcn/com/union/fido/bean/db/AuthenticationEntity;

    move-result-object v3

    if-eqz v3, :cond_4d

    invoke-virtual {v3}, Lcn/com/union/fido/bean/db/AuthenticationEntity;->getKeyHandle()Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Lcn/com/union/fido/util/StringTools;->isValidateString(Ljava/lang/String;)Z

    move-result v7

    if-eqz v7, :cond_4d

    invoke-interface {v6, v3}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    goto :goto_4d

    :cond_6f
    invoke-interface {v2}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object p1

    :cond_73
    :goto_73
    invoke-interface {p1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_89

    invoke-interface {p1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/lang/String;

    invoke-static {v2}, Lcn/com/union/fido/util/StringTools;->isValidateString(Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_73

    invoke-interface {v6, v2}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    goto :goto_73

    :cond_89
    invoke-static {v6}, Lcn/com/union/fido/util/CommonTools;->isValidateList(Ljava/util/List;)Z

    move-result p1

    if-eqz p1, :cond_12a

    new-instance p1, Lcn/com/union/fido/bean/asm/AuthenticateOut;

    invoke-direct {p1}, Lcn/com/union/fido/bean/asm/AuthenticateOut;-><init>()V

    iget-object v2, v1, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->assertionScheme:Ljava/lang/String;

    iput-object v2, p1, Lcn/com/union/fido/bean/asm/AuthenticateOut;->assertionScheme:Ljava/lang/String;

    const/4 v7, 0x0

    move-object v2, p0

    move-object v3, v1

    invoke-direct/range {v2 .. v8}, Lcn/com/union/fido/service/AsmService;->triggerSignCommand(Lcn/com/union/fido/bean/asm/AuthenticatorInfo;Lcn/com/union/fido/bean/asm/AuthenticateIn;Ljava/lang/String;Ljava/util/List;Ljava/lang/String;Ljava/util/List;)Lcn/com/union/fido/bean/authenticator/command/SignResponse;

    move-result-object v2

    iget-short v3, v2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->statusCode:S

    const/4 v4, 0x5

    if-nez v3, :cond_c3

    iget-object v3, v2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->userNameAndKeyHandle:Ljava/util/List;

    iget-boolean v1, v1, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->isSecondFactorOnly:Z

    if-nez v1, :cond_b4

    invoke-static {v3}, Lcn/com/union/fido/util/CommonTools;->isValidateList(Ljava/util/List;)Z

    move-result v1

    if-eqz v1, :cond_b4

    :goto_b0
    iput-short v4, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    goto/16 :goto_12d

    :cond_b4
    iget-object v1, v2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->assertion:[B

    invoke-static {v1}, Lcn/com/union/fido/util/StringTools;->urlSafeBase64Enc([B)Ljava/lang/String;

    move-result-object v1

    iput-object v1, p1, Lcn/com/union/fido/bean/asm/AuthenticateOut;->assertion:Ljava/lang/String;

    const/4 v1, 0x0

    iput-short v1, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    iput-object p1, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->responseData:Ljava/lang/Object;

    goto/16 :goto_12d

    :cond_c3
    iget-short p1, v2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->statusCode:S

    if-ne p1, v4, :cond_ca

    const/4 p1, 0x3

    goto/16 :goto_12b

    :cond_ca
    iget-short p1, v2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->statusCode:S

    const/16 v1, 0x8

    if-ne p1, v1, :cond_d2

    const/4 p1, 0x4

    goto :goto_12b

    :cond_d2
    iget-short p1, v2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->statusCode:S

    const/16 v1, 0x10

    if-ne p1, v1, :cond_da

    const/4 p1, 0x6

    goto :goto_12b

    :cond_da
    iget-short p1, v2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->statusCode:S

    const/16 v3, 0x13

    if-ne p1, v3, :cond_e3

    const/16 p1, 0x9

    goto :goto_12b

    :cond_e3
    iget-short p1, v2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->statusCode:S

    const/16 v4, 0x14

    if-ne p1, v4, :cond_ec

    :goto_e9
    iput-short v1, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    goto :goto_12d

    :cond_ec
    iget-short p1, v2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->statusCode:S

    const/16 v1, 0x15

    if-ne p1, v1, :cond_f5

    const/16 p1, 0x11

    goto :goto_12b

    :cond_f5
    iget-short p1, v2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->statusCode:S

    const/16 v5, 0x16

    if-ne p1, v5, :cond_fe

    const/16 p1, 0x12

    goto :goto_12b

    :cond_fe
    iget-short p1, v2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->statusCode:S

    const/16 v6, 0x17

    if-ne p1, v6, :cond_107

    iput-short v3, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    goto :goto_12d

    :cond_107
    iget-short p1, v2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->statusCode:S

    const/16 v3, 0x18

    if-ne p1, v3, :cond_10e

    goto :goto_b0

    :cond_10e
    iget-short p1, v2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->statusCode:S

    const/16 v3, 0x19

    if-ne p1, v3, :cond_115

    goto :goto_e9

    :cond_115
    iget-short p1, v2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->statusCode:S

    const/16 v1, 0x20

    if-ne p1, v1, :cond_11e

    iput-short v5, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    goto :goto_12d

    :cond_11e
    iget-short p1, v2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->statusCode:S

    const/16 v1, 0x21

    if-ne p1, v1, :cond_127

    iput-short v6, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    goto :goto_12d

    :cond_127
    iget-short p1, v2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->statusCode:S

    goto :goto_12b

    :cond_12a
    :goto_12a
    const/4 p1, 0x2

    :goto_12b
    iput-short p1, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    :cond_12d
    :goto_12d
    return-object v0
.end method

.method private commitInRequest(Lcn/com/union/fido/bean/asm/ASMRequest;)V
    .registers 6

    invoke-virtual {p1}, Lcn/com/union/fido/bean/asm/ASMRequest;->getArgs()Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcn/com/union/fido/bean/asm/CommitIn;

    new-instance v0, Lcn/com/union/fido/bean/db/AuthenticationEntity;

    iget-object v1, p1, Lcn/com/union/fido/bean/asm/CommitIn;->aaid:Ljava/lang/String;

    iget-object v2, p1, Lcn/com/union/fido/bean/asm/CommitIn;->keyID:Ljava/lang/String;

    const-string v3, "ready"

    invoke-direct {v0, v1, v2, v3}, Lcn/com/union/fido/bean/db/AuthenticationEntity;-><init>(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V

    iget-boolean v1, p1, Lcn/com/union/fido/bean/asm/CommitIn;->commit:Z

    if-eqz v1, :cond_1b

    iget-object p1, p0, Lcn/com/union/fido/service/AsmService;->authDBManager:Lcn/com/union/fido/db/AuthenticationManager;

    invoke-virtual {p1, v0}, Lcn/com/union/fido/db/AuthenticationManager;->updateStatus(Lcn/com/union/fido/bean/db/AuthenticationEntity;)V

    return-void

    :cond_1b
    iget-object v0, p0, Lcn/com/union/fido/service/AsmService;->authDBManager:Lcn/com/union/fido/db/AuthenticationManager;

    iget-object v1, p1, Lcn/com/union/fido/bean/asm/CommitIn;->aaid:Ljava/lang/String;

    iget-object p1, p1, Lcn/com/union/fido/bean/asm/CommitIn;->keyID:Ljava/lang/String;

    invoke-virtual {v0, v1, p1}, Lcn/com/union/fido/db/AuthenticationManager;->delEntityByAaid(Ljava/lang/String;Ljava/lang/String;)I

    return-void
.end method

.method private deregisterRequest(Lcn/com/union/fido/bean/asm/ASMRequest;)Lcn/com/union/fido/bean/asm/ASMResponse;
    .registers 11

    new-instance v0, Lcn/com/union/fido/bean/asm/ASMResponse;

    invoke-direct {v0}, Lcn/com/union/fido/bean/asm/ASMResponse;-><init>()V

    iget-object v1, p1, Lcn/com/union/fido/bean/asm/ASMRequest;->authenticatorIndex:Ljava/lang/Short;

    invoke-virtual {v1}, Ljava/lang/Short;->shortValue()S

    move-result v1

    invoke-static {v1}, Lcn/com/union/fido/common/GlobalConfiguration;->locateAuthenticator(S)Lcn/com/union/fido/bean/asm/AuthenticatorInfo;

    move-result-object v2

    const/4 v3, 0x1

    if-eqz v2, :cond_7e

    invoke-virtual {p1}, Lcn/com/union/fido/bean/asm/ASMRequest;->getArgs()Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcn/com/union/fido/bean/asm/DeregisterIn;

    iget-object v4, p1, Lcn/com/union/fido/bean/asm/DeregisterIn;->appID:Ljava/lang/String;

    iget-object v5, p0, Lcn/com/union/fido/service/AsmService;->mContext:Landroid/content/Context;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    invoke-static {v5, v6}, Lcn/com/union/fido/util/UAFTools;->getCallerID(Landroid/content/Context;I)Ljava/lang/String;

    move-result-object v5

    const/4 v6, 0x0

    invoke-static {v4, v6, v6, v5, v3}, Lcn/com/union/fido/util/UAFTools;->genKHAccessToken(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)Ljava/lang/String;

    move-result-object v5

    iget-boolean v2, v2, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->isRoamingAuthenticator:Z

    if-nez v2, :cond_47

    iget-object v2, p0, Lcn/com/union/fido/service/AsmService;->authDBManager:Lcn/com/union/fido/db/AuthenticationManager;

    iget-object v7, p1, Lcn/com/union/fido/bean/asm/DeregisterIn;->appID:Ljava/lang/String;

    iget-object v8, p1, Lcn/com/union/fido/bean/asm/DeregisterIn;->keyID:Ljava/lang/String;

    invoke-virtual {v2, v7, v8}, Lcn/com/union/fido/db/AuthenticationManager;->getEntity(Ljava/lang/String;Ljava/lang/String;)Lcn/com/union/fido/bean/db/AuthenticationEntity;

    move-result-object v2

    if-eqz v2, :cond_3e

    invoke-virtual {v2}, Lcn/com/union/fido/bean/db/AuthenticationEntity;->getUserName()Ljava/lang/String;

    move-result-object v2

    move-object v6, v2

    :cond_3e
    iget-object v2, p0, Lcn/com/union/fido/service/AsmService;->authDBManager:Lcn/com/union/fido/db/AuthenticationManager;

    iget-object v7, p1, Lcn/com/union/fido/bean/asm/DeregisterIn;->appID:Ljava/lang/String;

    iget-object v8, p1, Lcn/com/union/fido/bean/asm/DeregisterIn;->keyID:Ljava/lang/String;

    invoke-virtual {v2, v7, v8}, Lcn/com/union/fido/db/AuthenticationManager;->delEntityByAppID(Ljava/lang/String;Ljava/lang/String;)I

    :cond_47
    new-instance v2, Lcn/com/union/fido/bean/authenticator/command/DeregisterCommand;

    invoke-direct {v2}, Lcn/com/union/fido/bean/authenticator/command/DeregisterCommand;-><init>()V

    int-to-byte v1, v1

    iput-byte v1, v2, Lcn/com/union/fido/bean/authenticator/command/DeregisterCommand;->authenticatorIndex:B

    iput-object v4, v2, Lcn/com/union/fido/bean/authenticator/command/DeregisterCommand;->appID:Ljava/lang/String;

    iput-object v5, v2, Lcn/com/union/fido/bean/authenticator/command/DeregisterCommand;->khAccessToken:Ljava/lang/String;

    iget-object p1, p1, Lcn/com/union/fido/bean/asm/DeregisterIn;->keyID:Ljava/lang/String;

    iput-object p1, v2, Lcn/com/union/fido/bean/authenticator/command/DeregisterCommand;->keyID:Ljava/lang/String;

    if-eqz v6, :cond_5b

    iput-object v6, v2, Lcn/com/union/fido/bean/authenticator/command/DeregisterCommand;->userName:Ljava/lang/String;

    :cond_5b
    iget-object p1, p0, Lcn/com/union/fido/service/AsmService;->mAuthenticateService:Lcn/com/union/fido/service/AuthenticatorService;

    invoke-virtual {v2}, Lcn/com/union/fido/bean/authenticator/command/DeregisterCommand;->serialize()[B

    move-result-object v1

    const/16 v2, 0x3404

    invoke-virtual {p1, v1, v2}, Lcn/com/union/fido/service/AuthenticatorService;->process([BI)[B

    move-result-object p1

    new-instance v1, Lcn/com/union/fido/bean/authenticator/command/DeregisterResponse;

    invoke-direct {v1}, Lcn/com/union/fido/bean/authenticator/command/DeregisterResponse;-><init>()V

    invoke-static {p1}, Lcn/com/union/fido/util/CommonTools;->isValidateByteArray([B)Z

    move-result v2

    if-eqz v2, :cond_7e

    invoke-virtual {v1, p1}, Lcn/com/union/fido/bean/authenticator/command/DeregisterResponse;->deserialize([B)V

    iget-short p1, v1, Lcn/com/union/fido/bean/authenticator/command/DeregisterResponse;->statusCode:S

    const/4 v1, 0x6

    if-ne p1, v1, :cond_7e

    const/4 p1, 0x0

    iput-short p1, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    goto :goto_80

    :cond_7e
    iput-short v3, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    :goto_80
    return-object v0
.end method

.method private getInfoRequest()Lcn/com/union/fido/bean/asm/ASMResponse;
    .registers 13

    new-instance v0, Lcn/com/union/fido/bean/asm/ASMResponse;

    invoke-direct {v0}, Lcn/com/union/fido/bean/asm/ASMResponse;-><init>()V

    new-instance v1, Lcn/com/union/fido/bean/authenticator/command/GetInfoCommand;

    invoke-direct {v1}, Lcn/com/union/fido/bean/authenticator/command/GetInfoCommand;-><init>()V

    iget-object v2, p0, Lcn/com/union/fido/service/AsmService;->mAuthenticateService:Lcn/com/union/fido/service/AuthenticatorService;

    invoke-virtual {v1}, Lcn/com/union/fido/bean/authenticator/command/GetInfoCommand;->serialize()[B

    move-result-object v1

    const/16 v3, 0x3401

    invoke-virtual {v2, v1, v3}, Lcn/com/union/fido/service/AuthenticatorService;->process([BI)[B

    move-result-object v1

    new-instance v2, Lcn/com/union/fido/bean/authenticator/command/GetInfoResponse;

    invoke-direct {v2}, Lcn/com/union/fido/bean/authenticator/command/GetInfoResponse;-><init>()V

    invoke-virtual {v2, v1}, Lcn/com/union/fido/bean/authenticator/command/GetInfoResponse;->deserialize([B)V

    iget-short v1, v2, Lcn/com/union/fido/bean/authenticator/command/GetInfoResponse;->statusCode:S

    const/4 v3, 0x1

    if-nez v1, :cond_f4

    iget-object v1, v2, Lcn/com/union/fido/bean/authenticator/command/GetInfoResponse;->authenticatorInfo:Ljava/util/List;

    new-instance v2, Ljava/util/ArrayList;

    invoke-direct {v2}, Ljava/util/ArrayList;-><init>()V

    invoke-static {}, Lcn/com/union/fido/util/UAFTools;->getAsmVersion()Lcn/com/union/fido/bean/Version;

    move-result-object v4

    invoke-interface {v2, v4}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    new-instance v4, Ljava/util/ArrayList;

    invoke-direct {v4}, Ljava/util/ArrayList;-><init>()V

    invoke-interface {v1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_3a
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    const/4 v6, 0x0

    if-eqz v5, :cond_e8

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_INFO;

    new-instance v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;

    invoke-direct {v7}, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;-><init>()V

    iget-byte v8, v5, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_INFO;->authenticatorIndex:B

    int-to-short v8, v8

    iput-short v8, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->authenticatorIndex:S

    iput-object v2, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->asmVersions:Ljava/util/List;

    iput-boolean v3, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->isUserEnrolled:Z

    iput-boolean v6, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->hasSettings:Z

    iget-object v8, v5, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_INFO;->aaid:Ljava/lang/String;

    iput-object v8, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->aaid:Ljava/lang/String;

    iget-object v8, v5, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_INFO;->assertionScheme:Ljava/lang/String;

    iput-object v8, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->assertionScheme:Ljava/lang/String;

    iget-object v8, v5, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_INFO;->authenticatorMetadata:Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_METADATA;

    iget-short v8, v8, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_METADATA;->authenticationAlg:S

    iput v8, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->authenticationAlgorithm:I

    iget-object v8, v5, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_INFO;->attestationType:Ljava/util/List;

    iput-object v8, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->attestationTypes:Ljava/util/List;

    iget-object v8, v5, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_INFO;->authenticatorMetadata:Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_METADATA;

    iget v8, v8, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_METADATA;->userVerification:I

    int-to-long v8, v8

    iput-wide v8, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->userVerification:J

    iget-object v8, v5, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_INFO;->authenticatorMetadata:Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_METADATA;

    iget-short v8, v8, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_METADATA;->keyProtection:S

    iput v8, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->keyProtection:I

    iget-object v8, v5, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_INFO;->authenticatorMetadata:Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_METADATA;

    iget-short v8, v8, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_METADATA;->matcherProtection:S

    iput v8, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->matcherProtection:I

    const-wide/16 v8, 0x1

    iput-wide v8, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->attachmentHint:J

    iput-boolean v6, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->isSecondFactorOnly:Z

    iput-boolean v6, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->isRoamingAuthenticator:Z

    iget-object v6, v5, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_INFO;->supportedExtensionID:Ljava/util/List;

    iput-object v6, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->supportedExtensionIDs:Ljava/util/List;

    iget-object v6, v5, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_INFO;->authenticatorMetadata:Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_METADATA;

    iget-short v6, v6, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_METADATA;->tcDisplay:S

    iput v6, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->tcDisplay:I

    iget-object v6, v5, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_INFO;->tcDisplayContentType:Ljava/lang/String;

    iput-object v6, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->tcDisplayContentType:Ljava/lang/String;

    new-instance v6, Ljava/util/ArrayList;

    invoke-direct {v6}, Ljava/util/ArrayList;-><init>()V

    iget-object v5, v5, Lcn/com/union/fido/bean/authenticator/tag/TAG_AUTHENTICATOR_INFO;->tcDisplayPNGCharacteristics:Ljava/util/List;

    invoke-interface {v5}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v5

    :goto_9d
    invoke-interface {v5}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_d5

    invoke-interface {v5}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcn/com/union/fido/bean/authenticator/tag/TAG_TC_DISPLAY_PNG_CHARACTERISTICS;

    new-instance v9, Lcn/com/union/fido/bean/authenticator/DisplayPNGCharacteristicsDescriptor;

    invoke-direct {v9}, Lcn/com/union/fido/bean/authenticator/DisplayPNGCharacteristicsDescriptor;-><init>()V

    iget v10, v8, Lcn/com/union/fido/bean/authenticator/tag/TAG_TC_DISPLAY_PNG_CHARACTERISTICS;->width:I

    int-to-long v10, v10

    iput-wide v10, v9, Lcn/com/union/fido/bean/authenticator/DisplayPNGCharacteristicsDescriptor;->width:J

    iget v10, v8, Lcn/com/union/fido/bean/authenticator/tag/TAG_TC_DISPLAY_PNG_CHARACTERISTICS;->height:I

    int-to-long v10, v10

    iput-wide v10, v9, Lcn/com/union/fido/bean/authenticator/DisplayPNGCharacteristicsDescriptor;->height:J

    iget-byte v10, v8, Lcn/com/union/fido/bean/authenticator/tag/TAG_TC_DISPLAY_PNG_CHARACTERISTICS;->bitDepth:B

    int-to-short v10, v10

    iput-short v10, v9, Lcn/com/union/fido/bean/authenticator/DisplayPNGCharacteristicsDescriptor;->bitDepth:S

    iget-byte v10, v8, Lcn/com/union/fido/bean/authenticator/tag/TAG_TC_DISPLAY_PNG_CHARACTERISTICS;->colorType:B

    int-to-short v10, v10

    iput-short v10, v9, Lcn/com/union/fido/bean/authenticator/DisplayPNGCharacteristicsDescriptor;->colorType:S

    iget-byte v10, v8, Lcn/com/union/fido/bean/authenticator/tag/TAG_TC_DISPLAY_PNG_CHARACTERISTICS;->colorType:B

    int-to-short v10, v10

    iput-short v10, v9, Lcn/com/union/fido/bean/authenticator/DisplayPNGCharacteristicsDescriptor;->compression:S

    iget-byte v10, v8, Lcn/com/union/fido/bean/authenticator/tag/TAG_TC_DISPLAY_PNG_CHARACTERISTICS;->filter:B

    int-to-short v10, v10

    iput-short v10, v9, Lcn/com/union/fido/bean/authenticator/DisplayPNGCharacteristicsDescriptor;->filter:S

    iget-byte v8, v8, Lcn/com/union/fido/bean/authenticator/tag/TAG_TC_DISPLAY_PNG_CHARACTERISTICS;->interlace:B

    int-to-short v8, v8

    iput-short v8, v9, Lcn/com/union/fido/bean/authenticator/DisplayPNGCharacteristicsDescriptor;->interlace:S

    invoke-interface {v6, v9}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    goto :goto_9d

    :cond_d5
    iput-object v6, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->tcDisplayPNGCharacteristics:Ljava/util/List;

    const-string v5, "FIDO UAF1.0 Authenticator (ECDSA) for Android"

    iput-object v5, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->title:Ljava/lang/String;

    const-string v5, "FIDO UAF1.0 Authenticator (ECDSA) for Android"

    iput-object v5, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->description:Ljava/lang/String;

    const-string v5, "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE8AAAAvCAYAAACiwJfcAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAahSURBVGhD7Zr5bxRlGMf9KzTB8AM/YEhE2W7pQZcWKKBclSpHATlELARE7kNECCA3FkWK0CKKSCFIsKBcgVCDWGNESdAYidwgggJBiRiMhFc/4wy8884zu9NdlnGTfZJP2n3nO++88933fveBBx+PqCzJkTUvBbLmpUDWvBTImpcCSZvXLCdX9R05Sk19bb5atf599fG+/erA541q47aP1LLVa9SIyVNUi8Ii8d5kGTsi30NFv7ai9n7QZPMwbdys2erU2XMqUdy8+ZcaNmGimE8yXN3RUd3a18nF0fUlovZ+0CTzWpd2Vj+eOm1bEyy6Dx4i5pUMGWveo506q227dtuWBIuffr6oWpV0FPNLhow1751Nm21LvPH3rVtWjfz66Lfql8tX7FRl9YFSXsmSseb9ceOGbYk7MNUcGPg8ZsbMe9rfQUaaV/JMX9sqdzDCSvp0kZHmTZg9x7bLHcMnThb16eJ+mVfQq8yaUZQNG64iXZ+0/kq6uOZFO0QtatdWKfXnRQ99Bj91R5OIFnk54jN0mkUiqlO3XDW+Ml+98mKB6tW7rWpZcPc+0zg4tLrYlUc86E6eGDjIMubVpcusearfgIYGRk6brhZVr/JcHzooL7550jedLExopWcApi2ZUqhu7JLvrVsQU81zkzOPeemMRYvVuQsX7PbiDQY5JvZonftK+1VY8H9utx530h0ob+jmRYqj6ouaYvEenW/WlYjp8cwbMm682tPwqW1R4tj/2SH13IRJYl4moZvXpiSqDr7dXtQHxa/PK3/+BWsK1dTgHu6V8tQJ3bwFkwpFrUOQ50s1r3levm8zZcq17+BBaw7K8lEK5qzkYeark9A8p7P3GzDK+nd3DQow+6UC8SVN82iuv38im7NtaXtV1CVq6Rgw4pksmbdi3bu2De7YfaBBxcqfvqPrUjFQNTQ22lfdUVVT68rTJKF5DnSmUjgdqg4mSS9pmsfDJR3G6ToH0iW9aV7LWLHYXKllTDt0LTAtkYIaamp1QjVv++uyGUxVdJ0DNVXSm+b1qRxpl84ddfX1Lp1O/d69tsod0vs5hGre9xu8o+fpLR1cGhNTD6Z57C9KMWXefJdOZ94bb9oqd1ROnS7qITTzHimMqivbO3g0DdVyk3WQBhBztK35YKNdOnc8O3acS6fDZFgKaXLsEJp5rdrliBqp89cJcs/m7Tvs0rkjGfN4b0kPoZn3UJuIOrnZ22yP1fmvUx+O5gSqebV1m+zSuYNVhq7TWbDiLVvljplLlop6CLXP+2qtvGLIL/1vimISdMBgzSoFZyu6Tqd+jzxgsPaV9BCqee/NjYk6v6lK9cwiUc/STtf1HDpM3b592y7h3Thx5ozK69HLpYWuAwaqS5cv26q7ceb8efVYaReP3iFU8zj1knSwZXHMmnCjY0Ogalo7UQfSCM3qQQr2H/XFP7ssXx45Yl91ByeCep4moZoH+1fG3xD4tT7x8kwyj8nwb9ev26V0B6d+7H4zKvudAH537FjqyzOHdJnHEuzmXq/WjxObvNMbv7nhywsX2aVsWtC8+48aLeapE7p5wKZi0A2AQRV5nvR4E+uJc+b61kApqInxBgmd/4V5QP/mt18HDC7sRHftmeu5lmhV0rn/ALX232bqd4BFnDx7Vi1cWS2uff0IbB47qexxmUj9QutYjupd3tYD6abWBBMrh+apNbOKrNF1+ugCa4riXGfwMPPtViavhU3YMOAAnuUb/R07L0yOSeOadE88ApsXFGff30ynhlJgM51CU6vN9EzgnpvHBFUyiVraePiwJ53DF5ZTZnomENg85kNUd2oJi2Wpr4OmmkfN4x4zHfiVFc8Dv8NzuhNqOidilGvA6DGueZwO78AAQn6ciEk6+rw5VcvjvqNDYPOoIUwaKShrxAuXLlkH4aYuGfMYDc10WF5Ta31hPJOfcUhrU/JlINi6c6elRYdBpo6++Yfjx61lGNfRm4MD5rJ1j3FoGHnjDSBNarYUgMLyMszKpb7tXpoHfPs8h3Wp1LzNfNk54XxC1wDGUmYzXYefh6z/cKtVm4EBxa9VQGDzYr3LrUMRjHEKkk7zaFKYQA2hGQU1z+85NFWpXDrkz3vx10GqxQ6BzeNboBk5n8k4nebRh+k1hWfxTF0D1EyWUs5nv+dgQqKaxzuCdE0isHl02NQ8ah0mXr12La3m0f9wik9+wLNTMY/86MPo8yi31OfxmT6PWoqG9+DZukYna56mSZt5WWSy5qVA1rwUyJqXAlnzkiai/gHSD7RkTyihogAAAABJRU5ErkJggg=="

    iput-object v5, v7, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->icon:Ljava/lang/String;

    invoke-interface {v4, v7}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    goto/16 :goto_3a

    :cond_e8
    new-instance v1, Lcn/com/union/fido/bean/asm/GetInfoOut;

    invoke-direct {v1}, Lcn/com/union/fido/bean/asm/GetInfoOut;-><init>()V

    iput-object v4, v1, Lcn/com/union/fido/bean/asm/GetInfoOut;->Authenticators:Ljava/util/List;

    iput-object v1, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->responseData:Ljava/lang/Object;

    iput-short v6, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    goto :goto_f6

    :cond_f4
    iput-short v3, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    :goto_f6
    return-object v0
.end method

.method private getRegistrationsRequest(Lcn/com/union/fido/bean/asm/ASMRequest;)Lcn/com/union/fido/bean/asm/ASMResponse;
    .registers 7

    new-instance v0, Lcn/com/union/fido/bean/asm/ASMResponse;

    invoke-direct {v0}, Lcn/com/union/fido/bean/asm/ASMResponse;-><init>()V

    iget-object p1, p1, Lcn/com/union/fido/bean/asm/ASMRequest;->authenticatorIndex:Ljava/lang/Short;

    invoke-virtual {p1}, Ljava/lang/Short;->shortValue()S

    move-result p1

    invoke-static {p1}, Lcn/com/union/fido/common/GlobalConfiguration;->locateAuthenticator(S)Lcn/com/union/fido/bean/asm/AuthenticatorInfo;

    move-result-object p1

    if-nez p1, :cond_15

    const/4 p1, 0x1

    :goto_12
    iput-short p1, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    goto :goto_62

    :cond_15
    iget-boolean v1, p1, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->isRoamingAuthenticator:Z

    if-nez v1, :cond_62

    iget-object v1, p0, Lcn/com/union/fido/service/AsmService;->mContext:Landroid/content/Context;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    invoke-static {v1, v2}, Lcn/com/union/fido/util/UAFTools;->getCallerID(Landroid/content/Context;I)Ljava/lang/String;

    move-result-object v1

    new-instance v2, Ljava/util/ArrayList;

    invoke-direct {v2}, Ljava/util/ArrayList;-><init>()V

    iget-object v3, p0, Lcn/com/union/fido/service/AsmService;->authDBManager:Lcn/com/union/fido/db/AuthenticationManager;

    iget-object p1, p1, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->aaid:Ljava/lang/String;

    invoke-virtual {v3, v1, p1}, Lcn/com/union/fido/db/AuthenticationManager;->getRegistrations(Ljava/lang/String;Ljava/lang/String;)Ljava/util/Map;

    move-result-object p1

    invoke-interface {p1}, Ljava/util/Map;->keySet()Ljava/util/Set;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_38
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_57

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    new-instance v4, Lcn/com/union/fido/bean/asm/AppRegistration;

    invoke-direct {v4}, Lcn/com/union/fido/bean/asm/AppRegistration;-><init>()V

    iput-object v3, v4, Lcn/com/union/fido/bean/asm/AppRegistration;->appID:Ljava/lang/String;

    invoke-interface {p1, v3}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/util/List;

    iput-object v3, v4, Lcn/com/union/fido/bean/asm/AppRegistration;->keyIDs:Ljava/util/List;

    invoke-interface {v2, v4}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    goto :goto_38

    :cond_57
    new-instance p1, Lcn/com/union/fido/bean/asm/GetRegistrationsOut;

    invoke-direct {p1}, Lcn/com/union/fido/bean/asm/GetRegistrationsOut;-><init>()V

    iput-object v2, p1, Lcn/com/union/fido/bean/asm/GetRegistrationsOut;->appRegs:Ljava/util/List;

    iput-object p1, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->responseData:Ljava/lang/Object;

    const/4 p1, 0x0

    goto :goto_12

    :cond_62
    :goto_62
    return-object v0
.end method

.method private openSettingsRequest(Lcn/com/union/fido/bean/asm/ASMRequest;)Lcn/com/union/fido/bean/asm/ASMResponse;
    .registers 6

    new-instance v0, Lcn/com/union/fido/bean/asm/ASMResponse;

    invoke-direct {v0}, Lcn/com/union/fido/bean/asm/ASMResponse;-><init>()V

    iget-object p1, p1, Lcn/com/union/fido/bean/asm/ASMRequest;->authenticatorIndex:Ljava/lang/Short;

    invoke-virtual {p1}, Ljava/lang/Short;->shortValue()S

    move-result p1

    invoke-static {p1}, Lcn/com/union/fido/common/GlobalConfiguration;->locateAuthenticator(S)Lcn/com/union/fido/bean/asm/AuthenticatorInfo;

    move-result-object v1

    const/4 v2, 0x1

    if-eqz v1, :cond_41

    iget-boolean v1, v1, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->hasSettings:Z

    if-eqz v1, :cond_41

    new-instance v1, Lcn/com/union/fido/bean/authenticator/command/OpenSettingsCommand;

    invoke-direct {v1}, Lcn/com/union/fido/bean/authenticator/command/OpenSettingsCommand;-><init>()V

    int-to-byte p1, p1

    iput-byte p1, v1, Lcn/com/union/fido/bean/authenticator/command/OpenSettingsCommand;->authenticatorIndex:B

    iget-object p1, p0, Lcn/com/union/fido/service/AsmService;->mAuthenticateService:Lcn/com/union/fido/service/AuthenticatorService;

    invoke-virtual {v1}, Lcn/com/union/fido/bean/authenticator/command/OpenSettingsCommand;->serialize()[B

    move-result-object v1

    const/16 v3, 0x3406

    invoke-virtual {p1, v1, v3}, Lcn/com/union/fido/service/AuthenticatorService;->process([BI)[B

    move-result-object p1

    new-instance v1, Lcn/com/union/fido/bean/authenticator/command/OpenSettingsResponse;

    invoke-direct {v1}, Lcn/com/union/fido/bean/authenticator/command/OpenSettingsResponse;-><init>()V

    invoke-static {p1}, Lcn/com/union/fido/util/CommonTools;->isValidateByteArray([B)Z

    move-result v3

    if-eqz v3, :cond_41

    invoke-virtual {v1, p1}, Lcn/com/union/fido/bean/authenticator/command/OpenSettingsResponse;->deserialize([B)V

    iget-short p1, v1, Lcn/com/union/fido/bean/authenticator/command/OpenSettingsResponse;->statusCode:S

    const/4 v1, 0x6

    if-ne p1, v1, :cond_41

    const/4 p1, 0x0

    iput-short p1, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    goto :goto_43

    :cond_41
    iput-short v2, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    :goto_43
    return-object v0
.end method

.method private registerRequest(Lcn/com/union/fido/bean/asm/ASMRequest;)Lcn/com/union/fido/bean/asm/ASMResponse;
    .registers 13

    new-instance v0, Lcn/com/union/fido/bean/asm/ASMResponse;

    invoke-direct {v0}, Lcn/com/union/fido/bean/asm/ASMResponse;-><init>()V

    iget-object v1, p1, Lcn/com/union/fido/bean/asm/ASMRequest;->authenticatorIndex:Ljava/lang/Short;

    invoke-virtual {v1}, Ljava/lang/Short;->shortValue()S

    move-result v1

    invoke-static {v1}, Lcn/com/union/fido/common/GlobalConfiguration;->locateAuthenticator(S)Lcn/com/union/fido/bean/asm/AuthenticatorInfo;

    move-result-object v2

    const/4 v3, 0x1

    if-nez v2, :cond_16

    :goto_12
    iput-short v3, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    goto/16 :goto_167

    :cond_16
    invoke-virtual {p1}, Lcn/com/union/fido/bean/asm/ASMRequest;->getArgs()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcn/com/union/fido/bean/asm/RegisterIn;

    iget-object v5, v4, Lcn/com/union/fido/bean/asm/RegisterIn;->appID:Ljava/lang/String;

    iget-object v6, p0, Lcn/com/union/fido/service/AsmService;->mContext:Landroid/content/Context;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v7

    invoke-static {v6, v7}, Lcn/com/union/fido/util/UAFTools;->getCallerID(Landroid/content/Context;I)Ljava/lang/String;

    move-result-object v6

    const/4 v7, 0x0

    invoke-static {v5, v7, v7, v6, v3}, Lcn/com/union/fido/util/UAFTools;->genKHAccessToken(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)Ljava/lang/String;

    move-result-object v7

    new-instance v8, Lcn/com/union/fido/bean/authenticator/command/RegisterCommand;

    invoke-direct {v8}, Lcn/com/union/fido/bean/authenticator/command/RegisterCommand;-><init>()V

    int-to-byte v1, v1

    iput-byte v1, v8, Lcn/com/union/fido/bean/authenticator/command/RegisterCommand;->authenticatorIndex:B

    iput-object v5, v8, Lcn/com/union/fido/bean/authenticator/command/RegisterCommand;->appID:Ljava/lang/String;

    iget-object v1, v4, Lcn/com/union/fido/bean/asm/RegisterIn;->finalChallenge:Ljava/lang/String;

    invoke-virtual {v1}, Ljava/lang/String;->getBytes()[B

    move-result-object v1

    const-string v9, "SHA256"

    invoke-static {v1, v9}, Lcn/com/union/fido/util/CryptoTools;->doHash([BLjava/lang/String;)[B

    move-result-object v1

    iput-object v1, v8, Lcn/com/union/fido/bean/authenticator/command/RegisterCommand;->finalChallenge:[B

    iget-object v1, v4, Lcn/com/union/fido/bean/asm/RegisterIn;->username:Ljava/lang/String;

    iput-object v1, v8, Lcn/com/union/fido/bean/authenticator/command/RegisterCommand;->userName:Ljava/lang/String;

    iget-short v1, v4, Lcn/com/union/fido/bean/asm/RegisterIn;->attestationType:S

    iput-short v1, v8, Lcn/com/union/fido/bean/authenticator/command/RegisterCommand;->attestationType:S

    iput-object v7, v8, Lcn/com/union/fido/bean/authenticator/command/RegisterCommand;->khAccessToken:Ljava/lang/String;

    invoke-virtual {p1}, Lcn/com/union/fido/bean/asm/ASMRequest;->getExts()Ljava/util/List;

    move-result-object p1

    if-eqz p1, :cond_81

    new-instance v1, Ljava/util/ArrayList;

    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V

    invoke-interface {p1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object p1

    :goto_5e
    invoke-interface {p1}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_7f

    invoke-interface {p1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcn/com/union/fido/bean/Extension;

    new-instance v9, Lcn/com/union/fido/bean/authenticator/tag/TAG_EXTENSION;

    invoke-direct {v9}, Lcn/com/union/fido/bean/authenticator/tag/TAG_EXTENSION;-><init>()V

    invoke-virtual {v7}, Lcn/com/union/fido/bean/Extension;->getId()Ljava/lang/String;

    move-result-object v10

    iput-object v10, v9, Lcn/com/union/fido/bean/authenticator/tag/TAG_EXTENSION;->id:Ljava/lang/String;

    invoke-virtual {v7}, Lcn/com/union/fido/bean/Extension;->getData()Ljava/lang/String;

    move-result-object v7

    iput-object v7, v9, Lcn/com/union/fido/bean/authenticator/tag/TAG_EXTENSION;->data:Ljava/lang/String;

    invoke-interface {v1, v9}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    goto :goto_5e

    :cond_7f
    iput-object v1, v8, Lcn/com/union/fido/bean/authenticator/command/RegisterCommand;->extensions:Ljava/util/List;

    :cond_81
    iget-object p1, p0, Lcn/com/union/fido/service/AsmService;->mAuthenticateService:Lcn/com/union/fido/service/AuthenticatorService;

    invoke-virtual {v8}, Lcn/com/union/fido/bean/authenticator/command/RegisterCommand;->serialize()[B

    move-result-object v1

    const/16 v7, 0x3402

    invoke-virtual {p1, v1, v7}, Lcn/com/union/fido/service/AuthenticatorService;->process([BI)[B

    move-result-object p1

    new-instance v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;

    invoke-direct {v1}, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;-><init>()V

    invoke-static {p1}, Lcn/com/union/fido/util/CommonTools;->isValidateByteArray([B)Z

    move-result v7

    if-eqz v7, :cond_9c

    invoke-virtual {v1, p1}, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->deserialize([B)V

    goto :goto_9e

    :cond_9c
    iput-short v3, v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->statusCode:S

    :goto_9e
    iget-short p1, v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->statusCode:S

    if-nez p1, :cond_fc

    iget-object p1, v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->assertion:[B

    new-instance v3, Lcn/com/union/fido/bean/authenticator/tag/TAG_UAFV1_REG_ASSERTION;

    invoke-direct {v3}, Lcn/com/union/fido/bean/authenticator/tag/TAG_UAFV1_REG_ASSERTION;-><init>()V

    invoke-virtual {v3, p1}, Lcn/com/union/fido/bean/authenticator/tag/TAG_UAFV1_REG_ASSERTION;->deserialize([B)V

    iget-boolean v7, v2, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->isRoamingAuthenticator:Z

    if-nez v7, :cond_e6

    new-instance v7, Lcn/com/union/fido/bean/db/AuthenticationEntity;

    invoke-direct {v7}, Lcn/com/union/fido/bean/db/AuthenticationEntity;-><init>()V

    invoke-virtual {v7, v6}, Lcn/com/union/fido/bean/db/AuthenticationEntity;->setCallerID(Ljava/lang/String;)V

    invoke-virtual {v7, v5}, Lcn/com/union/fido/bean/db/AuthenticationEntity;->setAppID(Ljava/lang/String;)V

    iget-object v1, v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->keyHandle:Ljava/lang/String;

    invoke-virtual {v7, v1}, Lcn/com/union/fido/bean/db/AuthenticationEntity;->setKeyHandle(Ljava/lang/String;)V

    iget-object v1, v3, Lcn/com/union/fido/bean/authenticator/tag/TAG_UAFV1_REG_ASSERTION;->uafv1Krd:Lcn/com/union/fido/bean/authenticator/tag/TAG_UAFV1_KRD;

    iget-object v1, v1, Lcn/com/union/fido/bean/authenticator/tag/TAG_UAFV1_KRD;->keyID:Ljava/lang/String;

    invoke-static {v1}, Lcn/com/union/fido/util/StringTools;->urlSafeBase64Enc(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v7, v1}, Lcn/com/union/fido/bean/db/AuthenticationEntity;->setKeyID(Ljava/lang/String;)V

    invoke-static {}, Lcn/com/union/fido/util/DateTools;->getCurrentTimeStamp()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v7, v1}, Lcn/com/union/fido/bean/db/AuthenticationEntity;->setCurrentTimestamp(Ljava/lang/String;)V

    const-string v1, "ready"

    invoke-virtual {v7, v1}, Lcn/com/union/fido/bean/db/AuthenticationEntity;->setStatus(Ljava/lang/String;)V

    iget-object v1, v2, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->aaid:Ljava/lang/String;

    invoke-virtual {v7, v1}, Lcn/com/union/fido/bean/db/AuthenticationEntity;->setAaid(Ljava/lang/String;)V

    iget-object v1, v4, Lcn/com/union/fido/bean/asm/RegisterIn;->username:Ljava/lang/String;

    invoke-virtual {v7, v1}, Lcn/com/union/fido/bean/db/AuthenticationEntity;->setUserName(Ljava/lang/String;)V

    iget-object v1, p0, Lcn/com/union/fido/service/AsmService;->authDBManager:Lcn/com/union/fido/db/AuthenticationManager;

    invoke-virtual {v1, v7}, Lcn/com/union/fido/db/AuthenticationManager;->add(Lcn/com/union/fido/bean/db/AuthenticationEntity;)V

    :cond_e6
    new-instance v1, Lcn/com/union/fido/bean/asm/RegisterOut;

    invoke-direct {v1}, Lcn/com/union/fido/bean/asm/RegisterOut;-><init>()V

    iget-object v2, v2, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->assertionScheme:Ljava/lang/String;

    iput-object v2, v1, Lcn/com/union/fido/bean/asm/RegisterOut;->assertionScheme:Ljava/lang/String;

    invoke-static {p1}, Lcn/com/union/fido/util/StringTools;->urlSafeBase64Enc([B)Ljava/lang/String;

    move-result-object p1

    iput-object p1, v1, Lcn/com/union/fido/bean/asm/RegisterOut;->assertion:Ljava/lang/String;

    const/4 p1, 0x0

    iput-short p1, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    iput-object v1, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->responseData:Ljava/lang/Object;

    goto/16 :goto_167

    :cond_fc
    iget-short p1, v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->statusCode:S

    const/4 v2, 0x5

    if-ne p1, v2, :cond_106

    const/4 p1, 0x3

    :goto_102
    iput-short p1, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    goto/16 :goto_167

    :cond_106
    iget-short p1, v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->statusCode:S

    const/16 v2, 0x8

    if-ne p1, v2, :cond_10e

    const/4 p1, 0x4

    goto :goto_102

    :cond_10e
    iget-short p1, v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->statusCode:S

    const/16 v2, 0x10

    if-ne p1, v2, :cond_116

    const/4 p1, 0x6

    goto :goto_102

    :cond_116
    iget-short p1, v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->statusCode:S

    const/16 v3, 0x13

    if-ne p1, v3, :cond_11f

    const/16 p1, 0x9

    goto :goto_102

    :cond_11f
    iget-short p1, v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->statusCode:S

    const/16 v4, 0x14

    if-ne p1, v4, :cond_128

    :goto_125
    iput-short v2, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    goto :goto_167

    :cond_128
    iget-short p1, v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->statusCode:S

    const/16 v2, 0x15

    if-ne p1, v2, :cond_131

    const/16 p1, 0x11

    goto :goto_102

    :cond_131
    iget-short p1, v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->statusCode:S

    const/16 v5, 0x16

    if-ne p1, v5, :cond_13a

    const/16 p1, 0x12

    goto :goto_102

    :cond_13a
    iget-short p1, v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->statusCode:S

    const/16 v6, 0x17

    if-ne p1, v6, :cond_142

    goto/16 :goto_12

    :cond_142
    iget-short p1, v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->statusCode:S

    const/16 v3, 0x18

    if-ne p1, v3, :cond_14b

    iput-short v4, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    goto :goto_167

    :cond_14b
    iget-short p1, v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->statusCode:S

    const/16 v3, 0x19

    if-ne p1, v3, :cond_152

    goto :goto_125

    :cond_152
    iget-short p1, v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->statusCode:S

    const/16 v2, 0x20

    if-ne p1, v2, :cond_15b

    iput-short v5, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    goto :goto_167

    :cond_15b
    iget-short p1, v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->statusCode:S

    const/16 v2, 0x21

    if-ne p1, v2, :cond_164

    iput-short v6, v0, Lcn/com/union/fido/bean/asm/ASMResponse;->statusCode:S

    goto :goto_167

    :cond_164
    iget-short p1, v1, Lcn/com/union/fido/bean/authenticator/command/RegisterResponse;->statusCode:S

    goto :goto_102

    :goto_167
    return-object v0
.end method

.method private triggerSignCommand(Lcn/com/union/fido/bean/asm/AuthenticatorInfo;Lcn/com/union/fido/bean/asm/AuthenticateIn;Ljava/lang/String;Ljava/util/List;Ljava/lang/String;Ljava/util/List;)Lcn/com/union/fido/bean/authenticator/command/SignResponse;
    .registers 11
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcn/com/union/fido/bean/asm/AuthenticatorInfo;",
            "Lcn/com/union/fido/bean/asm/AuthenticateIn;",
            "Ljava/lang/String;",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;",
            "Ljava/lang/String;",
            "Ljava/util/List<",
            "Lcn/com/union/fido/bean/Extension;",
            ">;)",
            "Lcn/com/union/fido/bean/authenticator/command/SignResponse;"
        }
    .end annotation

    new-instance v0, Lcn/com/union/fido/bean/authenticator/command/SignCommand;

    invoke-direct {v0}, Lcn/com/union/fido/bean/authenticator/command/SignCommand;-><init>()V

    iget-short p1, p1, Lcn/com/union/fido/bean/asm/AuthenticatorInfo;->authenticatorIndex:S

    int-to-byte p1, p1

    iput-byte p1, v0, Lcn/com/union/fido/bean/authenticator/command/SignCommand;->authenticatorIndex:B

    iget-object p1, p2, Lcn/com/union/fido/bean/asm/AuthenticateIn;->appID:Ljava/lang/String;

    iput-object p1, v0, Lcn/com/union/fido/bean/authenticator/command/SignCommand;->appID:Ljava/lang/String;

    iget-object p1, p2, Lcn/com/union/fido/bean/asm/AuthenticateIn;->finalChallenge:Ljava/lang/String;

    const-string v1, "SHA256"

    invoke-static {p1, v1}, Lcn/com/union/fido/util/CryptoTools;->hash(Ljava/lang/String;Ljava/lang/String;)[B

    move-result-object p1

    iput-object p1, v0, Lcn/com/union/fido/bean/authenticator/command/SignCommand;->finalChallenge:[B

    iget-object p1, p2, Lcn/com/union/fido/bean/asm/AuthenticateIn;->transaction:Ljava/util/List;

    invoke-static {p1}, Lcn/com/union/fido/util/CommonTools;->isValidateList(Ljava/util/List;)Z

    move-result p2

    const/4 v1, 0x1

    if-eqz p2, :cond_6b

    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result p2

    const/4 v2, 0x0

    if-ne p2, v1, :cond_3e

    invoke-interface {p1, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcn/com/union/fido/bean/Transaction;

    invoke-virtual {p1}, Lcn/com/union/fido/bean/Transaction;->getContent()Ljava/lang/String;

    move-result-object p1

    new-instance p2, Ljava/lang/String;

    invoke-static {p1}, Lcn/com/union/fido/util/StringTools;->urlSafeBase64Dec(Ljava/lang/String;)[B

    move-result-object p1

    invoke-direct {p2, p1}, Ljava/lang/String;-><init>([B)V

    :goto_3b
    iput-object p2, v0, Lcn/com/union/fido/bean/authenticator/command/SignCommand;->transactionContent:Ljava/lang/String;

    goto :goto_6b

    :cond_3e
    iget-object p2, p0, Lcn/com/union/fido/service/AsmService;->mContext:Landroid/content/Context;

    invoke-static {p2}, Lcn/com/union/fido/util/CommonTools;->isScreenOriatationPortrait(Landroid/content/Context;)Z

    invoke-interface {p1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object p2

    :goto_47
    invoke-interface {p2}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_57

    invoke-interface {p2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcn/com/union/fido/bean/Transaction;

    invoke-virtual {v3}, Lcn/com/union/fido/bean/Transaction;->getTcDisplayPNGCharacteristics()Lcn/com/union/fido/bean/authenticator/DisplayPNGCharacteristicsDescriptor;

    goto :goto_47

    :cond_57
    invoke-interface {p1, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcn/com/union/fido/bean/Transaction;

    invoke-virtual {p1}, Lcn/com/union/fido/bean/Transaction;->getContent()Ljava/lang/String;

    move-result-object p1

    new-instance p2, Ljava/lang/String;

    invoke-static {p1}, Lcn/com/union/fido/util/StringTools;->urlSafeBase64Dec(Ljava/lang/String;)[B

    move-result-object p1

    invoke-direct {p2, p1}, Ljava/lang/String;-><init>([B)V

    goto :goto_3b

    :cond_6b
    :goto_6b
    iput-object p3, v0, Lcn/com/union/fido/bean/authenticator/command/SignCommand;->khAccessToken:Ljava/lang/String;

    iput-object p4, v0, Lcn/com/union/fido/bean/authenticator/command/SignCommand;->keyHandles:Ljava/util/List;

    iput-object p5, v0, Lcn/com/union/fido/bean/authenticator/command/SignCommand;->userName:Ljava/lang/String;

    if-eqz p6, :cond_9f

    new-instance p1, Ljava/util/ArrayList;

    invoke-direct {p1}, Ljava/util/ArrayList;-><init>()V

    invoke-interface {p6}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object p2

    :goto_7c
    invoke-interface {p2}, Ljava/util/Iterator;->hasNext()Z

    move-result p3

    if-eqz p3, :cond_9d

    invoke-interface {p2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object p3

    check-cast p3, Lcn/com/union/fido/bean/Extension;

    new-instance p4, Lcn/com/union/fido/bean/authenticator/tag/TAG_EXTENSION;

    invoke-direct {p4}, Lcn/com/union/fido/bean/authenticator/tag/TAG_EXTENSION;-><init>()V

    invoke-virtual {p3}, Lcn/com/union/fido/bean/Extension;->getId()Ljava/lang/String;

    move-result-object p5

    iput-object p5, p4, Lcn/com/union/fido/bean/authenticator/tag/TAG_EXTENSION;->id:Ljava/lang/String;

    invoke-virtual {p3}, Lcn/com/union/fido/bean/Extension;->getData()Ljava/lang/String;

    move-result-object p3

    iput-object p3, p4, Lcn/com/union/fido/bean/authenticator/tag/TAG_EXTENSION;->data:Ljava/lang/String;

    invoke-interface {p1, p4}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    goto :goto_7c

    :cond_9d
    iput-object p1, v0, Lcn/com/union/fido/bean/authenticator/command/SignCommand;->extensions:Ljava/util/List;

    :cond_9f
    iget-object p1, p0, Lcn/com/union/fido/service/AsmService;->mAuthenticateService:Lcn/com/union/fido/service/AuthenticatorService;

    invoke-virtual {v0}, Lcn/com/union/fido/bean/authenticator/command/SignCommand;->serialize()[B

    move-result-object p2

    const/16 p3, 0x3403

    invoke-virtual {p1, p2, p3}, Lcn/com/union/fido/service/AuthenticatorService;->process([BI)[B

    move-result-object p1

    new-instance p2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;

    invoke-direct {p2}, Lcn/com/union/fido/bean/authenticator/command/SignResponse;-><init>()V

    invoke-static {p1}, Lcn/com/union/fido/util/CommonTools;->isValidateByteArray([B)Z

    move-result p3

    if-eqz p3, :cond_ba

    invoke-virtual {p2, p1}, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->deserialize([B)V

    goto :goto_bc

    :cond_ba
    iput-short v1, p2, Lcn/com/union/fido/bean/authenticator/command/SignResponse;->statusCode:S

    :goto_bc
    return-object p2
.end method


# virtual methods
.method public process(Lcn/com/union/fido/bean/asm/ASMRequest;)Lcn/com/union/fido/bean/asm/ASMResponse;
    .registers 4

    sget-object v0, Lcn/com/union/fido/service/AsmService$1;->$SwitchMap$cn$com$union$fido$bean$asm$Request:[I

    iget-object v1, p1, Lcn/com/union/fido/bean/asm/ASMRequest;->requestType:Lcn/com/union/fido/bean/asm/Request;

    invoke-virtual {v1}, Lcn/com/union/fido/bean/asm/Request;->ordinal()I

    move-result v1

    aget v0, v0, v1

    packed-switch v0, :pswitch_data_32

    goto :goto_30

    :pswitch_e
    invoke-direct {p0, p1}, Lcn/com/union/fido/service/AsmService;->commitInRequest(Lcn/com/union/fido/bean/asm/ASMRequest;)V

    goto :goto_30

    :pswitch_12
    invoke-direct {p0, p1}, Lcn/com/union/fido/service/AsmService;->openSettingsRequest(Lcn/com/union/fido/bean/asm/ASMRequest;)Lcn/com/union/fido/bean/asm/ASMResponse;

    move-result-object p1

    goto :goto_31

    :pswitch_17
    invoke-direct {p0, p1}, Lcn/com/union/fido/service/AsmService;->getRegistrationsRequest(Lcn/com/union/fido/bean/asm/ASMRequest;)Lcn/com/union/fido/bean/asm/ASMResponse;

    move-result-object p1

    goto :goto_31

    :pswitch_1c
    invoke-direct {p0, p1}, Lcn/com/union/fido/service/AsmService;->deregisterRequest(Lcn/com/union/fido/bean/asm/ASMRequest;)Lcn/com/union/fido/bean/asm/ASMResponse;

    move-result-object p1

    goto :goto_31

    :pswitch_21
    invoke-direct {p0, p1}, Lcn/com/union/fido/service/AsmService;->authenticateRequest(Lcn/com/union/fido/bean/asm/ASMRequest;)Lcn/com/union/fido/bean/asm/ASMResponse;

    move-result-object p1

    goto :goto_31

    :pswitch_26
    invoke-direct {p0, p1}, Lcn/com/union/fido/service/AsmService;->registerRequest(Lcn/com/union/fido/bean/asm/ASMRequest;)Lcn/com/union/fido/bean/asm/ASMResponse;

    move-result-object p1

    goto :goto_31

    :pswitch_2b
    invoke-direct {p0}, Lcn/com/union/fido/service/AsmService;->getInfoRequest()Lcn/com/union/fido/bean/asm/ASMResponse;

    move-result-object p1

    goto :goto_31

    :goto_30
    const/4 p1, 0x0

    :goto_31
    return-object p1

    :pswitch_data_32
    .packed-switch 0x1
        :pswitch_2b
        :pswitch_26
        :pswitch_21
        :pswitch_1c
        :pswitch_17
        :pswitch_12
        :pswitch_e
    .end packed-switch
.end method

.method public setmContext(Landroid/content/Context;)V
    .registers 3

    iput-object p1, p0, Lcn/com/union/fido/service/AsmService;->mContext:Landroid/content/Context;

    iget-object v0, p0, Lcn/com/union/fido/service/AsmService;->mAuthenticateService:Lcn/com/union/fido/service/AuthenticatorService;

    invoke-virtual {v0, p1}, Lcn/com/union/fido/service/AuthenticatorService;->setmContext(Landroid/content/Context;)V

    return-void
.end method
