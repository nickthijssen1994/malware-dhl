.class public Lcn/com/union/fido/db/help/SQLiteHelper;
.super Landroid/database/sqlite/SQLiteOpenHelper;


# static fields
.field private static final DATABASE_NAME:Ljava/lang/String; = "fidounion.db"

.field private static final DATABASE_VERSION:I = 0x1

.field private static mInstance:Lcn/com/union/fido/db/help/SQLiteHelper;


# instance fields
.field private final CREATE_TABLE_AUTHENTICATION:Ljava/lang/String;

.field private final CREATE_TABLE_SIGNCOUNTER:Ljava/lang/String;

.field private final CREATE_TABLE_USERKEY:Ljava/lang/String;

.field public final TABLE_AUTHENTICATION:Ljava/lang/String;

.field public final TABLE_SIGNCOUNTER:Ljava/lang/String;

.field public final TABLE_USERKEY:Ljava/lang/String;


# direct methods
.method static constructor <clinit>()V
    .registers 0

    return-void
.end method

.method private constructor <init>(Landroid/content/Context;)V
    .registers 5

    const-string v0, "fidounion.db"

    const/4 v1, 0x0

    const/4 v2, 0x1

    invoke-direct {p0, p1, v0, v1, v2}, Lcn/com/union/fido/db/help/SQLiteHelper;-><init>(Landroid/content/Context;Ljava/lang/String;Landroid/database/sqlite/SQLiteDatabase$CursorFactory;I)V

    return-void
.end method

.method private constructor <init>(Landroid/content/Context;I)V
    .registers 5

    const-string v0, "fidounion.db"

    const/4 v1, 0x0

    invoke-direct {p0, p1, v0, v1, p2}, Lcn/com/union/fido/db/help/SQLiteHelper;-><init>(Landroid/content/Context;Ljava/lang/String;Landroid/database/sqlite/SQLiteDatabase$CursorFactory;I)V

    return-void
.end method

.method private constructor <init>(Landroid/content/Context;Ljava/lang/String;Landroid/database/sqlite/SQLiteDatabase$CursorFactory;I)V
    .registers 5

    invoke-direct {p0, p1, p2, p3, p4}, Landroid/database/sqlite/SQLiteOpenHelper;-><init>(Landroid/content/Context;Ljava/lang/String;Landroid/database/sqlite/SQLiteDatabase$CursorFactory;I)V

    const-string p1, "userkey"

    iput-object p1, p0, Lcn/com/union/fido/db/help/SQLiteHelper;->TABLE_USERKEY:Ljava/lang/String;

    const-string p1, "authentication"

    iput-object p1, p0, Lcn/com/union/fido/db/help/SQLiteHelper;->TABLE_AUTHENTICATION:Ljava/lang/String;

    const-string p1, "signcounter"

    iput-object p1, p0, Lcn/com/union/fido/db/help/SQLiteHelper;->TABLE_SIGNCOUNTER:Ljava/lang/String;

    const-string p1, "CREATE TABLE userkey(_id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,keyhandle VARCHAR(200) NOT NULL,pubkey VARCHAR(200) NOT NULL,privkey VARCHAR(200) NOT NULL) "

    iput-object p1, p0, Lcn/com/union/fido/db/help/SQLiteHelper;->CREATE_TABLE_USERKEY:Ljava/lang/String;

    const-string p1, "CREATE TABLE authentication(id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, callerID VARCHAR, appID VARCHAR, keyHandle VARCHAR, keyID VARCHAR, currentTimestamp VARCHAR, status VARCHAR, aaid VARCHAR, userName VARCHAR)"

    iput-object p1, p0, Lcn/com/union/fido/db/help/SQLiteHelper;->CREATE_TABLE_AUTHENTICATION:Ljava/lang/String;

    const-string p1, "CREATE TABLE signcounter(id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, aaid VARCHAR, keyID VARCHAR, userName VARCHAR,signCounter INTEGER)"

    iput-object p1, p0, Lcn/com/union/fido/db/help/SQLiteHelper;->CREATE_TABLE_SIGNCOUNTER:Ljava/lang/String;

    return-void
.end method

.method public static declared-synchronized getInstance(Landroid/content/Context;)Lcn/com/union/fido/db/help/SQLiteHelper;
    .registers 3

    const-class v0, Lcn/com/union/fido/db/help/SQLiteHelper;

    monitor-enter v0

    :try_start_3
    sget-object v1, Lcn/com/union/fido/db/help/SQLiteHelper;->mInstance:Lcn/com/union/fido/db/help/SQLiteHelper;

    if-nez v1, :cond_e

    new-instance v1, Lcn/com/union/fido/db/help/SQLiteHelper;

    invoke-direct {v1, p0}, Lcn/com/union/fido/db/help/SQLiteHelper;-><init>(Landroid/content/Context;)V

    sput-object v1, Lcn/com/union/fido/db/help/SQLiteHelper;->mInstance:Lcn/com/union/fido/db/help/SQLiteHelper;

    :cond_e
    sget-object p0, Lcn/com/union/fido/db/help/SQLiteHelper;->mInstance:Lcn/com/union/fido/db/help/SQLiteHelper;
    :try_end_10
    .catchall {:try_start_3 .. :try_end_10} :catchall_12

    monitor-exit v0

    return-object p0

    :catchall_12
    move-exception p0

    monitor-exit v0

    throw p0
.end method


# virtual methods
.method public onCreate(Landroid/database/sqlite/SQLiteDatabase;)V
    .registers 3

    const-string v0, "CREATE TABLE userkey(_id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,keyhandle VARCHAR(200) NOT NULL,pubkey VARCHAR(200) NOT NULL,privkey VARCHAR(200) NOT NULL) "

    invoke-virtual {p1, v0}, Landroid/database/sqlite/SQLiteDatabase;->execSQL(Ljava/lang/String;)V

    const-string v0, "CREATE TABLE authentication(id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, callerID VARCHAR, appID VARCHAR, keyHandle VARCHAR, keyID VARCHAR, currentTimestamp VARCHAR, status VARCHAR, aaid VARCHAR, userName VARCHAR)"

    invoke-virtual {p1, v0}, Landroid/database/sqlite/SQLiteDatabase;->execSQL(Ljava/lang/String;)V

    const-string v0, "CREATE TABLE signcounter(id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, aaid VARCHAR, keyID VARCHAR, userName VARCHAR,signCounter INTEGER)"

    invoke-virtual {p1, v0}, Landroid/database/sqlite/SQLiteDatabase;->execSQL(Ljava/lang/String;)V

    return-void
.end method

.method public onUpgrade(Landroid/database/sqlite/SQLiteDatabase;II)V
    .registers 4

    return-void
.end method

.method public recreateAuthenticationTable(Landroid/database/sqlite/SQLiteDatabase;)V
    .registers 3

    const-string v0, "DROP TABLE IF EXISTS CREATE TABLE authentication(id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, callerID VARCHAR, appID VARCHAR, keyHandle VARCHAR, keyID VARCHAR, currentTimestamp VARCHAR, status VARCHAR, aaid VARCHAR, userName VARCHAR)"

    invoke-virtual {p1, v0}, Landroid/database/sqlite/SQLiteDatabase;->execSQL(Ljava/lang/String;)V

    const-string v0, "CREATE TABLE authentication(id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, callerID VARCHAR, appID VARCHAR, keyHandle VARCHAR, keyID VARCHAR, currentTimestamp VARCHAR, status VARCHAR, aaid VARCHAR, userName VARCHAR)"

    invoke-virtual {p1, v0}, Landroid/database/sqlite/SQLiteDatabase;->execSQL(Ljava/lang/String;)V

    return-void
.end method

.method public recreateSigncounterTable(Landroid/database/sqlite/SQLiteDatabase;)V
    .registers 3

    const-string v0, "DROP TABLE IF EXISTS CREATE TABLE signcounter(id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, aaid VARCHAR, keyID VARCHAR, userName VARCHAR,signCounter INTEGER)"

    invoke-virtual {p1, v0}, Landroid/database/sqlite/SQLiteDatabase;->execSQL(Ljava/lang/String;)V

    const-string v0, "CREATE TABLE signcounter(id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, aaid VARCHAR, keyID VARCHAR, userName VARCHAR,signCounter INTEGER)"

    invoke-virtual {p1, v0}, Landroid/database/sqlite/SQLiteDatabase;->execSQL(Ljava/lang/String;)V

    return-void
.end method

.method public recreateUserKeyTable(Landroid/database/sqlite/SQLiteDatabase;)V
    .registers 3

    const-string v0, "DROP TABLE IF EXISTS userkey"

    invoke-virtual {p1, v0}, Landroid/database/sqlite/SQLiteDatabase;->execSQL(Ljava/lang/String;)V

    const-string v0, "CREATE TABLE userkey(_id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,keyhandle VARCHAR(200) NOT NULL,pubkey VARCHAR(200) NOT NULL,privkey VARCHAR(200) NOT NULL) "

    invoke-virtual {p1, v0}, Landroid/database/sqlite/SQLiteDatabase;->execSQL(Ljava/lang/String;)V

    return-void
.end method
